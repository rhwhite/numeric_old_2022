{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Initial setup for instructors\n",
    "\n",
    "## General workflow\n",
    "\n",
    "  * Always edit py files, treat the ipynb files as read only output storage\n",
    "  * If you  forget, you can sync with: `jupytext --sync thenotebook.py`\n",
    "  * or sync and execute: `jupytext --sync --execute thenotebook.py`\n",
    "\n",
    "To get familiar with how jupytext works, it would be good \n",
    "to spend some time at https://jupytext.readthedocs.io/en/latest/?badge=latest\n",
    "\n",
    "The notes below show how to bootstrap a repository with notebooks only committed\n",
    "as python files.  That means that the first time through, we need to convert and\n",
    "execute the ipynb versions.  Subsequently, jupyter will handle this through\n",
    "the modified jupyter_notebook_config.py described below.\n",
    "\n",
    "## installation\n",
    "\n",
    "1. Install miniconda if you don't have it -- note that our environment\n",
    "   will be 100% conda-forge, so you don't want to use a large existing\n",
    "   anaconda installation to create the e213 environment.\n",
    "\n",
    "2. clone the repo:\n",
    "\n",
    "```\n",
    "git clone https://github.com/phaustin/numeric\n",
    "cd numeric\n",
    "```\n",
    "\n",
    "3. cd to the `course_utils` folder and create and activate the numeric environment\n",
    "\n",
    "```\n",
    "cd course_utils\n",
    "conda env create -f numeric.yml\n",
    "conda activate numeric\n",
    "```\n",
    "\n",
    "4. Make sure you have a jupyter config folder\n",
    "\n",
    "```\n",
    "jupyter notebook --generate-config\n",
    "```\n",
    "\n",
    "This should put a `jupyter_notebook_config.py` file in your `~/.jupyter` folder\n",
    "\n",
    "5. Replace the config with the one in conda_utils\n",
    "\n",
    "```\n",
    "cp conda_utils/jupyter_notebook_config.py ~/.jupyter/.\n",
    "```\n",
    "\n",
    "## Building the notebooks\n",
    "\n",
    "We need to track three different flavors of notebook:\n",
    "\n",
    "a) Student versions\n",
    "b) Notebooks with solutions\n",
    "c) Documentation notebooks for website\n",
    "\n",
    "At the moment there are two sets, the student notebooks are in\n",
    "`numerics/notebooks` and the documentation notebooks\n",
    "are in `numeric/docs/docs_notebooks`\n",
    "\n",
    "To build from scratch, we need to convert the py files to ipynb files.\n",
    "\n",
    "To do this:\n",
    "\n",
    "1. `cd numeric`\n",
    "2. `python scripts/find_notebooks.py notebooks notebook_filelist.json --initial`\n",
    "\n",
    "This should create an ipynb file for every py file and a new json\n",
    "file calle `notebook_filelist.json`.  We need to execute\n",
    "these, at this point we can suppress all errors:\n",
    "\n",
    "`python scripts/jup_build.py exec-noerrors-nb notebook_filelist.json`\n",
    "\n",
    "Repeat this for the docs notebooks:\n",
    "\n",
    "```\n",
    "python scripts/find_notebooks.py docs/doc_notebooks notebook_docs_filelist.json --initial\n",
    "python scripts/jup_build.py exec-noerrors-nb notebook_docs_filelist.json\n",
    "```\n",
    "\n",
    "## Making the course website\n",
    "\n",
    "The notebooks (ipynb) and any restructured text (rst) and markdown (md) files are assembled\n",
    "into a website using [nbsphinx](https://nbsphinx.readthedocs.io/en/0.5.0/).  To build and\n",
    "deploy with github-pages:\n",
    "\n",
    "1. `cd numeric/docs`\n",
    "2. `./build_website.sh`\n",
    "\n",
    "\n",
    "and push to github\n",
    "\n",
    "\n",
    "1. `cd numeric/docs`\n",
    "2. `./push_pages.sh`\n",
    "\n",
    "\n",
    "1. Install miniconda for you architecture:  https://docs.conda.io/en/latest/miniconda.html\n",
    "\n",
    "## For MacOS\n",
    "\n",
    "a. Start a terminal and type:\n",
    "\n",
    "```\n",
    "conda install git\n",
    "```\n",
    "\n",
    "b. cd to your home directory and make a folder called repos\n",
    "\n",
    "```\n",
    "mkdir repos\n",
    "cd repos\n",
    "```\n",
    "\n",
    "c. clone the course repository and cd into it\n",
    "\n",
    "```\n",
    "git clone https://github.com/phaustin/numeric\n",
    "cd numeric\n",
    "```\n",
    "\n",
    "e. cd to the course folder and create and activate the e213 environment\n",
    "\n",
    "```\n",
    "cd conda\n",
    "conda env create -f numeric.yml\n",
    "conda activate numeric\n",
    "```\n",
    "\n",
    "f. change back to the notebooks folder and start jupyter\n",
    "\n",
    "```\n",
    "cd ../notebooks\n",
    "jupyter notebook\n",
    "```\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "all",
   "formats": "ipynb,py:percent",
   "notebook_metadata_filter": "all,-language_info,-toc,-latex_envs"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
