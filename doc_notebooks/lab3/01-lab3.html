

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Laboratory 3: Linear Algebra (Sept. 12, 2017) &mdash; Numeric course 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Solving Ordinary Differential Equations with the Runge-Kutta Methods" href="../lab4/01-lab4.html" />
    <link rel="prev" title="Stability and accuracy (Jan. 2020)" href="../lab2/01-lab2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Numeric course
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../course_bootstrap.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ugradsyllabus20.html">Undergrad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gradsyllabus20.html">Grad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule20.html">Detailed Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../texts.html">Optional texts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../notebook_toc.html">Course/lab descriptions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../lab1/01-lab1.html">Lab 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab2/01-lab2.html">Lab 2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lab 3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#List-of-Problems">List of Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Objectives">Objectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Linear-Systems">Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#What-is-a-Matrix?">What is a Matrix?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Quick-Review">Quick Review</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Gaussian-Elimination">Gaussian Elimination</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Round-off-Error">Round-off Error</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Matrix-Inversion">Matrix Inversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Determinant">Determinant</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Computational-cost-of-Gaussian-elimination">Computational cost of Gaussian elimination</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Eigenvalue-Problems">Eigenvalue Problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Characteristic-Equation">Characteristic Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Eigenvectors">Eigenvectors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Iterative-Methods">Iterative Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Solution-of-an-ODE-Using-Linear-Algebra">Solution of an ODE Using Linear Algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#####-Problem-Four">#### Problem Four</a></li>
<li class="toctree-l3"><a class="reference internal" href="#References">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Glossary">Glossary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lab4/01-lab4.html">Lab 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html">Lab 5: Daisyworld</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#The-Daisyworld-Model">The Daisyworld Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#The-Local-Temperature---Dependence-on-Surface-Heat-Conductivity">The Local Temperature - Dependence on Surface Heat Conductivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#The-Feedback-Loop---Feedback-Through-the-Planetary-Albedo">The Feedback Loop - Feedback Through the Planetary Albedo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Adaptive-Stepsize-in-Runge-Kutta">Adaptive Stepsize in Runge-Kutta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Coding-Runge-Kutta-Adaptive-Stepsize-Control">Coding Runge-Kutta Adaptive Stepsize Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Conclusion">Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Appendix:-Note-on-Global-Energy-Balance">Appendix: Note on Global Energy Balance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Summary:-Daisy-World-Equations">Summary: Daisy World Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Appendix:-Organization-of-the-adaptive-Runge-Kutta-routines">Appendix: Organization of the adaptive Runge Kutta routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html#Appendix:-2-minute-intro-to-object-oriented-programming">Appendix: 2 minute intro to object oriented programming</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week_notes.html">Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments.html">Weekly assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quizzes.html">Quizzes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Numeric course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../notebook_toc.html">Numeric notebooks</a> &raquo;</li>
        
      <li>Laboratory 3: Linear Algebra (Sept.¬†12, 2017)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/doc_notebooks/lab3/01-lab3.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Laboratory-3:-Linear-Algebra-(Sept.¬†12,-2017)">
<h1>Laboratory 3: Linear Algebra (Sept.¬†12, 2017)<a class="headerlink" href="#Laboratory-3:-Linear-Algebra-(Sept.¬†12,-2017)" title="Permalink to this headline">¬∂</a></h1>
<p>Grace Yung</p>
<h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1¬†¬†Laboratory 3: Linear Algebra (Sept.¬†12, 2017)</p>
<ul class="toc-item"><li><p>1.1¬†¬†List of Problems</p>
</li><li><p>1.2¬†¬†Objectives</p>
</li><li><p>1.3¬†¬†Prerequisites</p>
</li><li><p>1.4¬†¬†Linear Systems</p>
<ul class="toc-item"><li><p>1.4.1¬†¬†What is a Matrix?</p>
</li><li><p>1.4.2¬†¬†Quick Review</p>
</li><li><p>1.4.3¬†¬†Gaussian Elimination</p>
</li><li><p>1.4.4¬†¬†Round-off Error</p>
</li><li><p>1.4.5¬†¬†Matrix Inversion</p>
</li><li><p>1.4.6¬†¬†Determinant</p>
</li><li><p>1.4.7¬†¬†Computational cost of Gaussian elimination</p>
</li></ul></li><li><p>1.5¬†¬†Eigenvalue Problems</p>
<ul class="toc-item"><li><p>1.5.1¬†¬†Characteristic Equation</p>
</li><li><p>1.5.2¬†¬†Eigenvectors</p>
</li></ul></li><li><p>1.6¬†¬†Iterative Methods</p>
</li><li><p>1.7¬†¬†Solution of an ODE Using Linear Algebra</p>
</li><li><p>1.8¬†¬†References</p>
</li><li><p>1.9¬†¬†Numpy and Python with Matrices</p>
</li><li><p>1.10¬†¬†Glossary</p>
</li></ul></li></ul></div><div class="section" id="List-of-Problems">
<h2>List of Problems<a class="headerlink" href="#List-of-Problems" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Problem-One">Problem One</a>: Pollution Box Model</p></li>
<li><p><a class="reference external" href="#Problem-Two">Problem Two</a>: Condition number for Dirichlet problem</p></li>
<li><p><a class="reference external" href="#Problem-Three">Problem Three</a>: Condition number for Neumann problem</p></li>
<li><p><a class="reference external" href="#Problem-Four">Problem Four</a>: Condition number for periodic problem</p></li>
</ul>
</div>
<div class="section" id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¬∂</a></h2>
<p>The object of this lab is to familiarize you with some of the common techniques used in linear algebra. You can use the Python software package to solve some of the problems presented in the lab. There are examples of using the Python commands as you go along in the lab. In particular, after finishing the lab, you will be able to</p>
<ul class="simple">
<li><p>Define: condition number, ill-conditioned matrix, singular matrix, LU decomposition, Dirichlet, Neumann and periodic boundary conditions.</p></li>
<li><p>Find by hand or using Python: eigenvalues, eigenvectors, transpose, inverse of a matrix, determinant.</p></li>
<li><p>Find using Python: condition numbers.</p></li>
<li><p>Explain: pivoting.</p></li>
</ul>
<p>There is a description of using Numpy and Python for Matrices at the end of the lab. It includes a brief description of how to use the built-in functions introduced in this lab. Just look for the paw prints:</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
<p>when you are not sure what functions to use, and this will lead you to the mini-manual.</p>
</div>
<div class="section" id="Prerequisites">
<h2>Prerequisites<a class="headerlink" href="#Prerequisites" title="Permalink to this headline">¬∂</a></h2>
<p>You should have had an introductory course in linear algebra.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># import the context to find files</span>
<span class="kn">import</span> <span class="nn">context</span>
<span class="c1"># import the quiz script</span>
<span class="kn">from</span> <span class="nn">numlabs.lab3</span> <span class="kn">import</span> <span class="n">quiz3</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
******************************
context imported. Front of path:
/Users/phil/repos/numeric
back of path: /Users/phil/.ipython
******************************

through /Users/phil/repos/numeric/notebooks/lab3/context.py
</pre></div></div>
</div>
</div>
<div class="section" id="Linear-Systems">
<h2>Linear Systems<a class="headerlink" href="#Linear-Systems" title="Permalink to this headline">¬∂</a></h2>
<p>In this section, the concept of a matrix will be reviewed. The basic operations and methods in solving a linear system are introduced as well.</p>
<p>Note: <strong>Whenever you see a term you are not familiar with, you can find a definition in the</strong><a class="reference external" href="#Glossary">glossary</a><strong>.</strong></p>
<div class="section" id="What-is-a-Matrix?">
<h3>What is a Matrix?<a class="headerlink" href="#What-is-a-Matrix?" title="Permalink to this headline">¬∂</a></h3>
<p>Before going any further on how to solve a linear system, you need to know what a linear system is. A set of m linear equations with n unknowns:</p>
<div id="lab3:eq:system"><p>(System of Equations)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccccc}
a_{11}x_{1} &amp; + &amp; \ldots &amp; + &amp; a_{1n}x_{n} &amp; = &amp; b_{1} \\
a_{21}x_{1} &amp; + &amp; \ldots &amp; + &amp; a_{2n}x_{n} &amp; = &amp; b_{2} \\
            &amp;   &amp; \vdots &amp;   &amp;             &amp;   &amp; \vdots \\
a_{m1}x_{1} &amp; + &amp; \ldots &amp; + &amp; a_{mn}x_{n} &amp; = &amp; b_{m}
\end{array}\end{split}\]</div>
</div><p>can be represented as an augmented matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[
\begin{array}{cc}
        \begin{array}{ccccc}
                a_{11} &amp; &amp; \ldots &amp; &amp; a_{1n} \\
                \vdots &amp; &amp; \ddots &amp; &amp; \vdots \\
                a_{m1} &amp; &amp; \ldots &amp; &amp; a_{mn}
        \end{array}
&amp;
        \left|
        \begin{array}{rc}
                &amp; b_{1} \\ &amp; \vdots \\ &amp; b_{m}
        \end{array}
        \right.
\end{array}
\right]\end{split}\]</div>
<p>Column 1 through n of this matrix contain the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> of the unknowns in the set of linear equations. The right most column is the <em>augmented column</em>, which is made up of the coefficients of the right hand side <span class="math notranslate nohighlight">\(b_i\)</span>.</p>
<div class="section" id="Quiz-on-Matrices">
<h4>Quiz on Matrices<a class="headerlink" href="#Quiz-on-Matrices" title="Permalink to this headline">¬∂</a></h4>
<p>Which matrix matches this system of equations?</p>
<div id="quiz:sys"><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lcr}
2x + 3y + 6z &amp;=&amp; 19\\
3x + 6y + 9z &amp;=&amp; 21\\
x + 5y + 10z &amp;=&amp; 0
\end{array}\end{split}\]</div>
</div><ol class="upperalpha">
<li><div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{ccc}
2 &amp; 3 &amp; 1 \\
3 &amp; 6 &amp; 5 \\
6 &amp; 9 &amp; 10\\
19 &amp; 21 &amp; 0
\end{array}
\right]\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{ccc}
2 &amp; 3 &amp; 6\\
3 &amp; 6 &amp; 9\\
1 &amp; 5 &amp; 10
\end{array}
\right]\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{ccc|c}
1 &amp; 5 &amp; 10 &amp; 0\\
2 &amp; 3 &amp; 6 &amp; 19\\
3 &amp; 6 &amp; 9 &amp; 21
\end{array}
\right]\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{ccc|c}
2 &amp; 3 &amp; 6 &amp; -19\\
3 &amp; 6 &amp; 9 &amp; -21\\
1 &amp; 5 &amp; 10 &amp; 0
\end{array}
\right]\end{split}\]</div>
</li>
</ol>
<p>In the following, replace ‚Äòx‚Äô by ‚ÄòA‚Äô, ‚ÄòB‚Äô, ‚ÄòC‚Äô, or ‚ÄòD‚Äô and run the cell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">quiz3</span><span class="o">.</span><span class="n">matrix_quiz</span><span class="p">(</span><span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
You forgot the augmented column. Try again.
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Quick-Review">
<h3>Quick Review<a class="headerlink" href="#Quick-Review" title="Permalink to this headline">¬∂</a></h3>
<p>Here is a review on the basic matrix operations, including addition, subtraction and multiplication. These are important in solving linear systems.</p>
<p>Here is a short exercise to see how much you remember:</p>
<p>Let <span class="math notranslate nohighlight">\(x = \left[ \begin{array}{r} 2 \\ 2 \\ 7 \end{array} \right] ,  y = \left[ \begin{array}{r} -5 \\ 1 \\ 3 \end{array} \right] ,  A = \left[ \begin{array}{rrr} 3 &amp; -2 &amp; 10 \\  -6 &amp; 7 &amp; -4  \end{array} \right],  B = \left[ \begin{array}{rr} -6 &amp; 4 \\ 7 &amp; -1 \\ 2 &amp; 9  \end{array} \right]\)</span>.</p>
<p>Calculate the following:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(x + y\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x^{T}y\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y-x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Ax\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y^{T}A\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(AB\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(BA\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(AA\)</span></p></li>
</ol>
<p>The solutions to these exercises are available <a class="reference external" href="lab3_files/quizzes/quick/quick.html">here</a></p>
<p>After solving the questions by hand, you can also use Python to check your answers.</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
<div class="section" id="Gaussian-Elimination">
<h3>Gaussian Elimination<a class="headerlink" href="#Gaussian-Elimination" title="Permalink to this headline">¬∂</a></h3>
<p>The simplest method for solving a linear system is Gaussian elimination, which uses three types of <em>elementary row operations</em>:</p>
<ul class="simple">
<li><p>Multiplying a row by a non-zero constant (<span class="math notranslate nohighlight">\(kE_{ij}\)</span>)</p></li>
<li><p>Adding a multiple of one row to another (<span class="math notranslate nohighlight">\(E_{ij} + kE_{kj}\)</span>)</p></li>
<li><p>Exchanging two rows (<span class="math notranslate nohighlight">\(E_{ij} \leftrightarrow E_{kj}\)</span>)</p></li>
</ul>
<p>Each row operation corresponds to a step in the solution of the <a class="reference external" href="#lab3:eq:system">System of Equations</a> where the equations are combined together. <em>It is important to note that none of those operations changes the solution.</em> There are two parts to this method: elimination and back-substitution. The purpose of the process of elimination is to eliminate the matrix entries below the main diagonal, using row operations, to obtain a upper triangular matrix with the augmented column. Then, you will
be able to proceed with back-substitution to find the values of the unknowns.</p>
<p>Try to solve this set of linear equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lrcrcrcr}
        E_{1j}: &amp; 2x_{1} &amp; + &amp; 8x_{2} &amp; - &amp; 5x_{3} &amp; = &amp; 53 \\
        E_{2j}: &amp; 3x_{1} &amp; - &amp; 6x_{2} &amp; + &amp; 4x_{3} &amp; = &amp; -48 \\
        E_{3j}: &amp; x_{1} &amp; + &amp; 2x_{2} &amp; - &amp; x_{3} &amp; = &amp; 13
\end{array}\end{split}\]</div>
<p>The solution to this problem is available <a class="reference external" href="lab3_files/quizzes/gaus/gaus.html">here</a></p>
<p>After solving the system by hand, you can use Python to check your answer.</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
<div class="section" id="Decomposition">
<h4>Decomposition<a class="headerlink" href="#Decomposition" title="Permalink to this headline">¬∂</a></h4>
<p>Any invertible, square matrix, <span class="math notranslate nohighlight">\(A\)</span>, can be factored out into a product of a lower and an upper triangular matrices, <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>, respectively, so that <span class="math notranslate nohighlight">\(A\)</span> = <span class="math notranslate nohighlight">\(LU\)</span>. The <span class="math notranslate nohighlight">\(LU\)</span>- <em>decomposition</em> is closely linked to the process of Gaussian elimination.</p>
</div>
<div class="section" id="Example-One">
<h4>Example One<a class="headerlink" href="#Example-One" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>Using the matrix from the system of the previous section (Sec <a class="reference external" href="#Gaussian-Elimination">Gaussian Elimination</a>), we have:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{rrr}  2 &amp;  8 &amp; -5  \\
3 &amp; -6 &amp;  4  \\
1 &amp;  2 &amp; -1  \end{array}  \right]\end{split}\]</div>
<p>The upper triangular matrix <span class="math notranslate nohighlight">\(U\)</span> can easily be calculated by applying Gaussian elimination to <span class="math notranslate nohighlight">\(A\)</span>:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
\begin{array}{c}   E_{2j}-\frac{3}{2}E_{1j}  \\
E_{3j}-\frac{1}{2}E_{1j}  \\
\rightarrow   \end{array}
&amp;
\left[  \begin{array}{rrr}   2 &amp;   8 &amp; -5   \\
0 &amp; -18 &amp; \frac{23}{2}  \\
0 &amp;  -2 &amp; \frac{3}{2}
\end{array}    \right]  \\   \\
\begin{array}{c}   E_{3j}-\frac{1}{9}E_{2j} \\
\rightarrow    \end{array}
&amp;
\left[  \begin{array}{rrr}   2 &amp;   8 &amp; -5   \\
0 &amp; -18 &amp; \frac{23}{2} \\
0 &amp;   0 &amp; \frac{2}{9}
\end{array}   \right]  = U
\end{array}\end{split}\]</div>
<p>Note that there is no row exchange.</p>
</div></blockquote>
<blockquote>
<div><p>The lower triangular matrix <span class="math notranslate nohighlight">\(L\)</span> is calculated with the steps which lead us from the original matrix to the upper triangular matrix, i.e.:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}      E_{2j}-\frac{3}{2}E_{1j}  \\ \\
E_{3j}-\frac{1}{2}E_{1j}  \\ \\
E_{3j}-\frac{1}{9}E_{2j}
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>Note that each step is a multiple <span class="math notranslate nohighlight">\(\ell\)</span> of equation <span class="math notranslate nohighlight">\(m\)</span> subtracted from equation <span class="math notranslate nohighlight">\(n\)</span>. Each of these steps, in fact, can be represented by an elementary matrix. <span class="math notranslate nohighlight">\(U\)</span> can be obtained by multiplying <span class="math notranslate nohighlight">\(A\)</span> by this sequence of elementary matrices.</p>
<p>Each of the elementary matrices is composed of an identity matrix the size of <span class="math notranslate nohighlight">\(A\)</span> with <span class="math notranslate nohighlight">\(-\ell\)</span> in the (<span class="math notranslate nohighlight">\(m,n\)</span>) entry. So the steps become:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccc}
E_{2j}-\frac{3}{2}E_{1j}  &amp;
\rightarrow &amp;
\left[  \begin{array}{rcc}   1 &amp; 0 &amp; 0  \\
-\frac{3}{2} &amp; 1 &amp; 0  \\
0 &amp; 0 &amp; 1
\end{array}   \right]  = R \\   \\
E_{3j}-\frac{1}{2}E_{1j}  &amp;
\rightarrow &amp;
\left[  \begin{array}{rcc}   1 &amp; 0 &amp; 0  \\
0 &amp; 1 &amp; 0  \\
-\frac{1}{2} &amp; 0 &amp; 1
\end{array}   \right]  = S \\   \\
E_{3j}-\frac{1}{9}E_{2j}  &amp;
\rightarrow &amp;
\left[  \begin{array}{crc}  1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0  \\
0 &amp; -\frac{1}{9} &amp; 1
\end{array}   \right]  = T
\end{array}\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(TSRA\)</span> = <span class="math notranslate nohighlight">\(U\)</span>. Check this with Python.</p>
</div></blockquote>
<blockquote>
<div><p>To get back from <span class="math notranslate nohighlight">\(U\)</span> to <span class="math notranslate nohighlight">\(A\)</span>, the inverse of <span class="math notranslate nohighlight">\(R\)</span>, <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(T\)</span> are multiplied onto <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
T^{-1}TSRA &amp; = &amp; T^{-1}U  \\
S^{-1}SRA &amp; = &amp; S^{-1}T^{-1}U  \\
R^{-1}RA &amp; = &amp; R^{-1}S^{-1}T^{-1}U \\
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>So <span class="math notranslate nohighlight">\(A\)</span> = <span class="math notranslate nohighlight">\(R^{-1}S^{-1}T^{-1}U\)</span>. Recall that <span class="math notranslate nohighlight">\(A\)</span> = <span class="math notranslate nohighlight">\(LU\)</span>. If <span class="math notranslate nohighlight">\(R^{-1}S^{-1}T^{-1}\)</span> is a lower triangular matrix, then it is <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>The inverse of the elementary matrix is the same matrix with only one difference, and that is, <span class="math notranslate nohighlight">\(\ell\)</span> is in the <span class="math notranslate nohighlight">\(a_{mn}\)</span> entry instead of <span class="math notranslate nohighlight">\(-\ell\)</span>. So:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
R^{-1} &amp; = &amp; \left[ \begin{array}{rrr} 1 &amp; 0 &amp; 0 \\
\frac{3}{2} &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{array}   \right]       \\  \\
S^{-1} &amp; = &amp; \left[ \begin{array}{rrr} 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
\frac{1}{2} &amp; 0 &amp; 1
\end{array}   \right]       \\  \\
T^{-1} &amp; = &amp; \left[ \begin{array}{rrr} 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; \frac{1}{9} &amp; 1
\end{array}   \right]
\end{array}\end{split}\]</div>
<p>Multiplying <span class="math notranslate nohighlight">\(R^{-1}S^{-1}T^{-1}\)</span> together, we have:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}  R^{-1}S^{-1}T^{-1}
&amp; = &amp;
\left[ \begin{array}{ccc}    1 &amp;           0 &amp; 0 \\
\frac{3}{2} &amp;           1 &amp; 0  \\
\frac{1}{2} &amp; \frac{1}{9} &amp; 1
\end{array}   \right]  = L
\end{array}\end{split}\]</div>
<p>So <span class="math notranslate nohighlight">\(A\)</span> is factored into two matrices <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span>, where</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccc}
L = \left[  \begin{array}{ccc}    1 &amp;           0 &amp; 0 \\
\frac{3}{2} &amp;           1 &amp; 0  \\
\frac{1}{2} &amp; \frac{1}{9} &amp; 1
\end{array}  \right]
&amp; \mbox{ and } &amp;
U = \left[  \begin{array}{ccc}  2 &amp;   8 &amp; -5   \\
0 &amp; -18 &amp; \frac{23}{2} \\
0 &amp;   0 &amp; \frac{2}{9}
\end{array}  \right]
\end{array}\end{split}\]</div>
<p>Use Python to confirm that <span class="math notranslate nohighlight">\(LU\)</span> = <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div></blockquote>
<p>The reason decomposition is introduced here is not because of Gaussian elimination <span class="math notranslate nohighlight">\(-\)</span> one seldom explicitly computes the <span class="math notranslate nohighlight">\(LU\)</span> decomposition of a matrix. However, the idea of factoring a matrix is important for other direct methods of solving linear systems (of which Gaussian elimination is only one) and for methods for finding eigenvalues (<a class="reference external" href="#Characteristic-Equation">Characteristic Equation</a>).</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
</div>
<div class="section" id="Round-off-Error">
<h3>Round-off Error<a class="headerlink" href="#Round-off-Error" title="Permalink to this headline">¬∂</a></h3>
<p>When a number is represented in its floating point form, i.e.¬†an approximation of the number, the resulting error is the <em>round-off error</em>. The floating-point representation of numbers¬† and the consequent effects of round-off error¬†were discussed already in Lab¬†#2.</p>
<p>When round-off errors are present in the matrix <span class="math notranslate nohighlight">\(A\)</span> or the right hand side <span class="math notranslate nohighlight">\(b\)</span>, the linear system <span class="math notranslate nohighlight">\(Ax = b\)</span> may or may not give a solution that is close to the real answer. When a matrix <span class="math notranslate nohighlight">\(A\)</span> ‚Äúmagnifies‚Äù the effects of round-off errors in this way, we say that <span class="math notranslate nohighlight">\(A\)</span> is an ill-conditioned matrix.</p>
<div class="section" id="Example-Two">
<h4>Example Two<a class="headerlink" href="#Example-Two" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>Let‚Äôs see an example:</p>
</div></blockquote>
<blockquote>
<div><p>Suppose</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{cc} 1 &amp; 1 \\ 1 &amp; 1.0001
\end{array} \right]\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>and consider the system:</p>
<div id="lab3:eq:illbefore"><p>(Ill-conditioned version one):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{cc}
\begin{array}{cc}   1 &amp; 1 \\  1 &amp; 1.0001  \end{array}
&amp;
\left| \begin{array}{c}  2 \\ 2 \end{array}  \right]
\end{array}   \right.\end{split}\]</div>
</div></div></blockquote>
<blockquote>
<div><p>The condition number, <span class="math notranslate nohighlight">\(K\)</span>, of a matrix, defined in <a class="reference external" href="#Condition-Number">Condition Number</a>, is a measure of how well-conditioned a matrix is. If <span class="math notranslate nohighlight">\(K\)</span> is large, then the matrix is ill-conditioned, and Gaussian elimination will magnify the round-off errors. The condition number of <span class="math notranslate nohighlight">\(A\)</span> is 40002. You can use Python to check this number.</p>
<p>The solution to this is <span class="math notranslate nohighlight">\(x_1\)</span> = 2 and <span class="math notranslate nohighlight">\(x_2\)</span> = 0. However, if the system is altered a little as follows:</p>
</div></blockquote>
<blockquote>
<div><div id="lab3:eq:illafter"><p>(Ill-conditioned version two):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{cc}
\begin{array}{cc}   1 &amp; 1 \\  1 &amp; 1.0001  \end{array}
&amp;
\left| \begin{array}{c}  2 \\ 2.0001 \end{array}  \right]
\end{array}   \right.\end{split}\]</div>
</div><p>Then, the solution becomes <span class="math notranslate nohighlight">\(x_1\)</span> = 1 and <span class="math notranslate nohighlight">\(x_2\)</span> = 1. A change in the fifth significant digit was amplified to the point where the solution is not even accurate to the first significant digit. <span class="math notranslate nohighlight">\(A\)</span> is an ill-conditioned matrix. You can set up the systems <a class="reference external" href="#lab3:eq:illbefore">Ill-conditioned version one</a> and <a class="reference external" href="#lab3:eq:illafter">Ill-conditioned version two</a> in Python, and check the answers yourself.</p>
</div></blockquote>
</div>
<div class="section" id="Example-Three">
<h4>Example Three<a class="headerlink" href="#Example-Three" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>Use Python to try the following example. First solve the system <span class="math notranslate nohighlight">\(A^{\prime}x = b\)</span>; then solve <span class="math notranslate nohighlight">\(A^{\prime}x = b2\)</span>. Find the condition number of <span class="math notranslate nohighlight">\(A^{\prime}\)</span>.</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccc}
A^{\prime} = \left[ \begin{array}{cc} 0.0001 &amp; 1  \\ 1 &amp; 1
\end{array}   \right]
&amp; , &amp;
b = \left[ \begin{array}{c} 1 \\ 2  \end{array}  \right]
&amp; \mbox{and} &amp;
b2 = \left[ \begin{array}{c} 1 \\ 2.0001  \end{array}  \right] .
\end{array}\end{split}\]</div>
<p>You will find that the solution for <span class="math notranslate nohighlight">\(A^{\prime}x = b\)</span> is <span class="math notranslate nohighlight">\(x_1\)</span> = 1.0001 and <span class="math notranslate nohighlight">\(x_2\)</span> = 0.9999, and the solution for <span class="math notranslate nohighlight">\(A^{\prime}x = b2\)</span> is <span class="math notranslate nohighlight">\(x_1\)</span> = 1.0002 and <span class="math notranslate nohighlight">\(x_2\)</span> = 0.9999 . So a change in <span class="math notranslate nohighlight">\(b\)</span> did not result in a large change in the solution. Therefore, <span class="math notranslate nohighlight">\(A^{\prime}\)</span> is a well-conditioned matrix. In fact, the condition number is approximately 2.6.</p>
</div></blockquote>
<blockquote>
<div><p>Nevertheless, even a well conditioned system like <span class="math notranslate nohighlight">\(A^{\prime}x = b\)</span> leads to inaccuracy if the wrong solution method is used, that is, an algorithm which is sensitive to round-off error. If you use Gaussian elimination to solve this system, you might be misled that <span class="math notranslate nohighlight">\(A^{\prime}\)</span> is ill-conditioned. Using Gaussian elimination to solve <span class="math notranslate nohighlight">\(A^{\prime}x=b\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp;  \left[
\begin{array}{cc}
\begin{array}{cc}  0.0001 &amp; 1 \\  1 &amp; 1  \end{array}
&amp;
\left|
\begin{array}{c}  1 \\ 2  \end{array}  \right]
\end{array}  \right.  \\  \\
\begin{array}{c}  10,000E_{1j} \\ \rightarrow \end{array}  &amp;
\left[
\begin{array}{cc}
\begin{array}{cc}  1 &amp; 10,000 \\  1 &amp; 1  \end{array}
&amp;
\left|
\begin{array}{c}  10,000 \\ 2  \end{array}  \right]
\end{array}  \right.  \\  \\
\begin{array}{c}  E_{2j}-E_{1j} \\ \rightarrow \end{array} &amp;
\left[
\begin{array}{cc}
\begin{array}{cc}  1 &amp; 10,000  \\  0 &amp; -9,999  \end{array}
&amp;
\left|
\begin{array}{c}  10,000 \\ -9,998  \end{array}  \right]
\end{array}  \right.
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>At this point, if you continue to solve the system as is, you will get the expected answers. You can check this with Python. However, if you make changes to the matrix here by rounding -9,999 and -9,998 to -10,000, the final answers will be different:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp; \left[
\begin{array}{cc}
\begin{array}{cc}  1 &amp; 10,000  \\  0 &amp; -10,000  \end{array}
&amp;
\left|
\begin{array}{c}  10,000 \\ -10,000  \end{array}  \right]
\end{array}  \right.
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>The result is <span class="math notranslate nohighlight">\(x_1\)</span> = 0 and <span class="math notranslate nohighlight">\(x_2\)</span> = 1, which is quite different from the correct answers. So Gaussian elimination might mislead you to think that a matrix is ill-conditioned by giving an inaccurate solution to the system. In fact, the problem is that Gaussian elimination on its own is a method that is unstable in the presence of round-off error, even for well-conditioned matrices. Can this be fixed?</p>
<p>You can try the example with Python.</p>
</div></blockquote>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
<div class="section" id="Partial-Pivoting">
<h4>Partial Pivoting<a class="headerlink" href="#Partial-Pivoting" title="Permalink to this headline">¬∂</a></h4>
<p>There are a number of ways to avoid inaccuracy, one of which is applying partial pivoting to the Gaussian elimination.</p>
<p>Consider the example from the previous section. In order to avoid multiplying by 10,000, another pivot is desired in place of 0.0001. The goal is to examine all the entries in the first column, find the entry that has the largest value, and exchange the first row with the row that contains this element. So this entry becomes the pivot. This is partial pivoting. Keep in mind that switching rows is an elementary operation and has no effect on the solution.</p>
<p>In the original Gaussian elimination algorithm, row exchange is done only if the pivot is zero. In partial pivoting, row exchange is done so that the largest value in a certain column is the pivot. This helps to reduce the amplification of round-off error.</p>
</div>
<div class="section" id="Example-Four">
<h4>Example Four<a class="headerlink" href="#Example-Four" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>In the matrix <span class="math notranslate nohighlight">\(A^{\prime}\)</span> from <a class="reference external" href="#Example-Two">Example Two</a>, 0.0001 from column one is the first pivot. Looking at this column, the entry, 1, in the second row is the only other choice in this column. Obviously, 1 is greater than 0.0001. So the two rows are exchanged.</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp; \left[ \begin{array}{cc}
\begin{array}{cc}  0.0001 &amp; 1 \\  1 &amp; 1  \end{array}
&amp;   \left|
\begin{array}{c}   1 \\ 2  \end{array} \right]
\end{array}  \right. \\   \\
\begin{array}{c} E_{1j} \leftrightarrow E_{2j} \\  \rightarrow
\end{array}
&amp;  \left[ \begin{array}{cc}
\begin{array}{cc}  1 &amp; 1 \\  0.0001 &amp; 1  \end{array}
&amp;  \left|
\begin{array}{c}   2 \\ 1  \end{array} \right]
\end{array}  \right.  \\  \\
\begin{array}{c}  E_{2j}-0.0001E_{1j} \\ \rightarrow \end{array}
&amp; \left[ \begin{array}{cc}
\begin{array}{cc}  1 &amp; 1 \\  0 &amp; 0.9999  \end{array}
&amp;   \left|
\begin{array}{c}   2 \\ 0.9998  \end{array} \right]
\end{array}  \right.
\end{array}\end{split}\]</div>
<p>The same entries are rounded off:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp; \left[  \begin{array}{cc}
\begin{array}{cc}  1 &amp; 1 \\ 0 &amp; 1  \end{array}
&amp;
\left|
\begin{array}{c}  2 \\ 1  \end{array}  \right]
\end{array}   \right. \\  \\
\begin{array}{c}  E_{1j}-E_{2j}  \\  \rightarrow  \end{array}
&amp; \left[  \begin{array}{cc}
\begin{array}{cc}  1 &amp; 0  \\ 0 &amp; 1 \end{array}
&amp;
\left|
\begin{array}{c} 1 \\ 1 \end{array}  \right]
\end{array}   \right.
\end{array}\end{split}\]</div>
<p>So the solution is <span class="math notranslate nohighlight">\(x_1\)</span> = 1 and <span class="math notranslate nohighlight">\(x_2\)</span> = 1, and this is a close approximation to the original solution, <span class="math notranslate nohighlight">\(x_1\)</span> = 1.0001 and <span class="math notranslate nohighlight">\(x_2\)</span> = 0.9999.</p>
</div></blockquote>
<blockquote>
<div><p>You can try the example with Python.</p>
</div></blockquote>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
<p>Note: This section has described row pivoting. The same process can be applied to columns, with the resulting procedure being called column pivoting.</p>
</div>
<div class="section" id="Full-Pivoting">
<h4>Full Pivoting<a class="headerlink" href="#Full-Pivoting" title="Permalink to this headline">¬∂</a></h4>
<p>Another way to get around inaccuracy (Example <a class="reference external" href="#Example-Three">Three</a>) is to use Gaussian elimination with full pivoting. Sometimes, even partial pivoting can lead to problems. With full pivoting, in addition to row exchange, columns will be exchanged as well. The purpose is to use the largest entries in the whole matrix as the pivots.</p>
</div>
<div class="section" id="Example-Five">
<h4>Example Five<a class="headerlink" href="#Example-Five" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>Given the following:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split} \begin{array}{cccc}
&amp;  A^{''} = \left[ \begin{array}{ccc} 0.0001 &amp; 0.0001 &amp; 0.5 \\
0.5 &amp;      1 &amp; 1 \\
0.0001 &amp;      1 &amp; 0.0001
\end{array}
\right]
&amp; \ \ \ &amp;
b^{'} = \left[ \begin{array}{c} 1 \\ 0 \\ 1
\end{array}
\right]  \\ \\
\rightarrow &amp;
\left[  \begin{array}{cc}
\begin{array}{ccc}   0.0001 &amp; 0.0001 &amp; 0.5  \\
0.5 &amp;      1 &amp;  1   \\
0.0001 &amp;      1 &amp; 0.0001
\end{array}
&amp;  \left|   \begin{array}{c}  1 \\ 0 \\ 1
\end{array}
\right]
\end{array}
\right.  &amp;  &amp;
\end{array}\end{split}\]</div>
<p>Use Python to find the condition number of <span class="math notranslate nohighlight">\(A^{''}\)</span> and the solution to this system.</p>
</div></blockquote>
<blockquote>
<div><p>Looking at the system, if no rows are exchanged, then taking 0.0001 as the pivot will magnify any errors made in the elements in column 1 by a factor of 10,000. With partial pivoting, the first two rows can be exchanged (as below):</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
\begin{array}{c} \\  E_{1j} \leftrightarrow E_{2j} \\ \rightarrow
\end{array}
&amp;   \begin{array}{ccccc}
&amp; x_1 &amp; x_2 &amp; x_3 &amp;  \\
\left[ \begin{array}{c} \\  \\  \\ \end{array} \right.
&amp; \begin{array}{c} 0.5 \\ 0.0001 \\ 0.0001  \end{array}
&amp; \begin{array}{c}   1 \\ 0.0001 \\ 1       \end{array}
&amp; \begin{array}{c}   1 \\    0.5 \\ 0.0001  \end{array}
&amp; \left|  \begin{array}{c}   0 \\ 1 \\ 1  \end{array} \right]
\end{array}
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>and the magnification by 10,000 is avoided. Now the matrix will be expanded by a factor of 2. However, if the entry 1 is used as the pivot, then the matrix does not need to be expanded by 2 either. The only way to put 1 in the position of the first pivot is to perform a column exchange between columns one and two, or between columns one and three. This is full pivoting.</p>
<p>Note that when columns are exchanged, the variables represented by the columns are switched as well, i.e.¬†when columns one and two are exchanged, the new column one represents <span class="math notranslate nohighlight">\(x_2\)</span> and the new column two represents <span class="math notranslate nohighlight">\(x_1\)</span>. So, we must keep track of the columns when performing column pivoting.</p>
</div></blockquote>
<blockquote>
<div><p>So the columns one and two are exchanged, and the matrix becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
\begin{array}{c} \\ E_{i1} \leftrightarrow E_{i2} \\ \rightarrow
\end{array}
&amp;    \begin{array}{ccccc}
&amp; x_2 &amp; x_1 &amp; x_3 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c}   1 \\ 0.0001 \\      1  \end{array}
&amp; \begin{array}{c} 0.5 \\ 0.0001 \\ 0.0001  \end{array}
&amp; \begin{array}{c}   1 \\    0.5 \\ 0.0001  \end{array}
&amp; \left|  \begin{array}{c}   0 \\ 1 \\ 1  \end{array} \right]
\end{array}  \\    \\
\begin{array}{c}  \\ E_{2j}-0.0001E_{1j} \\ E_{3j}-E_{1j} \\ \rightarrow
\end{array}
&amp;    \begin{array}{ccccc}
&amp; x_2 &amp; x_1 &amp; x_3 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c}   1 \\       0 \\      0  \end{array}
&amp; \begin{array}{c} 0.5 \\ 0.00005 \\ -0.4999  \end{array}
&amp; \begin{array}{c}   1 \\  0.4999 \\ -0.9999  \end{array}
&amp; \left|  \begin{array}{c}   0 \\ 1 \\ 1  \end{array} \right]
\end{array}
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>If we assume rounding is performed, then the entries are rounded off:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp; \begin{array}{ccccc}
&amp; x_2 &amp; x_1 &amp; x_3 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c}   1 \\       0 \\    0  \end{array}
&amp; \begin{array}{c} 0.5 \\ 0.00005 \\ -0.5  \end{array}
&amp; \begin{array}{c}   1 \\     0.5 \\   -1  \end{array}
&amp; \left|  \begin{array}{c}   0 \\ 1 \\ 1  \end{array} \right]
\end{array}  \\   \\
\begin{array}{c}  \\ -E_{3j}  \\
E_{2j} \leftrightarrow E_{3j} \\
E_{i2} \leftrightarrow E_{i3} \\
\rightarrow
\end{array}
&amp;  \begin{array}{ccccc}
&amp; x_2 &amp; x_3 &amp; x_1 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c}   1 \\   0 \\       0  \end{array}
&amp; \begin{array}{c}   1 \\   1 \\     0.5  \end{array}
&amp; \begin{array}{c} 0.5 \\ 0.5 \\ 0.00005    \end{array}
&amp; \left|  \begin{array}{r}   0 \\ -1 \\ 1  \end{array} \right]
\end{array}  \\    \\
\begin{array}{c}  E_{1j}-E_{2j}  \\
E_{3j}-0.5 E_{2j} \\
\rightarrow
\end{array}
&amp;  \begin{array}{ccccc}
&amp; x_2 &amp; x_3 &amp; x_1 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c} 1 \\   0 \\        0  \end{array}
&amp; \begin{array}{c} 0 \\   1 \\        0  \end{array}
&amp; \begin{array}{c} 0 \\ 0.5 \\ -0.24995    \end{array}
&amp; \left|  \begin{array}{r}   1 \\ -1 \\ 1.5  \end{array} \right]
\end{array}
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>Rounding off the matrix again:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
\begin{array}{c} \rightarrow  \end{array}
&amp;   \begin{array}{ccccc}
&amp; x_2 &amp; x_3 &amp; x_1 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c} 1 \\   0 \\     0  \end{array}
&amp; \begin{array}{c} 0 \\   1 \\     0  \end{array}
&amp; \begin{array}{c} 0 \\ 0.5 \\ -0.25    \end{array}
&amp; \left|  \begin{array}{r}   1 \\ -1 \\ 1.5  \end{array} \right]
\end{array}  \\    \\
\begin{array}{c}  E_{2j}-2E_{3j}   \\
4E_{3j}  \\
\rightarrow  \end{array}
&amp;  \begin{array}{ccccc}
&amp; x_2 &amp; x_3 &amp; x_1 &amp;  \\
\left. \begin{array}{c} \\  \\  \\ \end{array} \right[
&amp; \begin{array}{c} 1 \\ 0 \\ 0  \end{array}
&amp; \begin{array}{c} 0 \\ 1 \\ 0  \end{array}
&amp; \begin{array}{c} 0 \\ 0 \\ 1    \end{array}
&amp; \left|  \begin{array}{r}   1 \\ 2 \\ -6  \end{array} \right]
\end{array}
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>So reading from the matrix, <span class="math notranslate nohighlight">\(x_1\)</span> = -6, <span class="math notranslate nohighlight">\(x_2\)</span> = 1 and <span class="math notranslate nohighlight">\(x_3\)</span> = 2. Compare this with the answer you get with Python, which is <span class="math notranslate nohighlight">\(x_1 \approx\)</span> -6.0028, <span class="math notranslate nohighlight">\(x_2 \approx\)</span> 1.0004 and <span class="math notranslate nohighlight">\(x_3 \approx\)</span> 2.0010 .</p>
<p>Using full pivoting with Gaussian elimination, expansion of the error by large factors is avoided. In addition, the approximated solution, using rounding (which is analogous to the use of floating point approximations), is close to the correct answer.</p>
</div></blockquote>
<blockquote>
<div><p>You can try the example with Python.</p>
</div></blockquote>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
<div class="section" id="Summary">
<h4>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¬∂</a></h4>
<p>In a system <span class="math notranslate nohighlight">\(Ax = b\)</span>, if round-off errors in <span class="math notranslate nohighlight">\(A\)</span> or <span class="math notranslate nohighlight">\(b\)</span> affect the system such that it may not give a solution that is close to the real answer, then <span class="math notranslate nohighlight">\(A\)</span> is ill-conditioned, and it has a very large condition number.</p>
<p>Sometimes, due to a poor algorithm, such as Gaussian elimination without pivoting, a matrix may appear to be ill-conditioned, even though it is not. By applying partial pivoting, this problem is reduced, but partial pivoting will not always eliminate the effects of round-off error. An even better way is to apply full pivoting. Of course, the drawback of this method is that the computation is more expensive than plain Gaussian elimination.</p>
<p>An important point to remember is that partial and full pivoting minimize the effects of round-off error for well-conditioned matrices. If a matrix is ill-conditioned, these methods will not provide a solution that approximates the real answer. As an exercise, you can try to apply full pivoting to the ill-conditioned matrix <span class="math notranslate nohighlight">\(A\)</span> seen at the beginning of this section (Example <a class="reference external" href="#Example-Two">Two</a>). You will find that the solution is still inaccurate.</p>
</div>
</div>
<div class="section" id="Matrix-Inversion">
<h3>Matrix Inversion<a class="headerlink" href="#Matrix-Inversion" title="Permalink to this headline">¬∂</a></h3>
<p>Given a square matrix <span class="math notranslate nohighlight">\(A\)</span>. If there is a matrix that will cancel <span class="math notranslate nohighlight">\(A\)</span>, then it is the <em>inverse</em> of <span class="math notranslate nohighlight">\(A\)</span>. In other words, the matrix, multiplied by its inverse, will give the identity matrix <span class="math notranslate nohighlight">\(I\)</span>.</p>
<p>Try to find the inverse for the following matrices:</p>
<ol class="arabic">
<li><div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{rrr}    1 &amp; -2 &amp;  1 \\
                                     3 &amp;  1 &amp; -1 \\
                                    -1 &amp;  9 &amp; -5     \end{array} \right]\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}B = \left[ \begin{array}{rrr}    5 &amp; -2 &amp;  4 \\
                                    -3 &amp;  1 &amp; -5 \\
                                     2 &amp; -1 &amp;  3     \end{array} \right]\end{split}\]</div>
</li>
</ol>
<p>The solutions to these exercises are available <a class="reference external" href="lab3_files/quizzes/inverse/inverse.html">here</a></p>
<p>After solving the questions by hand, you can use Python to check your answer.</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
<div class="section" id="Determinant">
<h3>Determinant<a class="headerlink" href="#Determinant" title="Permalink to this headline">¬∂</a></h3>
<p>Every square matrix <span class="math notranslate nohighlight">\(A\)</span> has a scalar associated with it. This number is the determinant of the matrix, represented as <span class="math notranslate nohighlight">\(\det(A)\)</span>. Its absolute value is the volume of the parallelogram that can be generated from the rows of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>A few special properties to remember about determinants:</p>
<ol class="arabic">
<li><p><span class="math notranslate nohighlight">\(A\)</span> must be a square matrix.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(A\)</span> is singular, <span class="math notranslate nohighlight">\(\det(A) =0\)</span>, i.e.¬†<span class="math notranslate nohighlight">\(A\)</span> does not have an inverse.</p></li>
<li><p>The determinant of a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix is just the difference between the products of the diagonals, i.e.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccc}
\left[  \begin{array}{cc}  a &amp; b \\ c &amp; d   \end{array} \right]  &amp;
= &amp;
\begin{array}{ccc} ad &amp; - &amp; bc  \end{array}
\end{array}\end{split}\]</div>
</li>
<li><p>For any diagonal, upper triangular or lower triangular matrix <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(\det(A)\)</span> is the product of all the entries on the diagonal,</p></li>
</ol>
<div class="section" id="Example-Six">
<h4>Example Six<a class="headerlink" href="#Example-Six" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp; \det \left[
\begin{array}{rrr}
2 &amp; 5 &amp; -8  \\
0 &amp; 1 &amp;  7  \\
0 &amp; 0 &amp; -4
\end{array} \right]  \\   \\
= &amp; 2 \times 1 \times -4 \\
= &amp; -8
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>Graphically, the parallelogram looks as follows:</p>
</div></blockquote>
<p>The basic procedure in finding a determinant of a matrix larger than 2 <span class="math notranslate nohighlight">\(\times\)</span> 2 is to calculate the product of the non-zero entries in each of the <em>permutations</em> of the matrix, and then add them together. A permutation of a matrix <span class="math notranslate nohighlight">\(A\)</span> is a matrix of the same size with one element from each row and column of <span class="math notranslate nohighlight">\(A\)</span>. The sign of each permutation is <span class="math notranslate nohighlight">\(+\)</span> or <span class="math notranslate nohighlight">\(-\)</span> depending on whether the permutation is odd or even. This is illustrated in the following example ‚Ä¶</p>
</div>
<div class="section" id="Example-Seven">
<h4>Example Seven<a class="headerlink" href="#Example-Seven" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}I = \left[ \begin{array}{ccc}  1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 \\
7 &amp; 8 &amp; 9  \end{array}  \right]\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>will have the following permutations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cccccc}
+\left[ \begin{array}{ccc}  1 &amp;   &amp;   \\
&amp; 5 &amp;   \\
&amp;   &amp; 9  \end{array}  \right]
&amp; , &amp;
+\left[ \begin{array}{ccc}    &amp; 2 &amp;   \\
&amp;   &amp; 6 \\
7 &amp;   &amp;    \end{array}  \right]
&amp; , &amp;
+\left[ \begin{array}{ccc}    &amp;   &amp; 3 \\
4 &amp;   &amp;   \\
&amp; 8 &amp;    \end{array}  \right]
&amp; ,  \\  \\
-\left[ \begin{array}{ccc}  1 &amp;   &amp;   \\
&amp;   &amp; 6 \\
&amp; 8 &amp;    \end{array}  \right]
&amp; , &amp;
-\left[ \begin{array}{ccc}    &amp; 2 &amp;   \\
4 &amp;   &amp;   \\
&amp;   &amp; 9  \end{array}  \right]
&amp; , &amp;
-\left[ \begin{array}{ccc}    &amp;   &amp; 3 \\
&amp; 5 &amp;   \\
7 &amp;   &amp;    \end{array}  \right]
&amp; .
\end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>The determinant of the above matrix is then given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccl}
det(A) &amp; = &amp; +1\cdot 5\cdot 9 +  2 \cdot 6 \cdot 7 + 3 \cdot 4 \cdot 8 - 1
\cdot 6 \cdot 8 - 2 \cdot 4 \cdot 9 - 3 \cdot 5 \cdot 7 \\
&amp; = &amp; 0\end{array}\end{split}\]</div>
</div></blockquote>
<p>For each of the following matrices, determine whether or not it has an inverse:</p>
<ol class="arabic">
<li><div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{rrr}    3 &amp; -2 &amp;  1 \\
                                     1 &amp;  5 &amp; -1 \\
                                    -1 &amp;  0 &amp;  0    \end{array} \right]\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}B = \left[ \begin{array}{rrr}    4 &amp; -6 &amp;  1 \\
                                     1 &amp; -3 &amp;  1 \\
                                     2 &amp;  0 &amp; -1    \end{array} \right]\end{split}\]</div>
</li>
<li><p>Try to solve this by yourself first, and use Python to check your answer:</p>
<div class="math notranslate nohighlight">
\[\begin{split}C = \left[ \begin{array}{rrrr}  4 &amp; -2 &amp; -7 &amp;  6   \\
                                   -3 &amp;  0 &amp;  1 &amp;  0   \\
                                   -1 &amp; -1 &amp;  5 &amp; -1   \\
                                    0 &amp;  1 &amp; -5 &amp;  3
\end{array} \right]\end{split}\]</div>
</li>
</ol>
<p>The solutions to these exercises are available <a class="reference external" href="lab3_files/quizzes/det/det.html">here</a></p>
<p>After solving the questions by hand, you can use Python to check your answer.</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
</div>
<div class="section" id="Computational-cost-of-Gaussian-elimination">
<h3>Computational cost of Gaussian elimination<a class="headerlink" href="#Computational-cost-of-Gaussian-elimination" title="Permalink to this headline">¬∂</a></h3>
<p>Although Gaussian elimination is a basic and relatively simple technique to find the solution of a linear system, it is a costly algorithm. Here is an operation count of this method:</p>
<p>For a <span class="math notranslate nohighlight">\(n \times n\)</span> matrix, there are two kinds of operations to consider:</p>
<ol class="arabic simple">
<li><p>division ( <em>div</em>) - to find the multiplier from a chosen pivot</p></li>
<li><p>multiplication-subtraction ( <em>mult/sub</em> ) - to calculate new entries for the matrix</p></li>
</ol>
<p>Note that an addition or subtraction operation has negligible cost in relation to a multiplication or division operation. So the subtraction in this case can be treated as one with the multiplication operation. The first pivot is selected from the first row in the matrix. For each of the remaining rows, one div and <span class="math notranslate nohighlight">\((n-1)\)</span> mult/sub operations are used to find the new entries. So there are <span class="math notranslate nohighlight">\(n\)</span> operations performed on each row. With <span class="math notranslate nohighlight">\((n-1)\)</span> rows, there are a total of
<span class="math notranslate nohighlight">\(n(n-1) = n^{2}-n\)</span> operations associated with this pivot.</p>
<div class="line-block">
<div class="line">Since the subtraction operation has negligible cost in relation to the multiplication operation, there are <span class="math notranslate nohighlight">\((n-1)\)</span> operations instead of <span class="math notranslate nohighlight">\(2(n-1)\)</span> operations. For the second pivot, which is selected from the second row of the matrix, similar analysis is applied. With the remaining <span class="math notranslate nohighlight">\((n-1) \times (n-1)\)</span> matrix, each row has one div and <span class="math notranslate nohighlight">\((n-2)\)</span> mult/sub operations. For the whole process, there are a total of <span class="math notranslate nohighlight">\((n-1)(n-2) = (n-1)^{2} - (n-1)\)</span> operations.</div>
</div>
<div class="line-block">
<div class="line">For the rest of the pivots, the number of operations for a remaining <span class="math notranslate nohighlight">\(k \times k\)</span> matrix is <span class="math notranslate nohighlight">\(k^{2} - k\)</span>.</div>
</div>
<p>The following is obtained when all the operations are added up:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
(1^{2}+\ldots +n^{2}) - (1+\ldots +n) \\ \\
= \frac{n(n+1)(2n+1)}{6} - \frac{n(n+1)}{2} \\ \\
= \frac{n^{3}-n}{3} \\ \\
\approx O(n^{3})
\end{array}\end{split}\]</div>
<p>As one can see, the Gaussian elimination is an <span class="math notranslate nohighlight">\(O(n^{3})\)</span> algorithm. For large matrices, this can be prohibitively expensive. There are other methods which are more efficient, e.g.¬†see <a class="reference external" href="#Iterative-Methods">Iterative Methods</a>.</p>
<div class="section" id="Problem-One">
<h4>Problem One<a class="headerlink" href="#Problem-One" title="Permalink to this headline">¬∂</a></h4>
<p>Consider a very simple three box model of the movement of a pollutant in the atmosphere, fresh-water and ocean. The mass of the atmosphere is MA (5600 x 10<span class="math notranslate nohighlight">\(^{12}\)</span> tonnes), the mass of the fresh-water is MF (360 x 10<span class="math notranslate nohighlight">\(^{12}\)</span>tonnes) and the mass of the upper layers of the ocean is MO (50,000 x 10<span class="math notranslate nohighlight">\(^{12}\)</span> tonnes). The amount of pollutant in the atmosphere is A, the amount in the fresh water is F and the amount in the ocean is O.</p>
<p>The pollutant is going directly into the atmosphere at a rate P1 = 1000 tonnes/year and into th efresh-water system at a rate P2 = 2000 tonnes/year. The pollutant diffuses between the atmosphere and ocean at a rate depending linearly on the difference in concentration with a diffusion constant L1 = 200 tonnes/year. The diffusion between the fresh-water system and the atmosphere is faster as the fresh water is shallower, L2 = 500 tonnes/year. The fresh-water system empties into the ocean at the
rate of Q = 36 x 10<span class="math notranslate nohighlight">\(^{12}\)</span> tonnes/year. Lastly the pollutant decays (like radioactivity) at a rate L3 = 0.05 /year.</p>
<p>See the graphical presentation of the cycle described above in Figure <a class="reference external" href="#Figure-Box-Model">Box Model</a> Schematic for Problem 1.</p>
<ul class="simple">
<li><ol class="loweralpha simple">
<li><p>Consider the steady state. There is no change in A, O, or F. Write down the three linear governing equations. Write the equations as an augmented matrix. Use Octave to find the solution.</p></li>
</ol>
</li>
<li><ol class="loweralpha simple" start="2">
<li><p>Show mathematically that there is no solution to this problem with L3 = 0. Why, physically, is there no solution?</p></li>
</ol>
</li>
<li><ol class="loweralpha simple" start="3">
<li><p>Show mathematically that there is an infinite number of solutions if L3 = 0 and P1 = P2 = 0. Why, physically?</p></li>
</ol>
</li>
<li><ol class="loweralpha simple" start="4">
<li><p>For part c) above, what needs to be specified in order to determine a single physical solution. How would you put this in the matrix equation.</p></li>
</ol>
</li>
</ul>
<div id="Figure-Box-Model"><p><strong>Figure Box Model:</strong> Schematic for <a class="reference external" href="#Problem-One">Problem One</a>.</p>
</div></div>
</div>
</div>
<div class="section" id="Eigenvalue-Problems">
<h2>Eigenvalue Problems<a class="headerlink" href="#Eigenvalue-Problems" title="Permalink to this headline">¬∂</a></h2>
<p>This section is a review of eigenvalues and eigenvectors.</p>
<div class="section" id="Characteristic-Equation">
<h3>Characteristic Equation<a class="headerlink" href="#Characteristic-Equation" title="Permalink to this headline">¬∂</a></h3>
<p>The basic equation for eigenvalue problems is the characteristic equation, which is:</p>
<div class="math notranslate nohighlight">
\[\det( A - \lambda I ) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a square matrix, I is an identity the same size as <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(\lambda\)</span> is an eigenvalue of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>In order for a number to be an eigenvalue of a matrix, it must satisfy the characteristic equation, for example:</p>
<div class="section" id="Example-Eight">
<h4>Example Eight<a class="headerlink" href="#Example-Eight" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>Given</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{rr}  3 &amp; -2 \\ -4 &amp; 5  \end{array} \right]\end{split}\]</div>
<p>To find the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span>, you need to solve the characteristic equation for all possible <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccl}
0 &amp; = &amp; \det (A - \lambda I)  \\
&amp; = &amp; \begin{array}{cccc}
\det &amp; \left(
\left[ \begin{array}{rr}  3 &amp; -2 \\ -4 &amp; 5  \end{array} \right] \right. &amp;
- &amp;
\lambda \left. \left[ \begin{array}{rr} 1 &amp; 0 \\ 0 &amp; 1 \end{array} \right]   \right)
\end{array}   \\  \\
&amp; = &amp; \begin{array}{cc}
\det &amp;
\left[ \begin{array}{cc} 3-\lambda &amp; -2 \\ -4 &amp; 5-\lambda
\end{array}  \right]
\end{array}  \\  \\
&amp; = &amp; \begin{array}{ccc} (3-\lambda)(5-\lambda) &amp; - &amp; (-2)(-4)
\end{array}  \\  \\
&amp; = &amp; (\lambda - 1)(\lambda - 7)  \\ \\
\end{array}\end{split}\]</div>
<p>So, <span class="math notranslate nohighlight">\(\lambda = 1 \mbox{ or } 7\)</span>, i.e.¬†the eigenvalues of the matrix <span class="math notranslate nohighlight">\(A\)</span> are 1 and 7.</p>
</div></blockquote>
<blockquote>
<div><p>You can use Python to check this answer.</p>
</div></blockquote>
<p>Find the eigenvalues of the following matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left[
   \begin{array}{ccc}  3 &amp; 2 &amp; 4 \\ 2 &amp; 0 &amp; 2 \\ 4 &amp; 2 &amp; 3
   \end{array}    \right]\end{split}\]</div>
<p>The solution to this problem is available <a class="reference external" href="lab3_files/quizzes/char/char.html">here</a></p>
<p>After solving the questions by hand, you can use Python to check your answer.</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
</div>
<div class="section" id="Condition-Number">
<h4>Condition Number<a class="headerlink" href="#Condition-Number" title="Permalink to this headline">¬∂</a></h4>
<p>The eigenvalues of a matrix <span class="math notranslate nohighlight">\(A\)</span> can be used to calculate an approximation to the condition number <span class="math notranslate nohighlight">\(K\)</span> of the matrix, i.e.</p>
<div class="math notranslate nohighlight">
\[K \approx \left|  \frac{\lambda_{max}}{\lambda_{min}}  \right|\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_{max}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{min}\)</span> are the maximum and minimum eigenvalues of <span class="math notranslate nohighlight">\(A\)</span>. When <span class="math notranslate nohighlight">\(K\)</span> is large, i.e.¬†the <span class="math notranslate nohighlight">\(\lambda_{max}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{min}\)</span> are far apart, then <span class="math notranslate nohighlight">\(A\)</span> is ill-conditioned.</p>
<p>The mathematical definition of <span class="math notranslate nohighlight">\(K\)</span> is</p>
<div class="math notranslate nohighlight">
\[K = \|A\|\|A^{-1}\|\]</div>
<p>where <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> represents the norm of a matrix.</p>
<p>There are a few norms which can be chosen for the formula. The default one used in Python for finding <span class="math notranslate nohighlight">\(K\)</span> is the 2-norm of the matrix. To see how to compute the norm of a matrix, see a linear algebra text. Nevertheless, the main concern here is the formula, and the fact that this can be very expensive to compute. Actually, the computing of <span class="math notranslate nohighlight">\(A^{-1}\)</span> is the costly operation.</p>
<p>Note: In Python, the results from the function <em>cond</em>(<span class="math notranslate nohighlight">\(A\)</span>) can have round-off errors.</p>
<p>For the matrices in this section (A from Example 8 and B just below it) for which you have found the eigenvalues, use the built-in Python function <em>np.linalg.cond</em>(<span class="math notranslate nohighlight">\(A\)</span>) to find <span class="math notranslate nohighlight">\(K\)</span>, and compare this result with the <span class="math notranslate nohighlight">\(K\)</span> approximated from the eigenvalues.</p>
</div>
</div>
<div class="section" id="Eigenvectors">
<h3>Eigenvectors<a class="headerlink" href="#Eigenvectors" title="Permalink to this headline">¬∂</a></h3>
<p>Another way to look at the characteristic equation is using vectors instead of determinant. For a number to be an eigenvalue of a matrix, it must satisfy this equation:</p>
<div class="math notranslate nohighlight">
\[( A - \lambda I ) x = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(n \times n\)</span> square matrix, <span class="math notranslate nohighlight">\(I\)</span> is an identity matrix the same size as <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(\lambda\)</span> is an eigenvalue of <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(x\)</span> is a non-zero vector associated with the particular eigenvalue that will make this equation true. This vector is the eigenvector. The eigenvector is not necessarily unique for an eigenvalue. This will be further discussed below after the example.</p>
<p>The above equation can be rewritten as:</p>
<div class="math notranslate nohighlight">
\[A x = \lambda x\]</div>
<p>For each eigenvalue of <span class="math notranslate nohighlight">\(A\)</span>, there is a corresponding eigenvector. Below is an example.</p>
<div class="section" id="Example-Nine">
<h4>Example Nine<a class="headerlink" href="#Example-Nine" title="Permalink to this headline">¬∂</a></h4>
<blockquote>
<div><p>Following the example from the previous section:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{rr}  3 &amp; -2 \\ -4 &amp; 5  \end{array} \right]\end{split}\]</div>
<p>The eigenvalues, <span class="math notranslate nohighlight">\(\lambda\)</span>, for this matrix are 1 and 7. To find the eigenvectors for the eigenvalues, you need to solve the equation:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[( A - \lambda I ) x = 0.\]</div>
<p>This is just a linear system <span class="math notranslate nohighlight">\(A^{\prime}x = b\)</span>, where <span class="math notranslate nohighlight">\(A^{\prime} = ( A - \lambda I )\)</span>, <span class="math notranslate nohighlight">\(b = 0\)</span>. To find the eigenvectors, you need to find the solution to this augmented matrix for each <span class="math notranslate nohighlight">\(\lambda\)</span> respectively,</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cl}
&amp; ( A - \lambda I ) x = 0 \ \ \ \ \ \ \ \ {\rm where} \ \ \ \ \ \ \lambda = 1 \\
\; &amp; \; \\
\rightarrow &amp;
\left( \begin{array}{ccc}
\left[ \begin{array}{rr}  3 &amp; -2 \\ -4 &amp; 5 \end{array} \right]
&amp; - &amp;
1 \left[ \begin{array}{cc} 1 &amp; 0 \\ 0 &amp; 1 \end{array} \right]
\end{array} \right) x = 0   \\   \\
\rightarrow &amp;
\left[ \begin{array}{cc}
\begin{array}{rr}  2 &amp; -2 \\ -4 &amp; 4 \end{array}
&amp; \left| \begin{array}{c} 0 \\ 0  \end{array}  \right]
\end{array}   \right.  \\  \\
\rightarrow &amp;
\left[ \begin{array}{cc}
\begin{array}{rr}  1 &amp; -1 \\ 0 &amp; 0 \end{array}
&amp; \left| \begin{array}{c} 0 \\ 0  \end{array}  \right]
\end{array}   \right.
\end{array}\end{split}\]</div>
<p>Reading from the matrix,</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccc} x_1 &amp; - &amp; x_2 &amp; = &amp; 0  \\
&amp;   &amp;   0 &amp; = &amp; 0 \end{array}\end{split}\]</div>
<div class="line-block">
<div class="line">As mentioned before, the eigenvector is not unique for a given eigenvalue. As seen here, the solution to the matrix is a description of the direction of the vectors that will satisfy <span class="math notranslate nohighlight">\(Ax = \lambda x\)</span>. Letting <span class="math notranslate nohighlight">\(x_1 = 1\)</span>, then <span class="math notranslate nohighlight">\(x_2 = 1\)</span>. So the vector (1, 1) is an eigenvector for the matrix <span class="math notranslate nohighlight">\(A\)</span> when <span class="math notranslate nohighlight">\(\lambda = 1\)</span>. (So is (-1,-1), (2, 2), etc)</div>
</div>
</div></blockquote>
<blockquote>
<div><p>In the same way for <span class="math notranslate nohighlight">\(\lambda = 7\)</span>, the solution is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccc} 2 x_1 &amp; + &amp; x_2 &amp; = &amp; 0  \\
&amp;   &amp;    0 &amp; = &amp; 0 \end{array}\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>So an eigenvector here is x = (1, -2).</p>
<p>Using Python:</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="n">lamb</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lamb</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="p">[</span> <span class="mf">1.</span>  <span class="mf">7.</span><span class="p">]</span>
<span class="p">[[</span><span class="o">-</span><span class="mf">0.70710678</span>  <span class="mf">0.4472136</span> <span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.70710678</span> <span class="o">-</span><span class="mf">0.89442719</span><span class="p">]]</span>
</pre></div>
</div>
<blockquote>
<div><p>Matrix <span class="math notranslate nohighlight">\(x\)</span> is the same size a <span class="math notranslate nohighlight">\(A\)</span> and vector <span class="math notranslate nohighlight">\(lamb\)</span> is the size of one dimension of <span class="math notranslate nohighlight">\(A\)</span>. Each column of <span class="math notranslate nohighlight">\(x\)</span> is a unit eigenvector of <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(lamb\)</span> values are the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span>. Reading from the result, for <span class="math notranslate nohighlight">\(\lambda\)</span> = 1, the corresponding unit eigenvector is (-0.70711, -0.70711). The answer from working out the example by hand is (1, 1), which is a multiple of the unit eigenvector from Python.</p>
<p>(The unit eigenvector is found by dividing the eigenvector by its magnitude. In this case, <span class="math notranslate nohighlight">\(\mid\)</span>(1,1)<span class="math notranslate nohighlight">\(\mid\)</span> = <span class="math notranslate nohighlight">\(\sqrt{1^2 + 1^2}\)</span> = <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>, and so the unit eigenvector is (<span class="math notranslate nohighlight">\(\frac{1}{\sqrt{2}}, \frac{1}{\sqrt{2}}\)</span>) ).</p>
</div></blockquote>
<blockquote>
<div><p>Remember that the solution for an eigenvector is not the unique answer; it only represents a <em>direction</em> for an eigenvector corresponding to a given eigenvalue.</p>
</div></blockquote>
<p>What are the eigenvectors for the matrix <span class="math notranslate nohighlight">\(B\)</span> from the previous section?</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left[
   \begin{array}{ccc}  3 &amp; 2 &amp; 4 \\ 2 &amp; 0 &amp; 2 \\ 4 &amp; 2 &amp; 3
   \end{array}    \right]\end{split}\]</div>
<p>The solution to this problem is available <a class="reference external" href="lab3_file/quizzes/eigvec/eigvec.html">here</a></p>
<p>After solving the questions by hand, you can use Python to check your answer.</p>
<div style="padding-top:1.5cm"><p>üêæ</p>
</div><p><a class="reference external" href="#Numpy-and-Python-with-Matrices">Numpy and Python with Matrices</a></p>
<p>Although the method used here to find the eigenvalues is a direct way to find the solution, it is not very efficient, especially for large matrices. Typically, iterative methods such as the Power Method or the QR algorithm are used (see a linear algebra text such as <a class="reference external" href="#Ref:Strang88">Strang (1988)</a> for more details).</p>
</div>
</div>
</div>
<div class="section" id="Iterative-Methods">
<h2>Iterative Methods<a class="headerlink" href="#Iterative-Methods" title="Permalink to this headline">¬∂</a></h2>
<p>So far, the only method we‚Äôve seen for solving systems of linear equations is Gaussian Elimination (with its pivoting variants), which is only one of a class of <em>direct methods</em>. This name derives from the fact that the Gaussian Elimination algorithm computes the exact solution <em>directly</em>, in a finite number of steps. Other commonly-used direct methods are based on matrix decomposition or factorizations different from the <span class="math notranslate nohighlight">\(LU\)</span> decomposition (see Section <a class="reference external" href="#Decomposition">Decomposition</a>);
for example, the <span class="math notranslate nohighlight">\(LDL^T\)</span> and Choleski factorizations of a matrix. When the system to be solved is not too large, it is usually most efficient to employ a direct technique that minimizes the effects of round-off error (for example, Gaussian elimination with full pivoting).</p>
<p>However, the matrices that occur in the discretization of differential equations are typically <em>very large</em> and <em>sparse</em> ‚Äì that is, a large proportion of the entries in the matrix are zero. In this case, a direct algorithm, which has a cost on the order of <span class="math notranslate nohighlight">\(N^3\)</span> multiplicative operations, will be spending much of its time inefficiently, operating on zero entries. In fact, there is another class of solution algorithms called <em>iterative methods</em> which exploit the sparsity of such systems to
reduce the cost of the solution procedure, down to order <span class="math notranslate nohighlight">\(N^2\)</span> for <em>Jacobi‚Äôs method</em>, the simplest of the iterative methods (see Lab #8 ) and as low as order <span class="math notranslate nohighlight">\(N\)</span> (the optimal order) for <em>multigrid methods</em> (which we will not discuss here).</p>
<p>Iterative methods are based on the principle of computing an approximate solution to a system of equations, where an iterative procedure is applied to improve the approximation at every iteration. While the exact answer is never reached, it is hoped that the iterative method will approach the answer more rapidly than a direct method. For problems arising from differential equations, this is often possible since these methods can take advantage of the presence of a large number of zeroes in the
matrix. Even more importantly, most differential equations are only approximate models of real physical systems in the first place, and so in many cases, an approximation of the solution is sufficient!!!</p>
<p>None of the details of iterative methods will be discussed in this Lab. For now it is enough to know that they exist, and what type of problems they are used for. Neither will we address the questions: <em>How quickly does an iterative method converge to the exact solution?</em>, <em>Does it converge at all?</em>, and <em>When are they more efficient than a direct method?</em> Iterative methods will be discussed in more detail in Lab #8 , when a large, sparse system appears in the discretization of a PDE describing
the flow of water in the oceans.</p>
<p>For even more details on iterative methods, you can also look at <a class="reference external" href="#Ref:Strang88">Strang (1988)</a> [p.¬†403ff.], or one of the several books listed in the Readings section from Lab #8 .</p>
</div>
<div class="section" id="Solution-of-an-ODE-Using-Linear-Algebra">
<h2>Solution of an ODE Using Linear Algebra<a class="headerlink" href="#Solution-of-an-ODE-Using-Linear-Algebra" title="Permalink to this headline">¬∂</a></h2>
<p>So far, we‚Äôve been dealing mainly with matrices with dimensions <span class="math notranslate nohighlight">\(4\times 4\)</span> at the greatest. If this was the largest linear system that we ever had to solve, then there would be no need for computers ‚Äì everything could be done by hand! Nevertheless, even very simple differential equations lead to large systems of equations.</p>
<p>Consider the problem of finding the steady state heat distribution in a one-dimensional rod, lying along the <span class="math notranslate nohighlight">\(x\)</span>-axis between 0 and 1. We saw in Lab #1 that the temperature, <span class="math notranslate nohighlight">\(u(x)\)</span>, can be described by a boundary value problem, consisting of the ordinary differential equation</p>
<div class="math notranslate nohighlight">
\[u_{xx} = f(x),\]</div>
<p>along with boundary values</p>
<div class="math notranslate nohighlight">
\[u(0)=u(1) = 0.\]</div>
<p>The only difference between this example and the one from Lab #1 is that the right hand side function, <span class="math notranslate nohighlight">\(f(x)\)</span>, is non-zero, which corresponds to a heat source being applied along the length of the rod. The boundary conditions correspond to the ends of the rod being held at constant (zero) temperature ‚Äì this type of condition is known as a fixed or <em>Dirichlet</em> boundary condition.</p>
<p>If we discretize this equation at <span class="math notranslate nohighlight">\(N\)</span> discrete points, <span class="math notranslate nohighlight">\(x_i=id\)</span>, <span class="math notranslate nohighlight">\(i=0,1,\dots,N\)</span>, where <span class="math notranslate nohighlight">\(d = 1/N\)</span> is the grid spacing, then the ordinary differential equation can be approximated at a point <span class="math notranslate nohighlight">\(x_i\)</span> by the following system of linear equations:</p>
<div id="lab3:eq:diff-ode"><p>(Discrete Differential Equation)</p>
<div class="math notranslate nohighlight">
\[\frac{u_{i+1} - 2u_i+u_{i-1}}{d^2} = f_i,\]</div>
</div><p>where <span class="math notranslate nohighlight">\(f_i=f(x_i)\)</span>, and <span class="math notranslate nohighlight">\(u_i\approx u(x_i)\)</span> is an approximation of the steady state temperature at the discrete points. If we write out all of the equations, for the unknown values <span class="math notranslate nohighlight">\(i=1,\dots,N-1\)</span>, along with the boundary conditions at <span class="math notranslate nohighlight">\(i=0,N\)</span>, we obtain the following set of <span class="math notranslate nohighlight">\(N+1\)</span> equations in <span class="math notranslate nohighlight">\(N+1\)</span> unknowns:</p>
<div id="lab3:eq:diff-system"><p>(Differential System)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccccccccc}
  u_0 &amp; &amp;     &amp; &amp;       &amp; &amp;         &amp; &amp;     &amp;=&amp; 0 \\
  u_0 &amp;-&amp;2u_1 &amp;+&amp;  u_2  &amp; &amp;         &amp; &amp;     &amp;=&amp; d^2 f_1\\
      &amp; &amp; u_1 &amp;-&amp; 2u_2  &amp;+&amp; u_3     &amp; &amp;     &amp;=&amp; d^2f_2\\
      &amp; &amp;     &amp; &amp;       &amp; &amp; \dots   &amp; &amp;     &amp;=&amp; \\
      &amp; &amp;     &amp; &amp;u_{N-2}&amp;-&amp; 2u_{N-1}&amp;+&amp; u_N &amp;=&amp; d^2f_{N-1}\\
      &amp; &amp;     &amp; &amp;       &amp; &amp;         &amp; &amp; u_N &amp;=&amp; 0
\end{array}\end{split}\]</div>
</div><p>Remember that this system, like any other linear system, can be written in matrix notation as</p>
<div id="lab3:eq:dir-system"><p>(Differential System Matrix)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\underbrace{\left[
      \begin{array}{ccccccccc}
        1&amp;  0  &amp; &amp; \dots  &amp; &amp; &amp; &amp; &amp; 0 \\
        1&amp; {-2} &amp; {1} &amp; {0} &amp; {\dots} &amp; &amp;&amp; &amp;  \\
        0&amp; {1} &amp; {-2} &amp;  {1} &amp; {0} &amp; {\dots} &amp; &amp; &amp;  \\
        &amp; {0} &amp; {1}  &amp; {-2} &amp; {1} &amp; {0} &amp; {\dots} &amp; &amp;  \\
        &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\
        \vdots &amp; &amp; &amp; {\ddots} &amp; {\ddots} &amp; {\ddots} &amp; {\ddots} &amp; {\ddots} &amp; \vdots \\
        &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\
        &amp; &amp; &amp; {\dots} &amp; {0} &amp; {1} &amp; {-2} &amp; {1} &amp; 0 \\
        &amp; &amp;  &amp; &amp;{\dots} &amp; {0} &amp; {1} &amp; {-2} &amp; 1 \\
        0&amp; &amp; &amp; &amp; &amp; \dots &amp; &amp; 0 &amp; 1
      \end{array}
    \right]
    }_{A_1}
  \underbrace{\left[
      \begin{array}{c}
        u_0 \\ {u_1} \\ {u_2} \\ {u_3} \\ \ \\ {\vdots} \\ \
        \\ {u_{N-2}} \\ {u_{N-1}} \\ u_N
      \end{array}
    \right]
    }_{U}
  =
    \underbrace{\left[
      \begin{array}{c}
        0 \\ {d^2 f_1} \\ {d^2 f_2} \\ {d^2 f_3} \\ \ \\
        {\vdots} \\ \ \\ {d^2 f_{N-2}} \\ {d^2 f_{N-1}} \\ 0
      \end{array}
    \right]
    }_{F}\end{split}\]</div>
</div><p>or, simply <span class="math notranslate nohighlight">\(A_1 U = F\)</span>.</p>
<p>One question we might ask is: <em>How well-conditioned is the matrix :math:`A_1`?</em> or, in other words, <em>How easy is this system to solve?</em> To answer this question, we leave the right hand side, and consider only the matrix and its condition number. The size of the condition number is a measure of how expensive it will be to invert the matrix and hence solve the discrete boundary value problem.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Using Python, compute the condition number for the matrix <span class="math notranslate nohighlight">\(A_1\)</span> from Equation <a class="reference external" href="#lab3:eq:dir-system">Differential System Matrix</a> for several values of <span class="math notranslate nohighlight">\(N\)</span> between 5 and 50. ( <strong>Hint:</strong> This will be much easier if you write a small Python function that outputs the matrix <span class="math notranslate nohighlight">\(A\)</span> for a given value of <span class="math notranslate nohighlight">\(N\)</span>.)</p></li>
</ol>
</div></blockquote>
<blockquote>
<div><ol class="loweralpha simple" start="2">
<li><p>Can you conjecture how the condition number of <span class="math notranslate nohighlight">\(A_1\)</span> depends on <span class="math notranslate nohighlight">\(N\)</span>?</p></li>
<li><p>Another way to write the system of equations is to substitute the boundary conditions into the equations, and thereby reduce size of the problem to one of <span class="math notranslate nohighlight">\(N-1\)</span> equations in <span class="math notranslate nohighlight">\(N-1\)</span> unknowns. The corresponding matrix is simply the <span class="math notranslate nohighlight">\(N-1\)</span> by <span class="math notranslate nohighlight">\(N-1\)</span> submatrix of <span class="math notranslate nohighlight">\(A_1\)</span> from Equation <a class="reference external" href="#lab3:eq:dir-system">Differential System Matrix</a></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}A_2 = \left[
\begin{array}{ccccccc}
-2 &amp;  1 &amp;  0 &amp; \dots &amp; &amp;&amp; 0 \\
1 &amp; -2 &amp;  1 &amp; 0 &amp; \dots &amp; &amp; \\
0 &amp; 1  &amp; -2 &amp; 1 &amp; 0 &amp; \dots &amp;  \\
&amp; &amp; &amp; &amp; &amp; &amp; \\
\vdots &amp; &amp; \ddots &amp; \ddots&amp; \ddots &amp; \ddots &amp; \vdots\\
&amp; &amp; &amp; &amp; &amp; &amp; 0 \\
&amp; &amp; \dots &amp; 0 &amp; 1 &amp; -2 &amp; 1 \\
0&amp;  &amp; &amp;\dots &amp; 0 &amp; 1 &amp; -2 \\
\end{array}
\right]\end{split}\]</div>
<p>Does this change in the matrix make a significant difference in the condition number?</p>
</div></blockquote>
<p>So far, we‚Äôve only considered zero Dirichlet boundary values, <span class="math notranslate nohighlight">\(u_0=0=u_N\)</span>. Let‚Äôs look at a few more types of boundary values ‚Ä¶</p>
<p><strong>Fixed (non-zero) boundary conditions:</strong></p>
<blockquote>
<div><p>If we fixed the solution at the boundary to be some non-zero values, say by holding one end at temperature <span class="math notranslate nohighlight">\(u_0=a\)</span>, and the other at temperature <span class="math notranslate nohighlight">\(u_N=b\)</span>, then the matrix itself is not affected. The only thing that changes in Equation <a class="reference external" href="#lab3:eq:dir-system">Differential System</a> is that a term <span class="math notranslate nohighlight">\(a\)</span> is subtracted from the right hand side of the second equation, and a term <span class="math notranslate nohighlight">\(b\)</span> is subtracted from the RHS of the second-to-last equation. It is clear from what we‚Äôve just said
that non-zero Dirichlet boundary conditions have no effect at all on the matrix <span class="math notranslate nohighlight">\(A_1\)</span> (or <span class="math notranslate nohighlight">\(A_2\)</span>) since they modify only the right hand side.</p>
</div></blockquote>
<p><strong>No-flow boundary conditions:</strong></p>
<blockquote>
<div><p>These are conditions on the first derivative of the temperature</p>
<div class="math notranslate nohighlight">
\[u_x(0) = 0,\]</div>
<p></p>
<div class="math notranslate nohighlight">
\[u_x(1) = 0,\]</div>
<p>which are also known as <em>Neumann</em> boundary conditions. The requirement that the first derivative of the temperature be zero at the ends corresponds physically to the situation where the ends of the rod are <em>insulated</em>; that is, rather than fixing the temperature at the ends of the rod (as we did with the Dirichlet problem), we require instead that there is no heat flow in or out of the rod through the ends.</p>
</div></blockquote>
<blockquote>
<div><p>There is still one thing that is missing in the mathematical formulation of this problem: since only derivatives of <span class="math notranslate nohighlight">\(u\)</span> appear in the equations and boundary conditions, the solution is determined only up to a constant, and for there to be a unique solution, we must add an extra condition. For example, we could set</p>
<div class="math notranslate nohighlight">
\[u \left(\frac{1}{2} \right) = constant,\]</div>
<p>or, more realistically, say that the total heat contained in the rod is constant, or</p>
<div class="math notranslate nohighlight">
\[\int_0^1 u(x) dx = constant.\]</div>
<p>Now, let us look at the discrete formulation of the above problem ‚Ä¶</p>
</div></blockquote>
<blockquote>
<div><p>The discrete equations do not change, except for that discrete equations at <span class="math notranslate nohighlight">\(i=0,N\)</span> replace the Dirichlet conditions in Equation <a class="reference external" href="#lab3:eq:diff-system">Differential System</a>:</p>
<div id="lab3:eq:neumann-over"><p>(Neumann Boundary Conditions)</p>
<div class="math notranslate nohighlight">
\[u_{-1} - 2u_0 +u_{1} = d^2f_0 \quad {\rm and} \quad
u_{N-1} - 2u_N +u_{N+1} = d^2f_N\]</div>
</div><p>where we have introduced the additional <em>ghost points</em>, or <em>fictitious points</em> <span class="math notranslate nohighlight">\(u_{-1}\)</span> and <span class="math notranslate nohighlight">\(u_{N+1}\)</span>, <em>lying outside the boundary</em>. The temperature at these ghost points can be determined in terms of values in the interior using the discrete version of the Neumann boundary conditions</p>
<div class="math notranslate nohighlight">
\[\frac{u_{-1} - u_1}{2d} = 0 \;\; \Longrightarrow \;\; u_{-1}  = u_1,\]</div>
<div class="math notranslate nohighlight">
\[\frac{u_{N+1} - u_{N-1}}{2d} = 0 \;\; \Longrightarrow \;\; u_{N+1} = u_{N-1}.\]</div>
<p>Substitute these back into the <a class="reference external" href="#lab3:eq:neumann-over">Newmann Boundary Conditions</a> to obtain</p>
<div class="math notranslate nohighlight">
\[- 2u_0 + 2 u_1 =d^2 f_0 \quad {\rm and} \quad
+ 2u_{N-1} - 2 u_N =d^2 f_N .\]</div>
<p>In this case, the matrix is an <span class="math notranslate nohighlight">\(N+1\)</span> by <span class="math notranslate nohighlight">\(N+1\)</span> matrix, almost identical to Equation <a class="reference external" href="#lab3:eq:dir-system">Differential System Matrix</a>, but with the first and last rows slightly modified</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_3 = \left[
\begin{array}{ccccccc}
-2 &amp;  2 &amp;  0 &amp; \dots &amp; &amp;&amp; 0 \\
1 &amp; -2 &amp;  1 &amp; 0 &amp; \dots &amp; &amp; 0\\
0 &amp; 1  &amp; -2 &amp; 1 &amp; 0 &amp; \dots &amp; 0\\
&amp; &amp; &amp; &amp; &amp; &amp; \\
&amp; &amp; &amp; \ddots&amp; \ddots &amp; \ddots &amp;  \\
&amp; &amp; &amp; &amp; &amp; &amp; \\
0 &amp; &amp; \dots &amp; 0 &amp; 1 &amp; -2 &amp; 1 \\
0 &amp;  &amp; &amp;\dots &amp; 0 &amp; 2 &amp; -2
\end{array}
\right]\end{split}\]</div>
<p>This system is <em>not solvable</em>; that is, the <span class="math notranslate nohighlight">\(A_3\)</span> above is singular ( *try it in Python to check for yourself ‚Ä¶ this should be easy by modifying the code from <a class="reference external" href="#Problem-Two">Problem 2</a>). This is a discrete analogue of the fact that the continuous solution is not unique. The only way to overcome this problem is to add another equation for the unknown temperatures.</p>
</div></blockquote>
<p>Physically the reason the problem is not unique is that we don‚Äôt know how hot the rod is. If we think of the full time dependent problem:</p>
<ol class="arabic simple">
<li><p>given fixed temperatures at the end points of the rod (Dirichlet), whatever the starting temperature of the rod, eventually the rod will reach equilibrium. with a temperature smoothly varying between the values (given) at the end points.</p></li>
<li><p>However, if the rod is insulated (Neumann), no heat can escape and the final temperature will be related to the initial temperature. To solve this problem we need to know the steady state,</p></li>
</ol>
<ol class="loweralpha simple">
<li><p>the initial temperature of the rod,</p></li>
<li><p>the total heat of the rod,</p></li>
<li><p>or a final temperature at some point of the rod.</p></li>
</ol>
<blockquote>
<div><p>How can we make the discrete Neumann problem solvable? Think in terms of discretizing the <em>solvability conditions</em> <span class="math notranslate nohighlight">\(u(\frac{1}{2}) = c\)</span> (condition c) above), or <span class="math notranslate nohighlight">\(\int_0^1 u(x) dx = c\)</span> (condition b) above), (the integral condition can be thought of as an <em>average</em> over the domain, in which case we can approximate it by the discrete average <span class="math notranslate nohighlight">\(\frac{1}{N}(u_0+u_1+\dots+u_N)=c\)</span>).</p>
</div></blockquote>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Derive the matrix corresponding to the linear system to be solved in both of these cases.</p></li>
<li><p>How does the conditioning of the resulting matrix depend on the the size of the system?</p></li>
</ol>
</div></blockquote>
<blockquote>
<div><ol class="loweralpha simple" start="3">
<li><p>Is it better or worse than for Dirichlet boundary conditions?</p></li>
</ol>
</div></blockquote>
<p><strong>Periodic boundary conditions:</strong></p>
<blockquote>
<div><p>This refers to the requirement that the temperature at both ends remains the same:</p>
<div class="math notranslate nohighlight">
\[u(0) = u(1).\]</div>
<p>Physically, you can think of this as joining the ends of the rod together, so that it is like a <em>ring</em>. From what we‚Äôve seen already with the other boundary conditions, it is not hard to see that the discrete form of the one-dimensional diffusion problem with periodic boundary conditions leads to an <span class="math notranslate nohighlight">\(N\times N\)</span> matrix of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_4 = \left[
\begin{array}{ccccccc}
-2 &amp;  1 &amp;  0 &amp; \dots &amp; &amp;&amp; 1 \\
1 &amp; -2 &amp;  1 &amp; 0 &amp; \dots &amp; &amp; 0\\
0 &amp; 1  &amp; -2 &amp; 1 &amp; 0 &amp; \dots &amp; 0\\
&amp; &amp; &amp; &amp; &amp; &amp; \\
&amp; &amp; &amp; \ddots&amp; \ddots &amp; \ddots &amp;  \\
&amp; &amp; &amp; &amp; &amp; &amp; \\
0 &amp; &amp; \dots &amp; 0 &amp; 1 &amp; -2 &amp; 1 \\
1 &amp;  &amp; &amp;\dots &amp; 0 &amp; 1 &amp; -2
\end{array}
\right],\end{split}\]</div>
<p>where the unknown temperatures are now <span class="math notranslate nohighlight">\(u_i\)</span>, <span class="math notranslate nohighlight">\(i=0,1,\dots, N-1\)</span>. The major change to the form of the matrix is that the elements in the upper right and lower left corners are now 1 instead of 0. Again the same problem of the invertibility of the matrix comes up. This is a symptom of the fact that the continuous problem does not have a unique solution. It can also be remedied by tacking on an extra condition, such as in the Neumann problem above.</p>
</div></blockquote>
</div>
<div class="section" id="####-Problem-Four">
<h2>#### Problem Four<a class="headerlink" href="#####-Problem-Four" title="Permalink to this headline">¬∂</a></h2>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Derive the matrix <span class="math notranslate nohighlight">\(A_4\)</span> above using the discrete form <a class="reference external" href="#lab3:eq:diff-ode">Discrete Differential Equation</a> of the differential equation and the periodic boundary condition.</p></li>
</ol>
</div></blockquote>
<blockquote>
<div><ol class="loweralpha simple" start="2">
<li><p>For the periodic problem (with the extra integral condition on the temperature) how does the conditioning of the matrix compare to that for the other two discrete problems?</p></li>
</ol>
</div></blockquote>
<p>As you will have found in these problems, the boundary conditions can have an influence on the conditioning of a discrete problem. Furthermore, the method of discretizing the boundary conditions may or may not have a large effect on the condition number. Consequently, we must take care when discretizing a problem in order to obtain an efficient numerical scheme.</p>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¬∂</a></h2>
</div><div id="Ref:Strang86"><p>Strang, G., 1986: Introduction to Applied Mathematics. Wellesley-Cambridge Press, Wellesley, MA.</p>
</div></div><div id="Ref:Strang88"><p>Strang, G., 1988: Linear Algebra and its Applications. Harcourt Brace Jovanovich, San Diego, CA, 2nd edition.</p>
</div></div>
<div class="section" id="Numpy-and-Python-with-Matrices">
<h2>Numpy and Python with Matrices<a class="headerlink" href="#Numpy-and-Python-with-Matrices" title="Permalink to this headline">¬∂</a></h2>
<p><strong>To start, import numpy,</strong></p>
<p>Enter:</p>
<blockquote>
<div><p>import numpy as np</p>
</div></blockquote>
<p><strong>To enter a matrix,</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \left[ \begin{array}{ccc} a, &amp; b, &amp; c \\
                           d, &amp; e, &amp; f \end{array} \right]\end{split}\]</div>
<p>Enter:</p>
<blockquote>
<div><p>A = np.array([[a, b, c], [d, e, f]])</p>
</div></blockquote>
<p><strong>To add two matrices,</strong></p>
<div class="math notranslate nohighlight">
\[C = A + B\]</div>
<p>Enter:</p>
<blockquote>
<div><p>C = A + B</p>
</div></blockquote>
<p><strong>To multiply two matrices,</strong></p>
<div class="math notranslate nohighlight">
\[C = A \cdot B\]</div>
<p>Enter:</p>
<blockquote>
<div><p>C = np.dot(A, B)</p>
</div></blockquote>
<p><strong>To find the tranpose of a matrix,</strong></p>
<div class="math notranslate nohighlight">
\[C = A^{T}\]</div>
<p>Enter:</p>
<blockquote>
<div><p>C = A.tranpose()</p>
</div></blockquote>
<p><strong>To find the condition number of a matrix,</strong></p>
<blockquote>
<div><p>K = np.linalg.cond(A)</p>
</div></blockquote>
<p><strong>To find the inverse of a matrix,</strong></p>
<div class="math notranslate nohighlight">
\[C = A^{-1}\]</div>
<p>Enter:</p>
<blockquote>
<div><p>C = np.linalg.inv(A)</p>
</div></blockquote>
<p><strong>To find the determinant of a matrix,</strong></p>
<div class="math notranslate nohighlight">
\[K = |A|\]</div>
<p>Enter:</p>
<blockquote>
<div><p>K = np.linalg.det(A)</p>
</div></blockquote>
<p><strong>To find the eigenvalues of a matrix,</strong></p>
<p>Enter:</p>
<blockquote>
<div><p>lamb = np.linalg.eigvals(A)</p>
</div></blockquote>
<p><strong>To find the eigenvalues (lamb) and eigenvectors (x) of a matrix,</strong></p>
<p>Enter:</p>
<blockquote>
<div><p>lamb, x = np.linalg.eig(A)</p>
</div></blockquote>
<p>lamb[i] are the eigenvalues and x[:, i] are the eigenvectors.</p>
<p><strong>To print a matrix,</strong></p>
<div class="math notranslate nohighlight">
\[C\]</div>
<p>Enter:</p>
<blockquote>
<div><p>print (C)</p>
</div></blockquote>
</div>
<div class="section" id="Glossary">
<h2>Glossary<a class="headerlink" href="#Glossary" title="Permalink to this headline">¬∂</a></h2>
<p><strong>A</strong></p>
<p>augmented matrix</p>
<blockquote>
<div><p>The <span class="math notranslate nohighlight">\(m \times (n+1)\)</span> matrix representing a linear system, <span class="math notranslate nohighlight">\(Ax = b\)</span>, with the right hand side vector appended to the coefficient matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[
\begin{array}{cc}
\begin{array}{ccccc}
a_{11} &amp; &amp; \ldots &amp; &amp; a_{1n} \\
\vdots &amp; &amp; \ddots &amp; &amp; \vdots \\
a_{m1} &amp; &amp; \ldots &amp; &amp; a_{mn}
\end{array}
&amp;
\left|
\begin{array}{rc}
&amp; b_{1} \\ &amp; \vdots \\ &amp; b_{m}
\end{array}
\right.
\end{array}
\right]\end{split}\]</div>
</div></blockquote>
<blockquote>
<div><p>The right most column is the right hand side vector or augmented column.</p>
</div></blockquote>
<p><strong>C</strong></p>
<p>characteristic equation</p>
<blockquote>
<div><p>The equation:</p>
<div class="math notranslate nohighlight">
\[\det(A - \lambda I) = 0 , \ \ \ \  or \ \ \ \ Ax = \lambda x\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a <em>square matrix</em>, <span class="math notranslate nohighlight">\(I\)</span> is the <em>identity matrix</em>, <span class="math notranslate nohighlight">\(\lambda\)</span> is an <em>eigenvalue</em> of <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(x\)</span> is the corresponding <em>eigenvector</em> of <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div></blockquote>
<p>coefficient matrix</p>
<blockquote>
<div><p>A <span class="math notranslate nohighlight">\(m \times n\)</span> matrix made up with the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> of the <span class="math notranslate nohighlight">\(n\)</span> unknowns from the <span class="math notranslate nohighlight">\(m\)</span> equations of a set of linear equations, where <span class="math notranslate nohighlight">\(i\)</span> is the row index and <span class="math notranslate nohighlight">\(j\)</span> is the column index:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[
\begin{array}{ccccccc}
&amp; a_{11} &amp; &amp; \ldots &amp; &amp; a_{1n} &amp; \\
&amp; \vdots &amp; &amp; \ddots &amp; &amp; \vdots &amp; \\
&amp; a_{m1} &amp; &amp; \ldots &amp; &amp; a_{mn} &amp;
\end{array}
\right]\end{split}\]</div>
</div></blockquote>
<p>condition number</p>
<blockquote>
<div><p>A number, <span class="math notranslate nohighlight">\(K\)</span>, that refers to the sensitivity of a <em>nonsingular</em> matrix, <span class="math notranslate nohighlight">\(A\)</span>, i.e.¬†given a system <span class="math notranslate nohighlight">\(Ax = b\)</span>, <span class="math notranslate nohighlight">\(K\)</span> reflects whether small changes in <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(b\)</span> will have any effect on the solution. The matrix is well-conditioned if <span class="math notranslate nohighlight">\(K\)</span> is close to one. The number is described as:</p>
<div class="math notranslate nohighlight">
\[K(A) = \|A\| \|A^{-1}\|
\ \ \ \  or \ \ \ \
K(A) = \frac{\lambda_{max}}{\lambda_{min}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_{max}\)</span> and <span class="math notranslate nohighlight">\(\lambda_{min}\)</span> are largest and smallest <em>eigenvalues</em> of <span class="math notranslate nohighlight">\(A\)</span> respectively.</p>
</div></blockquote>
<p><strong>D</strong></p>
<p>decomposition</p>
<blockquote>
<div><p>Factoring a matrix, <span class="math notranslate nohighlight">\(A\)</span>, into two factors, e.g., the Gaussian elimination amounts to factoring <span class="math notranslate nohighlight">\(A\)</span> into a product of two matrices. One is the lower triangular matrix, <span class="math notranslate nohighlight">\(L\)</span>, and the other is the upper triangular matrix, <span class="math notranslate nohighlight">\(U\)</span>.</p>
</div></blockquote>
<p>diagonal matrix</p>
<blockquote>
<div><p>A square matrix with the entries $a_{ij} = 0 $ whenever <span class="math notranslate nohighlight">\(i \neq j\)</span>.</p>
</div></blockquote>
<p><strong>E</strong></p>
<p>eigenvalue</p>
<blockquote>
<div><p>A number, <span class="math notranslate nohighlight">\(\lambda\)</span>, that must satisfy the <em>characteristic equation</em> <span class="math notranslate nohighlight">\(\det(A - \lambda I) = 0.\)</span></p>
</div></blockquote>
<p>eigenvector</p>
<blockquote>
<div><p>A vector, <span class="math notranslate nohighlight">\(x\)</span>, which corresponds to an <em>eigenvalue</em> of a <em>square matrix</em> <span class="math notranslate nohighlight">\(A\)</span>, satisfying the characteristic equation:</p>
<div class="math notranslate nohighlight">
\[Ax = \lambda x .\]</div>
</div></blockquote>
<p><strong>H</strong></p>
<p>homogeneous equations</p>
<blockquote>
<div><p>A set of linear equations, <span class="math notranslate nohighlight">\(Ax = b\)</span> with the zero vector on the right hand side, i.e.¬†<span class="math notranslate nohighlight">\(b = 0\)</span>.</p>
</div></blockquote>
<p><strong>I</strong></p>
<p>inhomogeneous equations</p>
<blockquote>
<div><p>A set of linear equations, <span class="math notranslate nohighlight">\(Ax = b\)</span> such that <span class="math notranslate nohighlight">\(b \neq 0\)</span>.</p>
</div></blockquote>
<p>identity matrix</p>
<blockquote>
<div><p>A <em>diagonal matrix</em> with the entries <span class="math notranslate nohighlight">\(a_{ii} = 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \begin{array}{ccccccc}
&amp; 1 &amp; 0 &amp; \ldots &amp; \ldots &amp; 0 &amp;  \\
&amp; 0 &amp; 1 &amp; \ddots &amp; &amp; \vdots &amp; \\
&amp; \vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
&amp; \vdots &amp; &amp; \ddots &amp; 1 &amp; 0 &amp; \\
&amp; 0 &amp; \ldots &amp; \ldots &amp; 0 &amp; 1 &amp;
\end{array} \right]\end{split}\]</div>
</div></blockquote>
<p>ill-conditioned matrix</p>
<blockquote>
<div><p>A matrix with a large <em>condition number</em>, i.e., the matrix is not well-behaved, and small errors to the matrix will have great effects to the solution.</p>
</div></blockquote>
<p>invertible matrix</p>
<blockquote>
<div><p>A square matrix, <span class="math notranslate nohighlight">\(A\)</span>, such that there exists another matrix, <span class="math notranslate nohighlight">\(A^{-1}\)</span>, which satisfies:</p>
<div class="math notranslate nohighlight">
\[AA^{-1} = I \ \ \ \ and \ \ \ \  A^{-1}A = I\]</div>
</div></blockquote>
<blockquote>
<div><p>The matrix, <span class="math notranslate nohighlight">\(A^{-1}\)</span>, is the <em>inverse</em> of <span class="math notranslate nohighlight">\(A\)</span>. An invertible matrix is <em>nonsingular</em>.</p>
</div></blockquote>
<p><strong>L</strong></p>
<p>linear system</p>
<blockquote>
<div><p>A set of <span class="math notranslate nohighlight">\(m\)</span> equations in <span class="math notranslate nohighlight">\(n\)</span> unknowns:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccccc}
a_{11}x_{1} &amp; + &amp; \ldots &amp; + &amp; a_{1n}x_{n} &amp; = &amp; b_{1} \\
a_{21}x_{1} &amp; + &amp; \ldots &amp; + &amp; a_{2n}x_{n} &amp; = &amp; b_{2} \\
&amp;   &amp; \vdots &amp;   &amp;             &amp;   &amp; \vdots \\
a_{m1}x_{1} &amp; + &amp; \ldots &amp; + &amp; a_{mn}x_{n} &amp; = &amp; b_{m}
\end{array}\end{split}\]</div>
<p>with unknowns <span class="math notranslate nohighlight">\(x_{i}\)</span> and coefficients <span class="math notranslate nohighlight">\(a_{ij}, b_{j}\)</span>.</p>
</div></blockquote>
<p>lower triangular matrix</p>
<blockquote>
<div><p>A square matrix, <span class="math notranslate nohighlight">\(L\)</span>, with the entries <span class="math notranslate nohighlight">\(l_{ij} = 0\)</span>, whenever <span class="math notranslate nohighlight">\(j &gt; i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[
\begin{array}{ccccccc}
&amp; * &amp; 0 &amp; \ldots &amp; \ldots &amp; 0 &amp; \\
&amp; * &amp; * &amp; \ddots &amp; &amp; \vdots &amp; \\
&amp; \vdots &amp;  &amp; \ddots &amp; \ddots &amp; \vdots &amp; \\
&amp; \vdots &amp;  &amp; &amp; * &amp; 0 &amp; \\
&amp; * &amp; \ldots &amp; \ldots &amp; \ldots &amp; * &amp;
\end{array}
\right]\end{split}\]</div>
</div></blockquote>
<p><strong>N</strong></p>
<p>nonsingular matrix</p>
<blockquote>
<div><p>A square matrix,<span class="math notranslate nohighlight">\(A\)</span>, that is invertible, i.e.¬†the system <span class="math notranslate nohighlight">\(Ax = b\)</span> has a <em>unique solution</em>.</p>
</div></blockquote>
<p><strong>S</strong></p>
<p>singular matrix</p>
<blockquote>
<div><p>A <span class="math notranslate nohighlight">\(n \times n\)</span> matrix that is degenerate and does not have an inverse (refer to <em>invertible</em>), i.e., the system <span class="math notranslate nohighlight">\(Ax = b\)</span> does not have a <em>unique solution</em>.</p>
</div></blockquote>
<p>sparse matrix</p>
<blockquote>
<div><p>A matrix with a high percentage of zero entries.</p>
</div></blockquote>
<p>square matrix</p>
<blockquote>
<div><p>A matrix with the same number of rows and columns.</p>
</div></blockquote>
<p><strong>T</strong></p>
<p>transpose</p>
<blockquote>
<div><p>A <span class="math notranslate nohighlight">\(n \times m\)</span> matrix, <span class="math notranslate nohighlight">\(A^{T}\)</span>, that has the columns of a <span class="math notranslate nohighlight">\(m \times n\)</span> matrix, <span class="math notranslate nohighlight">\(A\)</span>, as its rows, and the rows of <span class="math notranslate nohighlight">\(A\)</span> as its columns, i.e.¬†the entry <span class="math notranslate nohighlight">\(a_{ij}\)</span> in <span class="math notranslate nohighlight">\(A\)</span> becomes <span class="math notranslate nohighlight">\(a_{ji}\)</span> in <span class="math notranslate nohighlight">\(A^{T}\)</span>, e.g.</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}A =
\left[ \begin{array}{ccc} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \end{array} \right]
\ \  \rightarrow \ \
A^{T} =
\left[ \begin{array}{cc} 1 &amp; 4 \\ 2 &amp; 5 \\ 3 &amp; 6 \end{array} \right]\end{split}\]</div>
</div></blockquote>
<p>tridiagonal matrix</p>
<blockquote>
<div><p>A square matrix with the entries <span class="math notranslate nohighlight">\(a_{ij} = 0\)</span>, $| i-j | &gt; 1 $:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\left[
\begin{array}{cccccccc}
&amp; * &amp; * &amp; 0 &amp; \ldots &amp; \ldots &amp; 0 &amp; \\
&amp; * &amp; * &amp; * &amp; \ddots &amp; &amp; \vdots &amp; \\
&amp; 0 &amp; * &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots &amp; \\
&amp; \vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; * &amp; 0 &amp; \\
&amp; \vdots &amp; &amp; \ddots &amp; * &amp; * &amp; * &amp; \\
&amp; 0 &amp; \ldots &amp; \ldots &amp; 0 &amp; * &amp; * &amp;
\end{array}
\right]\end{split}\]</div>
</div></blockquote>
<p><strong>U</strong></p>
<p>unique solution</p>
<blockquote>
<div><p>There is only solution, <span class="math notranslate nohighlight">\(x\)</span>, that satisfies a particular linear system, <span class="math notranslate nohighlight">\(Ax = b\)</span>, for the given <span class="math notranslate nohighlight">\(A\)</span>. That is, this linear system has exactly one solution. The matrix <span class="math notranslate nohighlight">\(A\)</span> of the system is <em>invertible</em> or <em>nonsingular</em>.</p>
</div></blockquote>
<p>upper triangular matrix</p>
<blockquote>
<div><p>A square matrix, <span class="math notranslate nohighlight">\(U\)</span>, with the entries <span class="math notranslate nohighlight">\(u_{ij} = 0\)</span> whenever <span class="math notranslate nohighlight">\(i &gt; j\)</span>:</p>
</div></blockquote>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\left[
\begin{array}{ccccccc}
&amp; * &amp; \ldots &amp; \ldots &amp; \ldots &amp; * &amp; \\
&amp; 0 &amp; * &amp;  &amp;  &amp; \vdots &amp; \\
&amp; \vdots &amp; \ddots &amp; \ddots &amp;  &amp; \vdots &amp; \\
&amp; \vdots &amp;  &amp; \ddots &amp; * &amp; * &amp; \\
&amp; 0 &amp; \ldots &amp; \ldots &amp; 0 &amp; * &amp;
\end{array}
\right]\end{split}\]</div>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../lab4/01-lab4.html" class="btn btn-neutral float-right" title="Solving Ordinary Differential Equations with the Runge-Kutta Methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../lab2/01-lab2.html" class="btn btn-neutral float-left" title="Stability and accuracy (Jan. 2020)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Numeric project

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>