

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Laboratory 10: Numerical Advection Schemes &mdash; Numeric course 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Numeric course
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../course_bootstrap.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gradsyllabus20.html">Grad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule20.html">Detailed Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html#learning-bash-and-git">Learning bash and git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html#pulling-changes-from-the-github-repository">Pulling changes from the github repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html#windows-combining-bash-utilities-with-the-windows-cmd-shell">Windows:  Combining bash utilities with the Windows cmd shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html#working-with-python-modules">Working with python modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html#demonstration-code">Demonstration code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python.html#books-and-tutorials">Books and tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../texts.html">Optional texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebook_toc.html">Course/lab descriptions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Numeric course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Laboratory 10: Numerical Advection Schemes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/doc_notebooks/lab10/Lab_10.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Laboratory-10:-Numerical-Advection-Schemes">
<h1>Laboratory 10: Numerical Advection Schemes<a class="headerlink" href="#Laboratory-10:-Numerical-Advection-Schemes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Carmen-Guo">
<h2>Carmen Guo<a class="headerlink" href="#Carmen-Guo" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Contents">
<h2>Contents<a class="headerlink" href="#Contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#List-of-Problems">List of Problems</a></p></li>
<li><p><a class="reference external" href="#1.-Advection-Process">1. Advection Process</a></p></li>
<li><p><a class="reference external" href="#2.-Simple-Solution-Using-Centred-Differencing-Scheme">2. Simple Solution Using Centred Differencing Scheme</a></p></li>
<li><p><a class="reference external" href="#3.-Numerical-Solution-Using-Upstream-Method">3. Numerical Solution Using Upstream Method</a></p></li>
<li><p><a class="reference external" href="#4.-A-Better-Solution">4. A Better Solution</a></p></li>
<li><p><a class="reference external" href="#5.-Conclusion">5. Conclusion</a></p></li>
<li><p><a class="reference external" href="#References">References</a></p></li>
</ul>
</div>
<div class="section" id="List-of-Problems">
<h2>List of Problems<a class="headerlink" href="#List-of-Problems" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Problem-One">Problem One</a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.-Advection-Process">
<h2>1. Advection Process<a class="headerlink" href="#1.-Advection-Process" title="Permalink to this headline">¶</a></h2>
<p>The word advection means ‘transfer of heat through the horizontal motion of a flow’. More generally, we will consider a flow of some non-diffusive quantity. For example, consider the wind as a flow and the water vapour in the air as the non-diffusive quantity. Suppose the wind is travelling in the positive x direction, and we are considering the vapour concentration from <span class="math notranslate nohighlight">\(x=1\)</span> to <span class="math notranslate nohighlight">\(x=80\)</span>.</p>
<p>Assume that initially the distribution curve of the vapour is Gaussian (<a class="reference external" href="#fig:initial">Figure Initial Distribution</a>). Ideally, the water droplets move at the same speed as that of the air, so the distribution curve retains its initial shape as it travels along the x-axis. This process is described by the following PDE:</p>
<p>(Advection Eqn)</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t} + u \frac{\partial c}{\partial x} = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the concentration of the water vapour, and <span class="math notranslate nohighlight">\(u\)</span> is the speed of the wind (assuming the wind is blowing at constant speed).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/initial.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab10_Lab_10_5_0.png"><img alt="../../_images/doc_notebooks_lab10_Lab_10_5_0.png" src="../../_images/doc_notebooks_lab10_Lab_10_5_0.png" style="width: 60%;" /></a>
</div>
</div>
<p><strong>Figure Initial Distribution:</strong> This is the initial distribution of water vapour concentration.</p>
<p>As you will see in the upcoming examples, it is not easy to obtain a satisfactory numerical solution to this PDE.</p>
</div>
<div class="section" id="2.-Simple-Solution-Using-Centred-Differencing-Scheme">
<h2>2. Simple Solution Using Centred Differencing Scheme<a class="headerlink" href="#2.-Simple-Solution-Using-Centred-Differencing-Scheme" title="Permalink to this headline">¶</a></h2>
<p>Let’s start off simple and solve the PDE (<a class="reference external" href="#eqn:advection">Advection Eqn</a>) using centred differences, <em>i.e.</em>, by expanding the time and spatial derivatives in the following way:</p>
<p>(Centered Difference Scheme)</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}(x=m dx, t=n dt) =\frac {c(x=m dx, t=(n+1) dt) - c(x=m dx, t=(n-1) dt)}{2 dt}\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial x}(x=m dx, t=n dt)=\frac {c(x=(m+1) dx, t=n dt) - c(x=(m-1) dx, t=n dt)}{2 dx}\]</div>
<p>where <span class="math notranslate nohighlight">\(m=2, \ldots, 79\)</span>, and <span class="math notranslate nohighlight">\(n=2, \ldots\)</span>. Substitution of the equations into the PDE yields the following recurrence relation:</p>
<div class="math notranslate nohighlight">
\[c(m, n+1)= c(m, n-1) - u \frac{dt}{dx} (c(m+1, n) - c(m-1, n))\]</div>
<p>The boundary conditions are :</p>
<div class="math notranslate nohighlight">
\[c(x=1 dx)= c(x=79 dx)\]</div>
<div class="math notranslate nohighlight">
\[c(x=80 dx)= c(x=2 dx)\]</div>
<p>The initial conditions are :</p>
<div class="math notranslate nohighlight">
\[c(x=n dx) = \exp( - \alpha (n dx - \hbox{offset})^2)\]</div>
<p>where <span class="math notranslate nohighlight">\(\hbox{offset}\)</span> is the location of the peak of the distribution curve. We don’t want the peak to be located near <span class="math notranslate nohighlight">\(x=0\)</span> due to the boundary conditions.</p>
<p>Now we need the values of <span class="math notranslate nohighlight">\(c\)</span> at <span class="math notranslate nohighlight">\(t= 1 dt\)</span> to calculate <span class="math notranslate nohighlight">\(c\)</span> at <span class="math notranslate nohighlight">\(t= 2 dt\)</span>, and we will use the Forward Euler scheme to approximate <span class="math notranslate nohighlight">\(c\)</span> at <span class="math notranslate nohighlight">\(t= 1 dt\)</span>. So</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}(m, 0)= \frac {c(m, 1) - c(m, 0)}{dt}\]</div>
<p>Substitution of the equations into the PDE yields</p>
<div class="math notranslate nohighlight">
\[c(m, 1) = c(m, 0) - u \frac{dt}{2 dx}(c(m+1, 0) - c(m-1, 0))\]</div>
<p>where <span class="math notranslate nohighlight">\(m=2, \ldots, 79\)</span>. The end points at <span class="math notranslate nohighlight">\(t= 1 dt\)</span> can be found using the boundary conditions.</p>
<p>The function that computes the numerical solution using this scheme is in <em>advection_funs.py</em>. It is a python function <em>advection(timesteps)</em>, which takes in the number of time steps as input and plots the distribution curve at 20 time steps.</p>
<p>We can see the problem with this scheme just by running the function with 10 time steps (<a class="reference external" href="#fig:centered">Figure Distribution with Centered Scheme</a>). Following is a plot of the distribution curve at the last time step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/centered.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab10_Lab_10_9_0.png"><img alt="../../_images/doc_notebooks_lab10_Lab_10_9_0.png" src="../../_images/doc_notebooks_lab10_Lab_10_9_0.png" style="width: 60%;" /></a>
</div>
</div>
<p><strong>Figure Distribution with Centered Scheme:</strong> This is the distribution after 10 time steps approximated using the centred differencing scheme.</p>
<p>Comparing this curve with the initial state (<a class="reference external" href="#fig:initial">Figure Initial Distribution</a>), we can see that ripples are produced to the left of the curve which means negative values are generated. But water vapour does not have negative concentrations. The centred differencing scheme does not work well for the advection process because it is not <strong>positive definite</strong>, <em>i.e.</em>, it generates negative values which are impossible in real life.</p>
</div>
<div class="section" id="3.-Numerical-Solution-Using-Upstream-Method">
<h2>3. Numerical Solution Using Upstream Method<a class="headerlink" href="#3.-Numerical-Solution-Using-Upstream-Method" title="Permalink to this headline">¶</a></h2>
<p>Let’s see what is wrong with our simple centred differencing scheme. We used centred differences to compute the time and spatial derivatives (<a class="reference external" href="#eqn:centered">Centered Difference Scheme</a>). In other words, <span class="math notranslate nohighlight">\(c(x=m dx)\)</span> depends on <span class="math notranslate nohighlight">\(c(x=(m-1) dx)\)</span> and <span class="math notranslate nohighlight">\(c(x=(m+1) dx)\)</span>, and <span class="math notranslate nohighlight">\(c(t=n dt)\)</span> depends on <span class="math notranslate nohighlight">\(c(t=(n-1) dt)\)</span> and <span class="math notranslate nohighlight">\(c(t=(n+1) dt)\)</span>. But we know the wind is moving in the positive x direction, so <span class="math notranslate nohighlight">\(c(x=m dx)\)</span> should not depend on <span class="math notranslate nohighlight">\(c(x=(m+1) dx)\)</span>.
Therefore, we will change the centred differencing scheme to backward differencing scheme. In other words, we will always be looking ‘upstream’ in the approximation.</p>
<p>If we use backward differences to approximate the spatial derivative but continue to use centred differences to approximate the time derivative, we will end up with an unstable scheme. Thus, we will use backward differences for both time and spatial derivatives. Now the time and spatial derivatives are given by:</p>
<p>(Upstream Scheme)</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t}(x=m dx, t=n dt)=\frac {c(x=m dx, t=n dt) - c(x=m dx, t=(n-1) dt)}{dt}\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial x}(x=m dx, t=n dt)=\frac {c(x=m dx, t=n dt) - c(x=(m-1) dx, t=n dt)}{dx}\]</div>
<p>Substitution of the equations into the PDE yields</p>
<div class="math notranslate nohighlight">
\[c(m, n+1)=c(m, n)- u \frac{dt}{dx} (c(m, n) - c(m-1, n))\]</div>
<p>The boundary conditions and the initial conditions are the same as in the centred differencing scheme. This time we compute <span class="math notranslate nohighlight">\(c\)</span> at <span class="math notranslate nohighlight">\(t= 1 dt\)</span> using backward differences just as with all subsequent time steps.</p>
<p>The function that computes the solution using this scheme is in <em>advection_funs.py</em>. It is a python function <em>advection2(timesteps)</em>, which takes in the number of time steps as input and plots the distribution curve at 20 time steps.</p>
<p>Although this scheme is positive definite and conservative (the area under the curve is the same as in the initial state), it introduces a new problem — diffusion. As the time step increases, you can see that the curve becomes wider and lower, <em>i.e.</em>, it diffuses quickly (<a class="reference external" href="#fig:upstream">Figure Upstream Distribution</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/upstream.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab10_Lab_10_12_0.png"><img alt="../../_images/doc_notebooks_lab10_Lab_10_12_0.png" src="../../_images/doc_notebooks_lab10_Lab_10_12_0.png" style="width: 60%;" /></a>
</div>
</div>
<p><strong>Figure Upstream Distribution:</strong> This is the distribution after 60 time steps approximated using the upstream method.</p>
<p>But ideally, the curve should retain its original shape as the wave travels along the x-axis, so the upstream method is still not good enough for the advection problem. In the next section, we will present another method that does a better job.</p>
</div>
<div class="section" id="4.-A-Better-Solution">
<h2>4. A Better Solution<a class="headerlink" href="#4.-A-Better-Solution" title="Permalink to this headline">¶</a></h2>
<p>In previous sections, we were concerned with values at grid points only, ie, values of <span class="math notranslate nohighlight">\(c\)</span> at <span class="math notranslate nohighlight">\(x= 1dx, 2dx, \ldots\)</span>. But in this section, we will also consider grid boxes each containing a grid point in the centre. For each grid point <span class="math notranslate nohighlight">\(j\)</span>, the left boundary of the grid box containing <span class="math notranslate nohighlight">\(j\)</span> is indexed as <span class="math notranslate nohighlight">\(j- 1/2\)</span>, and the right boundary as <span class="math notranslate nohighlight">\(j+ 1/2\)</span>. The scheme presented here was developed by Andreas Bott (<a class="reference external" href="#Ref:Bott">Bott, 1989</a>).</p>
<p>The PDE (<a class="reference external" href="#eqn:advection">Advection Eqn</a>) is rewritten as :</p>
<p>(Flux Form Eqn)</p>
<div class="math notranslate nohighlight">
\[\frac{\partial c}{\partial t} + \frac{\partial uc}{\partial x} = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(F= uc\)</span> gives the flux of water vapour.</p>
<p>Expand the time derivative using forward differences and the spatial derivative as follows:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial F}{\partial x}(x=j dx)  = \frac {F(x= (j+1/2) dx) - F(x= (j-1/2) dx)}{dx}\]</div>
<p>where <span class="math notranslate nohighlight">\(F(x= j+1/2)\)</span> gives the flux through the right boundary of the grid box <span class="math notranslate nohighlight">\(j\)</span>. For simplicity, we use the notation <span class="math notranslate nohighlight">\(F(x= j+1/2)\)</span> for <span class="math notranslate nohighlight">\(F(x= j+1/2, n)\)</span>, ie, the flux through the right boundary of the grid box j after <span class="math notranslate nohighlight">\(n\)</span> time steps.</p>
<p>Substituting the expanded derivatives into the PDE, we obtain the following recurrence formula (<span class="math notranslate nohighlight">\(c(m, n)= c(x= m dx, t= n dt)\)</span>):</p>
<div class="math notranslate nohighlight">
\[c(m, n+1)= c(m, n) - \frac {dt} {dx}(F(m+1/2, n)-F(m-1/2, n))\]</div>
<p>Since flux is defined as the amount flowing through per unit time, we need to calculate the portion of the distribution curve in each grid box that passes the right boundary after <span class="math notranslate nohighlight">\(dt\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/flux.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab10_Lab_10_15_0.png"><img alt="../../_images/doc_notebooks_lab10_Lab_10_15_0.png" src="../../_images/doc_notebooks_lab10_Lab_10_15_0.png" style="width: 60%;" /></a>
</div>
</div>
<p><strong>Figure Amount Leaving Grid:</strong> After <span class="math notranslate nohighlight">\(dt\)</span>, the shaded area will be past the right boundary of the grid box <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>As (<a class="reference external" href="#fig:flux">Figure Amount Leaving Grid</a>) shows, the distribution curve in grid box <span class="math notranslate nohighlight">\(j\)</span> has travelled a distance of <span class="math notranslate nohighlight">\({u dt}\)</span> after each time step; in other words, the curve has moved <span class="math notranslate nohighlight">\(u dt/dx\)</span> of a grid space within a time unit. The shaded region is the portion of the vapour that passes the right boundary of grid box <span class="math notranslate nohighlight">\(j\)</span> within <span class="math notranslate nohighlight">\(dt\)</span>. We can use integration to find out the area of the shaded region and then divide the result by <span class="math notranslate nohighlight">\(dt\)</span> to get
<span class="math notranslate nohighlight">\(F(j+1/2)\)</span>.</p>
<p>Since we only know <span class="math notranslate nohighlight">\(c\)</span> at the grid point <span class="math notranslate nohighlight">\(j\)</span>, we are going to use polynomial interpolation techniques to approximate <span class="math notranslate nohighlight">\(c\)</span> at other points in the grid box. We define <span class="math notranslate nohighlight">\(c\)</span> in grid box <span class="math notranslate nohighlight">\(j\)</span> with a polynomial of order <span class="math notranslate nohighlight">\(l\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[c _{j, \ell}(x^\prime) = \sum _{k=0} ^{\ell} a _{j, k} x ^{\prime k}\]</div>
<p>where <span class="math notranslate nohighlight">\(x^\prime = (x- x_j)/dx\)</span> and <span class="math notranslate nohighlight">\(-1/2 \le x^\prime \le \ell/2\)</span>.</p>
<p>The coefficients <span class="math notranslate nohighlight">\(a _{j, k}\)</span> are obtained by interpolating the curve with the aid of neighbouring grid points. We will skip the detail of the interpolation process. Values of <span class="math notranslate nohighlight">\(a _{j, k}\)</span> for <span class="math notranslate nohighlight">\(\ell=0, 1, \ldots, 4\)</span> have been computed and are summarised in Tables <cite>:math:</cite>ell=0` &lt;#tab:ell0&gt;`__, <cite>:math:</cite>ell=1` &lt;#tab:ell1&gt;`__, <cite>:math:</cite>ell=2` &lt;#tab:ell2&gt;`__, <cite>:math:</cite>ell=3` &lt;#tab:ell3&gt;`__ and <cite>:math:</cite>ell=4` &lt;#tab:ell4&gt;`__,</p>
<p><strong>Table :math:`ell = 0`:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 63%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>…………….</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}=c_j\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Table :math:`ell = 1`:</strong> two representations</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>……………………….</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}= c_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 1}= c_{j+1} - c_j\)</span></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>……………………….</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}= c_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 1}= c_j-c_{j-1}\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Table :math:`ell = 2`:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>………………………………………….</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}= c_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 1}=\frac {1}{2}(c_{j+1}-c_{j-1})\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 2}=\frac {1}{2}(c_{j+1}-2c_j+c_{j-1})\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Table :math:`ell = 3`:</strong> two representations</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>…………………………………………………………..</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}= c_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 1}=\frac {1}{6}(-c_{j+2}+6c_{j+1}-3c_j-2c_{j-1})\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 2}=\frac {1}{2}(c_{j+1}-2c_j+c_{j-1})\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 3}=\frac {1}{6}(c_{j+2}-3c_{j+1}+3c_j-c_{j-1})\)</span></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>…………………………………………………………..</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}= c_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 1}=\frac {1}{6}(2c_{j+1}+3c_j-6{j-1}+c_{j-2})\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 2}=\frac {1}{2}(c_{j+1}-2c_j+c_{j-1})\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 3}=\frac {1}{6}(c_{j+1}-3c_j+3c_{j-1}-c_{j-2})\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Table :math:`ell = 4`:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>………….</p></th>
<th class="head"><p>…………………………………………………………………………….</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j,0}= c_j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 1}=\frac {1}{12}(-c_{j+2}+8c_{j+1}-8c_{j-1}+c_{j-2})\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 2}=\frac {1}{24}(-c_{j+2}+16c_{j+1}-30c_j+16c_{j-1}-c_{j-2})\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k=3\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 3}=\frac {1}{12}(c_{j+2}-2c_{j+1}+2c_{j-1}-c_{j-2})\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k=4\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a_{j, 4}=\frac {1}{24}(c_{j+2}-4c_{j+1}+6c_j-4c_{j-1}+c_{j-2})\)</span></p></td>
</tr>
</tbody>
</table>
<p>Note that for even order polynomials, an odd number of <span class="math notranslate nohighlight">\(c\)</span> values including the grid point <span class="math notranslate nohighlight">\(j\)</span> are needed to calculate the coefficients <span class="math notranslate nohighlight">\(a_{j, k}\)</span>. This means the same number of grid points to the left and right of <span class="math notranslate nohighlight">\(x_j\)</span> are used in the calculation of <span class="math notranslate nohighlight">\(a_{j, k}\)</span>. If on the other hand, we choose odd order polynomials, there will be one extra point used to either side of <span class="math notranslate nohighlight">\(x_j\)</span>, thus resulting in 2 different representations of <span class="math notranslate nohighlight">\(a_{j, k}\)</span>. This is why there
are 2 sets of <span class="math notranslate nohighlight">\(a_{j, k}\)</span> for <span class="math notranslate nohighlight">\(\ell=1, 3\)</span> in the table. Decision as to which set is to be used must be made according to specific conditions of the calculation.</p>
<p>If we choose <span class="math notranslate nohighlight">\(\ell=0\)</span>, we will end up with the upstream method. In other words, the upstream method assumes that <span class="math notranslate nohighlight">\(c\)</span> is constant in each grid box. This poor representation of <span class="math notranslate nohighlight">\(c\)</span> results in strong numerical diffusion. Experiments have shown that generally if we use higher order polynomials (where <span class="math notranslate nohighlight">\(\ell \le 4\)</span>), we can significantly suppress numerical diffusion.</p>
<p>Now we define <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> as the shaded area in grid box <span class="math notranslate nohighlight">\(j\)</span> in (<a class="reference external" href="#fig:flux">Figure Amount Leaving Grid</a>):</p>
<p>(Flux Leaving Eqn)</p>
<div class="math notranslate nohighlight">
\[I_{j+1/2} = \int _{1/2 - \frac{udt}{dx}}^{1/2} c_j(x^\prime) dx^\prime\]</div>
<div class="math notranslate nohighlight">
\[=  \sum _{k=0}^{l} \frac {a_{j, k}}{(k+1) 2^{k+1}} \left[1- \left(1- 2 u \frac{dt}{dx}\right)^{k+1} \right]\]</div>
<p>Note that we are integrating over <span class="math notranslate nohighlight">\(x^\prime\)</span> instead of <span class="math notranslate nohighlight">\(x\)</span>. Thus, to get the real shaded area, we need to multiply <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> by <span class="math notranslate nohighlight">\(dx\)</span>. So</p>
<p>(Flux Eqn)</p>
<div class="math notranslate nohighlight">
\[F_{j+1/2}= \frac {dx} {dt}I_{j+1/2}\]</div>
<p>In this form, the scheme is conservative and weakly diffusive. But it still lacks positive definiteness. A sufficient condition for this is</p>
<p>(Positive Definite Condition)</p>
<div class="math notranslate nohighlight">
\[0 \le  I_{j+1/2} dx  \le  c_j dx\]</div>
<p>That is, the total outflow is never negative and never greater than <span class="math notranslate nohighlight">\(c_j dx\)</span>. In other words, the shaded area should be no less than zero but no greater than the area of the rectangle with length <span class="math notranslate nohighlight">\(c_j\)</span> and width <span class="math notranslate nohighlight">\(dx\)</span>. (<a class="reference external" href="#fig:limit">Figure Total in Cell</a>) shows why the total outflow should be limited above by <span class="math notranslate nohighlight">\(c_j dx\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;images/limit.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab10_Lab_10_22_0.png"><img alt="../../_images/doc_notebooks_lab10_Lab_10_22_0.png" src="../../_images/doc_notebooks_lab10_Lab_10_22_0.png" style="width: 60%;" /></a>
</div>
</div>
<p><strong>Figure Total in Cell:</strong> The shaded area is equal to <span class="math notranslate nohighlight">\(c_j dx\)</span>, and it is already greater than the total amount of vapour (the area under the curve) in grid box <span class="math notranslate nohighlight">\(j\)</span>. If <span class="math notranslate nohighlight">\(I_{j+1/2} dx &gt; c_j dx\)</span>, then the total outflow <span class="math notranslate nohighlight">\(I_{j+1/2} dx\)</span> would be greater than the amount of vapour in the grid box, and the amount of vapour will be negative at the next time step, thus violating the positive definiteness requirement.</p>
<p>If the total outflow is larger than the shaded area <span class="math notranslate nohighlight">\(c_j dx\)</span>, we will get negative values of <span class="math notranslate nohighlight">\(c\)</span> in this grid box at the next time step. We do not want this to happen since negative values are meaningless.</p>
<p>To satisfy the condition for positive definiteness (<a class="reference external" href="#eq:posdef">Positive Definite Condition</a>) we need to guarantee that <span class="math notranslate nohighlight">\(I_{j+1/2} \le c_j\)</span> holds at all time steps. We can achieve this condition by multiplying <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> by a weighting factor. Define <span class="math notranslate nohighlight">\(I_{j+1/2}^\prime\)</span> as</p>
<p>(Normalization Eqn)</p>
<div class="math notranslate nohighlight">
\[I_{j+1/2}^\prime=I_{j+1/2} \frac {c_j}{I_j}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[{I_j} = \int_{-1/2}^{1/2} c_j(x^\prime) dx^\prime\]</div>
<div class="math notranslate nohighlight">
\[= \sum_{k=0}^{l} \frac {a_{j, k}} {(k+1) 2^{k+1}} [(-1)^k +1]\]</div>
<p>Since the total flow out of a grid box is always less than the total grid volume, <span class="math notranslate nohighlight">\(I_{j+1/2}/I_j\)</span> is always less than 1, thus <span class="math notranslate nohighlight">\(I_{j+1/2} c_j/I_j\)</span> is always less than <span class="math notranslate nohighlight">\(c_j\)</span>. Thus we can satisfy the upper limit of the positive definiteness condition (<a class="reference external" href="#eq:posdef">Positive Definite Condition</a>) by multiplying <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> by a weighting factor <span class="math notranslate nohighlight">\(c_j/I_j\)</span>. So now <span class="math notranslate nohighlight">\(F\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[F_{j+1/2}= \frac {dx} {dt}\frac {c_j}{I_j} I_{j+1/2}\]</div>
<p>Now to satisfy the lower limit of the positive definiteness condition, (<a class="reference external" href="#eq:posdef">Positive Definite Condition</a>) we need to make sure <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> remains non negative at all time steps. So we will set <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> to 0 whenever it is negative.</p>
<p>If we are looking at the parts of the curve that are far away from the peak, <span class="math notranslate nohighlight">\(I_j=0, I_{j+1/2}=0\)</span>, and we will be dividing by 0 in (<a class="reference external" href="#eq:normalize">Normalization Eqn</a>)! To avoid this instability, we introduce a small term <span class="math notranslate nohighlight">\(\epsilon\)</span> when <span class="math notranslate nohighlight">\(I_j=0, I_{j+1/2}=0\)</span>, <em>i.e.</em>, we set <span class="math notranslate nohighlight">\(I_j\)</span> to <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<p>Combining all the conditions from above, the advection scheme is described as follows:</p>
<div class="math notranslate nohighlight">
\[c(j, n+1)= c(j, n) - \frac {dt} {dx} [F(j+1/2, n)- F(j-1/2, n)]\]</div>
<div class="math notranslate nohighlight">
\[F(j+1/2, n)= \frac {dx}{dt} \frac {i_{l, j+1/2}}{i_{l, j}} c_j\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[i_{l, j+1/2} = \hbox{max}(0, I_{j+1/2})\]</div>
<div class="math notranslate nohighlight">
\[i_{l, j} = \hbox{max}(I_{l, j}, i_{l, j+1/2} + \epsilon)\]</div>
<p>where <span class="math notranslate nohighlight">\(l\)</span> is the order of the polynomial we use to interpolate <span class="math notranslate nohighlight">\(c\)</span> in each grid box.</p>
<p>An example function for this scheme is in <em>advection_funs.py</em>. The python function <em>advection3(timesteps, order)</em> takes in 2 arguments, the first is the number of time steps to be computed, the second is the order of the polynomial for the approximation of <span class="math notranslate nohighlight">\(c\)</span> within each grid box. It plots the curve at 20 time steps. Students should try it out and compare this scheme with the previous two.</p>
</div>
<div class="section" id="Problem-One">
<h2><em>Problem One</em><a class="headerlink" href="#Problem-One" title="Permalink to this headline">¶</a></h2>
<p>Using the scheme presented in this section, modify <em>advection3.py</em> to solve the following advection problem: The wind is moving along the x-axis with speed <span class="math notranslate nohighlight">\(u=20 \hbox{ m/s}\)</span>. The initial distribution curve is <span class="math notranslate nohighlight">\(290 \hbox{ km}\)</span> in width. Use your program to approximate the curve during 24 hours.</p>
<ol class="loweralpha simple">
<li><p>Run your program for different orders of approximating polynomials (up to 4). Compare the accuracy of approximation for different orders. Do you see better results with increasing order? Is this true for all orders from 0 to 4? Is there any particularity to odd and even order polynomials?</p></li>
</ol>
<p>b) For odd ordered polynomials, <em>advection3.py</em> uses the representation of <span class="math notranslate nohighlight">\(a_{j,k}\)</span> that involves an extra point to the right of the centre grid point. Modify the table of coefficients for odd ordered polynomials (<cite>Table :math:</cite>ell=1` &lt;#tab:ell1&gt;`__)and (<cite>Table :math:</cite>ell=3` &lt;#tab:ell3&gt;`__) to use the extra point to the left of the centre grid point. Run your program again and compare the results of 2 different representations of <span class="math notranslate nohighlight">\(a_{j,k}\)</span> for order 1 and 3, respectively. Is one
representation better than the other, or about the same, or does each have its own problem? How, do you think the different representation affects the result?</p>
</div>
<div class="section" id="5.-Conclusion">
<h2>5. Conclusion<a class="headerlink" href="#5.-Conclusion" title="Permalink to this headline">¶</a></h2>
<p>The last scheme presented solves 2 problems introduced in the previous two schemes. The centred differencing scheme lacks positive definiteness because it is of second order accuracy, thus it introduces additional oscillations near the peak. The scheme presented here solves this problem by checking and normalising the relevant values (ie, <span class="math notranslate nohighlight">\(I_{j+1/2}\)</span> and <span class="math notranslate nohighlight">\(I_j\)</span>) when needed at each time step. The upstream scheme produces strong diffusion because it is of only first order accuracy. The
scheme presented here solves this problem by using higher order polynomials to approximate <span class="math notranslate nohighlight">\(c\)</span> at each grid box.</p>
<p>Experiments have shown that this scheme is numerically stable in most atmospheric situations. This scheme is only slightly unstable in the case of strong deformational flow field models.</p>
<p>For more detail about this advection scheme , please refer to (<a class="reference external" href="#Ref:Bott">Bott, 1989</a>). Since 1989, new advection schemes including the MUSCL and TVD have been developed and are more routinely used.</p>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<p>Bott, A., 1989: A positive definite advection scheme obtained by nonlinear renormalization of the advective fluxes. <em>Monthly Weather Review</em>, 117, 1006–1015.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Numeric project

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>