

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Laboratory 1: An Introduction to the Numerical Solution of Differential Equations: Discretization (2020/Jan/6) &mdash; Numeric course 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Stability and accuracy (Jan. 2020)" href="../lab2/01-lab2.html" />
    <link rel="prev" title="Numeric notebooks" href="../../notebook_toc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Numeric course
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../course_bootstrap.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ugradsyllabus20.html">Undergrad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gradsyllabus20.html">Grad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule20.html">Detailed Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../texts.html">Optional texts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../notebook_toc.html">Course/lab descriptions</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lab 1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#List-of-Problems">List of Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Objectives">Objectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Assignment">Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Readings">Readings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Running-Code-Cells">Running Code Cells</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Introduction:-Why-bother-with-numerical-methods?">Introduction: Why bother with numerical methods?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Ordinary-Differential-Equations">Ordinary Differential Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Partial-Differential-Equations">Partial Differential Equations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Discretization">Discretization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Difference-Approximations-to-the-First-Derivative">Difference Approximations to the First Derivative</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Investigation">Investigation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Forward-Euler-Method">Forward Euler Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Other-Approximations">Other Approximations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Generalizations">Generalizations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Higher-Derivatives">Higher Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Systems-of-First-order-ODE’s">Systems of First-order ODE’s</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Boundary-Value-Problem">Boundary Value Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Partial-Differential-Equations">Partial Differential Equations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Mathematical-Notes">Mathematical Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Solution-to-the-Heat-Conduction-Equation">Solution to the Heat Conduction Equation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#References">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Glossary">Glossary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lab2/01-lab2.html">Lab 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab3/01-lab3.html">Lab 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab4/01-lab4.html">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab4/01-lab4.html#Solving-Ordinary-Differential-Equations-with-the-Runge-Kutta-Methods">Solving Ordinary Differential Equations with the Runge-Kutta Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html">Lab 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab6/lab6.html">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab6/lab6.html#List-of-Problems">List of Problems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week_notes.html">Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments.html">Weekly assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quizzes.html">Quizzes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Numeric course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../notebook_toc.html">Numeric notebooks</a> &raquo;</li>
        
      <li>Laboratory 1: An Introduction to the Numerical Solution of Differential Equations: Discretization (2020/Jan/6)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/doc_notebooks/lab1/01-lab1.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Laboratory-1:-An-Introduction-to-the-Numerical-Solution-of-Differential-Equations:-Discretization-(2020/Jan/6)">
<h1>Laboratory 1: An Introduction to the Numerical Solution of Differential Equations: Discretization (2020/Jan/6)<a class="headerlink" href="#Laboratory-1:-An-Introduction-to-the-Numerical-Solution-of-Differential-Equations:-Discretization-(2020/Jan/6)" title="Permalink to this headline">¶</a></h1>
<p>John M. Stockie</p>
<div class="section" id="List-of-Problems">
<h2>List of Problems<a class="headerlink" href="#List-of-Problems" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Problem-One">Problem One</a></p></li>
<li><p><a class="reference external" href="#Problem-Two">Problem Two</a></p></li>
</ul>
</div>
<div class="section" id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h2>
<p>The examples and exercises in this lab are meant to illustrate the limitations of analytical solution techniques, using several differential equation models for simple physical systems. This is the prime motivation for the use of numerical methods.</p>
<p>After completing this lab, you will understand the process of <em>discretizing</em> a continuous problem, and be able to derive a simple finite difference approximation for an ordinary or partial differential equation. The examples will also introduce the concepts of <em>accuracy</em> and <em>stability</em>, which will be discussed further in Lab 2.</p>
<p>Specifically you will be able to:</p>
<ul class="simple">
<li><p>Define the term or identify: Ordinary Differential Equation, Partial Differential Equation, Linear equation, Non-linear equation, Initial value problem, Boundary value problem, Open Domain, and Closed Domain.</p></li>
<li><p>Define the term, identify or perform: Forward difference discretization, Backward difference discretization, and Centre difference discretization.</p></li>
<li><p>Define the term: Interpolation, Convergence, and Instability.</p></li>
<li><p>Define the term or perform: Linear interpolation.</p></li>
</ul>
</div>
<div class="section" id="Assignment">
<h2>Assignment<a class="headerlink" href="#Assignment" title="Permalink to this headline">¶</a></h2>
<p>This lab has written assignment. Hand in the hard copy with your answers to Susan by xxx. Here is the link to the <a class="reference external" href="pdfs/assignment1.pdf">Assignment 1 pdf</a></p>
</div>
<div class="section" id="Readings">
<h2>Readings<a class="headerlink" href="#Readings" title="Permalink to this headline">¶</a></h2>
<p>There is no required reading for this lab, beyond the contents of the lab itself. However, if you would like additional background on any of the following topics, then refer to the sections indicated below:</p>
<ul class="simple">
<li><p><strong>Differential Equations:</strong></p>
<ul>
<li><p> <a class="reference external" href="#Ref:Strang">Strang (1986)</a>, Chapter 6 (ODE’s).</p></li>
<li><p> <a class="reference external" href="#Ref:BoyceDiPrima">Boyce and DiPrima (1986)</a> (ODE’s and PDE’s).</p></li>
</ul>
</li>
<li><p><strong>Numerical Methods:</strong></p>
<ul>
<li><p> <a class="reference external" href="#Ref:Strang">Strang (1986)</a>, Section 5.1.</p></li>
<li><p> <a class="reference external" href="#Ref:Garcia">Garcia (1994)</a>, Sections 1.4–1.5, Chapter 2 (a basic introduction to numerical methods for problems in physics).</p></li>
<li><p> <a class="reference external" href="#Ref:BoyceDiPrima">Boyce and DiPrima (1986)</a>, Sections 8.1–8.5, 8.7, 8.8.</p></li>
</ul>
</li>
</ul>
<div class="section" id="Running-Code-Cells">
<h3>Running Code Cells<a class="headerlink" href="#Running-Code-Cells" title="Permalink to this headline">¶</a></h3>
<p>The next cell in this notebook is a code cell. Run it by selecting it and hitting ctrl enter, or by selecting it and hitting the run button (arrow to right) in the notebook controls.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="c1"># import plotting package and numerical python package for use in examples later</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># import the numpy array handling library</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># import the quiz script</span>
<span class="kn">import</span> <span class="nn">context</span>
<span class="kn">from</span> <span class="nn">numlabs.lab1</span> <span class="kn">import</span> <span class="n">quiz1</span> <span class="k">as</span> <span class="n">quiz</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
******************************
context imported. Front of path:
/Users/phil/repos/numeric
back of path: /Users/phil/.ipython
******************************

through /Users/phil/repos/numeric/notebooks/lab1/context.py
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Introduction:-Why-bother-with-numerical-methods?">
<h2>Introduction: Why bother with numerical methods?<a class="headerlink" href="#Introduction:-Why-bother-with-numerical-methods?" title="Permalink to this headline">¶</a></h2>
<p>In introductory courses in ordinary and partial differential equations (ODE’s and PDE’s), many analytical techniques are introduced for deriving solutions. These include the methods of undetermined coefficients, variation of parameters, power series, Laplace transforms, separation of variables, Fourier series, and phase plane analysis, to name a few. When there are so many analytical tools available, one is led to ask:</p>
<blockquote>
<div><p><em>Why bother with numerical methods at all?</em></p>
</div></blockquote>
<p>The fact is that the class of problems that can be solved analytically is <em>very small</em>. Most differential equations that model physical processes cannot be solved explicitly, and the only recourse available is to use a numerical procedure to obtain an approximate solution of the problem.</p>
<p>Furthermore, even if the equation can be integrated to obtain a closed form expression for the solution, it may sometimes be much easier to approximate the solution numerically than to evaluate it analytically.</p>
<p>In the following two sections, we introduce two classical physical models, seen in most courses in differential equations. Analytical solutions are given for these models, but then seemingly minor modifications are made which make it difficult (if not impossible) to calculate actual solution values using analytical techniques. The obvious alternative is to use numerical methods.</p>
<div class="section" id="Ordinary-Differential-Equations">
<h3>Ordinary Differential Equations<a class="headerlink" href="#Ordinary-Differential-Equations" title="Permalink to this headline">¶</a></h3>
<!--- {#lab1:sec:odes} --><p>In order to demonstrate the usefulness of numerical methods, let’s start by looking at an example of a <em>first-order initial value problem</em> (or <em>IVP</em>). In their most general form, these equations look like</p>
<div id="lab1:eq:modelode"><p>(Model ODE)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}
    {\displaystyle \frac{dy}{dt} = f(y,t),} \\
    \; \\
    y(0) = y_0,
  \end{array}\end{split}\]</div>
</div><p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t\)</span> is the <em>independent variable</em> (in many physical systems, which change in time, <span class="math notranslate nohighlight">\(t\)</span> represents time);</p></li>
<li><p><span class="math notranslate nohighlight">\(y(t)\)</span> is the unknown quantity (or <em>dependent variable</em>) that we want to solve for;</p></li>
<li><p><span class="math notranslate nohighlight">\(f(y,t)\)</span> is a known function that can depend on both <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(t\)</span>; and</p></li>
<li><p><span class="math notranslate nohighlight">\(y_0\)</span> is called the <em>initial value</em> or <em>initial condition</em>, since it provides a value for the solution at an initial time, <span class="math notranslate nohighlight">\(t=0\)</span> (the initial value is required so that the problem has a unique solution).</p></li>
</ul>
<p>This problem involves the first derivative of the solution, and also provides an initial value for <span class="math notranslate nohighlight">\(y\)</span>, and hence the name “first-order initial value problem”.</p>
<p>Under certain very general conditions on the right hand side function <span class="math notranslate nohighlight">\(f\)</span>, we know that there will be a unique solution to the problem (<a class="reference external" href="#lab1:eq:modelode">Model ODE</a>). However, only in very special cases can we actually write down a closed-form expression for the solution.</p>
<p>In the remainder of this section, we will leave the general equation, and investigate a specific example related to heat conduction. It will become clear that it is the problems which <em>do not have exact solutions</em> which are the most interesting or meaningful from a physical standpoint.</p>
<div class="section" id="Example-One">
<h4><em>Example One</em><a class="headerlink" href="#Example-One" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Consider a small rock, surrounded by air or water, which gains or loses heat only by conduction with its surroundings (there are no radiation effects). If the rock is small enough, then we can ignore the effects of diffusion of heat within the rock, and consider only the flow of heat through its surface, where the rock interacts with the surrounding medium.</p>
</div></blockquote>
<blockquote>
<div><p>It is well known from experimental observations that the rate at which the temperature of the rock changes is proportional to the difference between the rock’s surface temperature, <span class="math notranslate nohighlight">\(T(t)\)</span>, and the <em>ambient temperature</em>, <span class="math notranslate nohighlight">\(T_a\)</span> (the ambient temperature is simply the temperature of the surrounding material, be it air, water, …). This relationship is expressed by the following ordinary differential equation</p>
<div id="lab1:eq:conduction1d"><p>(Conduction 1d)</p>
<div class="math notranslate nohighlight">
\[\begin{split}%    \textcolor[named]{Red}{\frac{dT}{dt}} = -\lambda \,
%    \textcolor[named]{Blue}{(T-T_a)} .
\underbrace{\frac{dT}{dt}}_{\begin{array}{c}
\mbox{rate of change}\\
\mbox{of temperature}
\end{array}}
= -\lambda \underbrace{(T-T_a)}_{\begin{array}{c}
\mbox{temperature}\\
\mbox{difference}
\end{array}} .\end{split}\]</div>
</div><p>and is commonly known as <em>Newton’s Law of Cooling</em>. (The parameter <span class="math notranslate nohighlight">\(\lambda\)</span> is defined to be <span class="math notranslate nohighlight">\(\lambda = \mu A/cM\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> is the surface area of the rock, <span class="math notranslate nohighlight">\(M\)</span> is its mass, <span class="math notranslate nohighlight">\(\mu\)</span> its thermal conductivity, and <span class="math notranslate nohighlight">\(c\)</span> its specific heat.)</p>
</div></blockquote>
<p>testit</p>
</div>
<div class="section" id="Quiz-on-Newton’s-Law-of-Cooling">
<h4>Quiz on Newton’s Law of Cooling<a class="headerlink" href="#Quiz-on-Newton’s-Law-of-Cooling" title="Permalink to this headline">¶</a></h4>
<p><span class="math notranslate nohighlight">\(\lambda\)</span> is positive? True or False?</p>
<p>In the following, replace ‘xxxx’ by ‘True’, ‘False’, ‘Hint 1’ or ‘Hint 2’ and run the cell (<a class="reference external" href="#Running-Code-Cells">how to</a>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span> <span class="p">(</span><span class="n">quiz</span><span class="o">.</span><span class="n">conduction_quiz</span><span class="p">(</span><span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;xxxx&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Acceptable answers are &#39;True&#39;, &#39;False&#39;, &#39;Hint 1&#39; or &#39;Hint 2&#39;
</pre></div></div>
</div>
<p>If we assume that <span class="math notranslate nohighlight">\(\lambda\)</span> is a constant, then the solution to this equation is given by</p>
<div id="lab1:eq:conduction-soln"><p>(Conduction solution)</p>
<div class="math notranslate nohighlight">
\[T(t) = T_a + (T(0)-T_a)e^{-\lambda t},\]</div>
</div><p>where <span class="math notranslate nohighlight">\(T(0)\)</span> is the initial temperature.</p>
<p><strong>Mathematical Note:</strong> Details of the solution can be found in the <a class="reference external" href="#Solution-to-the-Heat-Conduction-Equation">Appendix</a></p>
<p>In order to obtain realistic value of the parameter <span class="math notranslate nohighlight">\(\lambda\)</span>, let our “small” rock be composed of granite, with mass of <span class="math notranslate nohighlight">\(1\;gram\)</span>, which corresponds to a <span class="math notranslate nohighlight">\(\lambda \approx 10^{-5}\;sec^{-1}\)</span>.</p>
<p>Sample solution curves are given in Figure <a class="reference external" href="#lab1:fig:conduction">Conduction</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;conduction/conduction.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_14_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_14_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_14_0.png" style="width: 60%;" /></a>
</div>
</div>
<div id="lab1:fig:conduction"><p><strong>Figure: Conduction</strong> Plot of solution curves <span class="math notranslate nohighlight">\(T(t)\)</span> for <span class="math notranslate nohighlight">\(T_0=-10,15,20,30\)</span>; parameter values: <span class="math notranslate nohighlight">\(\lambda=10^{-5}\)</span>, <span class="math notranslate nohighlight">\(T_a=20\)</span>.</p>
</div><p>##Demo: Conduction [lab1:demo:conduction]: &lt;#Demo:-Conduction&gt; “Conduction Demo”</p>
<p>Here is an interactive example that investigates the behaviour of the solution.</p>
<p>The first we import the function that does the calculation and plotting. You need to run this cell (<a class="reference external" href="#Running-Code-Cells">how to</a>) to load it. Loading it does not run the function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numlabs.lab1</span> <span class="kn">import</span> <span class="n">temperature_conduction</span> <span class="k">as</span> <span class="n">tc</span>
</pre></div>
</div>
</div>
<p>You need to call the function. Simpliest call is next cell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># simple call to temperature demo</span>
<span class="n">tc</span><span class="o">.</span><span class="n">temperature</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab1_01-lab1_19_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_19_0.png" />
</div>
</div>
<p>After running as is try changing To = To (the initial temperature), Ta = Ta (the ambient temperature) or la = λ (the effective conductivity) to investigate changes in the solution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># setting different values</span>
<span class="c1"># (note this uses the defaults again as written, you should change the values)</span>
<span class="n">tc</span><span class="o">.</span><span class="n">temperature</span><span class="p">(</span><span class="n">Ta</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">To</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">]),</span> <span class="n">la</span> <span class="o">=</span> <span class="mf">0.00001</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab1_01-lab1_21_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_21_0.png" />
</div>
</div>
</div>
<div class="section" id="Example-Two">
<h4>Example Two<a class="headerlink" href="#Example-Two" title="Permalink to this headline">¶</a></h4>
<p>Suppose that the rock in the previous example has a <span class="math notranslate nohighlight">\(\lambda\)</span> which is <em>not</em> constant. For example, if that the rock is made of a material whose specific heat varies with the temperature or time, then <span class="math notranslate nohighlight">\(\lambda\)</span> can be a function of <span class="math notranslate nohighlight">\(T\)</span> or <span class="math notranslate nohighlight">\(t\)</span>. This might happen if the material composing the rock undergoes a phase transition at a certain critical temperature (for example, a melting ice pellet). The problem is now a <em>non-linear</em> one, for which analytical techniques may or
may not provide a solution.</p>
<p>If <span class="math notranslate nohighlight">\(\lambda=\lambda(T)\)</span>, a function of temperature only, then the exact solution may be written as</p>
<div class="math notranslate nohighlight">
\[T(t) = T_a + \exp{\left[-\int^{t}_{0} \lambda(T(s))ds \right]},\]</div>
<p>which involves an integral that may or may not be evaluated analytically, in which case we can only approximate the integral. Furthermore, if <span class="math notranslate nohighlight">\(\lambda\)</span> is a function of both <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(t\)</span> which is <em>not separable</em> (cannot be written as a product of a function of <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(t\)</span>), then we may not be able to write down a closed form for the solution at all, and we must resort to numerical methods to obtain a solution.</p>
<p>Even worse, suppose that we don’t know <span class="math notranslate nohighlight">\(\lambda\)</span> explicitly as a function of temperature, but rather only from experimental measurements of the rock (see Figure <a class="reference external" href="#lab1:fig:table">Table</a> for an example).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 2%" />
<col style="width: 48%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>i</p></th>
<th class="head"><p>Temperature (<span class="math notranslate nohighlight">\(T_i\)</span>)</p></th>
<th class="head"><p>Measured <span class="math notranslate nohighlight">\(\lambda_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>-5.0</p></td>
<td><p>2.92</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>-2.0</p></td>
<td><p>1.59</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1.0</p></td>
<td><p>1.00</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>4.0</p></td>
<td><p>2.52</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>7.0</p></td>
<td><p>3.66</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>10.0</p></td>
<td><p>4.64</p></td>
</tr>
</tbody>
</table>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;table/table-interp.png&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_23_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_23_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_23_0.png" style="width: 60%;" /></a>
</div>
</div>
<div id="lab1:fig:table"><p><strong>Figure Table</strong>: A rock with <span class="math notranslate nohighlight">\(\lambda\)</span> known only at a sequence of discrete temperature values, from experimental measurements. The function <span class="math notranslate nohighlight">\(\lambda(T)\)</span> can be represented approximately using linear interpolation (and the resulting approximate function can then be used to solve the problem numerically.</p>
</div><p>Then there is no way to express the rock’s temperature as a function, and analytical methods fail us, since we do not know the values at points between the given values. One alternative is to approximate <span class="math notranslate nohighlight">\(\lambda\)</span> at intermediate points by joining successive points with straight lines (this is called <em>linear interpolation</em>), and then use the resulting function in a numerical scheme for computing the solution.</p>
<p>As the above example demonstrates, even for a simple ODE such as <a class="reference external" href="#lab1:eq:conduction1d">1-d conduction</a>, there are situations where analytical methods are inadequate.</p>
</div>
</div>
<div class="section" id="Partial-Differential-Equations">
<h3>Partial Differential Equations<a class="headerlink" href="#Partial-Differential-Equations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Example-Three">
<h4>Example Three<a class="headerlink" href="#Example-Three" title="Permalink to this headline">¶</a></h4>
<p>The rock in <a class="reference external" href="#Example-One">Example One</a> was considered to be small enough that the effects of heat diffusion in the interior were negligible in comparison to the heat lost by conduction through its surface. In this example, consider a rock that is <em>not small</em>, and whose temperature changes are dominated by internal diffusion effects. Therefore, it is no longer possible to ignore the spatial dependence in the problem.</p>
<p>For simplicity, we will add spatial dependence in one direction only, which corresponds to a “one-dimensional rock”, or a thin rod. Assume that the rod is insulated along its sides, so that heat flows only along its length, and possibly out the ends (see Figure <a class="reference external" href="#lab1:fig:rock-1d">Rod</a>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;conduction/rod.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_26_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_26_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_26_0.png" style="width: 60%;" /></a>
</div>
</div>
<div id="lab1:fig:rock-1d"><p><strong>Figure Rod</strong>: A thin rod can be thought of as a model for a one-dimensional rock.</p>
</div><p>Consequently, the temperature varies only with position, <span class="math notranslate nohighlight">\(x\)</span>, and time, <span class="math notranslate nohighlight">\(t\)</span>, and can be written as a function <span class="math notranslate nohighlight">\(u(x,t)\)</span>. The temperature in the rod is governed by the following PDE</p>
<div class="math notranslate nohighlight">
\[u_t = \alpha^2 u_{xx},\]</div>
<p>for which we have to provide an initial temperature</p>
<div class="math notranslate nohighlight">
\[u(x,0) = u_0(x),\]</div>
<p>and boundary values</p>
<div class="math notranslate nohighlight">
\[u(0,t)=u(1,t)=0,\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha^2\)</span> is the <em>thermal diffusivity</em> of the material,</p></li>
<li><p><span class="math notranslate nohighlight">\(u_0(x)\)</span> is the initial temperature distribution in the rod, and</p></li>
<li><p>the boundary conditions indicate that the ends of the rod are held at constant temperature, which we’ve assumed is zero.</p></li>
</ul>
<p>Thermal diffusivity is a quantity that depends only on the material from which the bar is made. It is defined by</p>
<div class="math notranslate nohighlight">
\[\alpha^2 = \frac{\kappa}{\rho c},\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa\)</span> is the thermal conductivity, <span class="math notranslate nohighlight">\(\rho\)</span> is the density, and <span class="math notranslate nohighlight">\(c\)</span> is the specific heat. A typical value of the thermal diffusivity for a granite bar is <span class="math notranslate nohighlight">\(0.011\;cm^2/sec\)</span>, and <span class="math notranslate nohighlight">\(0.0038\;cm^2/sec\)</span> for a bar made of brick.</p>
<p>Using the method of <em>separation of variables</em>, we can look for a temperature function of the form <span class="math notranslate nohighlight">\(u(x,t)=X(x) \cdot T(t)\)</span>, which leads to the infinite series solution</p>
<div class="math notranslate nohighlight">
\[u(x,t) = \sum_{n=1}^\infty b_n e^{-n^2\pi^2\alpha^2 t}\sin{(n\pi x)},\]</div>
<p>where the series coefficients are</p>
<div class="math notranslate nohighlight">
\[b_n = 2 \int_0^1 u_0(x) \sin{(n\pi x)} dx.\]</div>
<p><strong>Mathematical Note:</strong> Details of the derivation can be found in any introductory text in PDE’s (for example, <a class="reference external" href="#Ref:BoyceDiPrima">Boyce and DiPrima (1986)</a> [p. 549]).</p>
<p>We do manage to obtain an explicit formula for the solution, which can be used to calculate actual values of the solution. However, there are two obvious reasons why this formula is not of much practical use:</p>
<ol class="arabic simple">
<li><p>The series involves an infinite number of terms (except for very special forms for the initial heat distribution … such as the one shown below). We might be able to truncate the series, since each term decreases exponentially in size, but it is not trivial to decide how many terms to choose in order to get an accurate answer and here we are already entering the realm of numerical approximation.</p></li>
<li><p>Each term in the series requires the evaluation of an integral. When these cannot be integrated analytically, we must find some way to approximate the integrals … numerical analysis rears its head once again!</p></li>
</ol>
<p>For most physical problems, an analytical expression cannot be obtained, and the exact formula is not of much use.</p>
<p>However, consider a very special case, when the initial temperature distribution is sinusoidal,</p>
<div class="math notranslate nohighlight">
\[u_0(x) = \sin(\pi x).\]</div>
<p>For this problem, the infinite series collapses into a single term</p>
<div class="math notranslate nohighlight">
\[u(x,t) = e^{-\pi^2\alpha^2t}\sin{\pi x}.\]</div>
<p>Sample solution curves are given in Figure <a class="reference external" href="#lab1:fig:diffusion-1d">1d Diffusion</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;diffusion/diffusion.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_30_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_30_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_30_0.png" style="width: 60%;" /></a>
</div>
</div>
<div id="lab1:fig:diffusion-1d"><p><strong>Figure 1d-diffusion</strong> Temperature vs. position curves at various times, for heat diffusion in a rod with sinusoidal initial temperature distribution and parameter value <span class="math notranslate nohighlight">\(\alpha=0.2\)</span>.</p>
</div><p>##Movie: Diffusion Here is a movie of the exact solution to the diffusion problem. Run the cell (<a class="reference external" href="#Running-Code-Cells">how to</a>), then run the video. If you want to see the video again, re-run the cell. (The video doesn’t rerun properly from the wysiwyg interface)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">display</span>

<span class="n">vid</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;b4D2ktTtw7E&quot;</span><span class="p">,</span> <span class="n">modestbranding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<iframe
    width="800"
    height="300"
    src="https://www.youtube.com/embed/b4D2ktTtw7E?modestbranding=1&rel=0"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
</div>
<div class="section" id="Summary">
<h4>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h4>
<p>This section is best summed up by the insightful comment of <a class="reference external" href="#Ref:Strang">Strang (1986)</a> [p. 587]:</p>
<p><strong>Nature is nonlinear.</strong></p>
<p>Most problems arising in physics (which are non-linear) cannot be solved analytically, or result in expressions that have little practical value, and we must turn to numerical solution techniques.</p>
</div>
</div>
</div>
<div class="section" id="Discretization">
<h2>Discretization<a class="headerlink" href="#Discretization" title="Permalink to this headline">¶</a></h2>
<p>When computing analytical solutions to differential equations, we are dealing with <em>continuous functions</em>; i.e. functions that depend continuously on the independent variables. A computer, however, has only finite storage capacity, and hence there is no way to represent continuous data, except approximately as a sequence of <em>discrete</em> values.</p>
<blockquote>
<div><p>We already saw an example of a discrete function in Example <a class="reference external" href="#Example-Two">Two</a> where the rate function <span class="math notranslate nohighlight">\(\lambda\)</span>, depended on the temperature. If <span class="math notranslate nohighlight">\(\lambda\)</span> is not known by some empirical formula, then it can only be determined by experimental measurements at a discrete set of temperature values. In Figure <a class="reference external" href="#lab1:fig:table">Table</a>, <span class="math notranslate nohighlight">\(\lambda\)</span> is given at a sequence of six temperature points (<span class="math notranslate nohighlight">\((T_i, \lambda_i)\)</span>, for <span class="math notranslate nohighlight">\(i = 0, 1, \dots, 5)\)</span>), and so is an
example of a <em>discrete function</em>.</p>
</div></blockquote>
<blockquote>
<div><p>The process of interpolation, which was introduced in Example <a class="reference external" href="#Example-Two">Two</a>, will be considered in more detail next.</p>
</div></blockquote>
<blockquote>
<div><p>Consider the two continuous functions</p>
<div class="math notranslate nohighlight">
\[f(x)=x^3-5x \;\; {\rm and} \;\; g(x)=x^{2/3} .\]</div>
<p>(In fact, <span class="math notranslate nohighlight">\(g(x)\)</span> was the function used to generate the values <span class="math notranslate nohighlight">\(\lambda(T)\)</span> in <a class="reference external" href="#Example-Two">Example Two</a>).</p>
</div></blockquote>
<blockquote>
<div><p>The representation of functions using mathematical notation or graphs is very convenient for mathematicians, where continuous functions make sense. However, a computer has a limited storage capacity, and so it can represent a function only at a finite number of discrete points <span class="math notranslate nohighlight">\((x, y)\)</span>.</p>
<p>One question that arises immediately is: <em>What do we do if we have to determine a value of the function which is not at one of the discrete points?</em> The answer to this question is to use some form of <em>interpolation</em> – namely to use an approximation procedure to estimate values of the function at points between the known values.</p>
</div></blockquote>
<blockquote>
<div><p>For example, linear interpolation approximates the function at intermediate points using the straight line segment joining the two neighbouring discrete points. There are other types of interpolation schemes that are more complicated, a few of which are:</p>
<ul class="simple">
<li><p>quadratic interpolation: every two sucessive points are joined by a quadratic polynomial.</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>cubic splines: each pair of points is joined by a cubic polynomial so that the function values and first derivatives match at each point.</p></li>
<li><p>Fourier series: instead of polynomials, uses a sum of <span class="math notranslate nohighlight">\(\sin nx\)</span> and <span class="math notranslate nohighlight">\(\cos nx\)</span> to approximate the function (Fourier series are useful in analysis, as well as spectral methods).</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><ul class="simple">
<li><p>Chebyshev polynomials: another type of polynomial approximation which is useful for spectral methods.</p></li>
<li><p>…many others …</p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>For details on any of these interpolation schemes, see a numerical analysis text such as that by <a class="reference external" href="#Ref-BurdenFaires">Burden and Faires (1981)</a>.</p>
</div></blockquote>
<p>An application of linear interpolation to discrete versions of the functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> is shown in Figure <a class="reference external" href="#lab1:fig:discrete-f">f and g</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;discrete/f.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_37_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_37_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_37_0.png" style="width: 60%;" /></a>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;discrete/g.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">execution-count</dt>
<dd class="field-odd"><p>12</p>
</dd>
<dt class="field-even">fancy</dt>
<dd class="field-even"><p></p></dd>
</dl>
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_38_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_38_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_38_0.png" style="width: 60%;" /></a>
</div></blockquote>
<div id="lab1:fig:discrete-f"><p><strong>Figure f and g</strong>: The functions <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are known only at discrete points. The function can be approximated at other values by linear interpolation, where straight line segments are used to join successive points.</p>
</div></div>
</div>
<blockquote>
<div><p>Depending on the function, or number of location of the points chosen, the approximation may be more or less accurate. In Figure <a class="reference external" href="#lab1:fig:discrete-f">f and g</a>, it is not clear which function is approximated more accurately. In the graph of <span class="math notranslate nohighlight">\(f(x)\)</span>, the error seems to be fairly small throughout. However, for the function <span class="math notranslate nohighlight">\(g(x)\)</span>, the error is large near <span class="math notranslate nohighlight">\(x=0\)</span>, and then very small elsewhere. This problem of <em>accuracy</em> of discrete approximations will come up again and again
in this course.</p>
</div></blockquote>
<p>Here is an interactive example demonstrating the use of interpolation (linear and cubic) in approximating functions.</p>
<p>The next cell imports a module containing two python functions that interpolate the two algebraic functions, f and g (<a class="reference external" href="#lab1:fig:discrete-f">Figure f and g</a>). You need to run this cells (<a class="reference external" href="#Running-Code-Cells">how to</a>) to load them.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numlabs.lab1</span> <span class="kn">import</span> <span class="n">interpolate</span> <span class="k">as</span> <span class="n">ip</span>
</pre></div>
</div>
</div>
<p>Once you have loaded the module, you can call the interpolation routines as ip.interpol_f(pn) and ip.interpol_g(pn). pn is the number of points used the interpolation. Watch what changing pn does to the solutions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ip</span><span class="o">.</span><span class="n">interpol_f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab1_01-lab1_43_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_43_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([-5., -3., -1.,  1.,  3.,  5.]),
 array([-100.,  -12.,    4.,   -4.,   12.,  100.]))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ip</span><span class="o">.</span><span class="n">interpol_g</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab1_01-lab1_44_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_44_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([-5., -3., -1.,  1.,  3.,  5.]),
 array([2.92401774, 2.08008382, 1.        , 1.        , 2.08008382,
        2.92401774]))
</pre></div></div>
</div>
<p>The accuracy of an approximation using linear or cubic interpolation improves as the number of points is increased. True or False?</p>
<p>In the following, replace ‘xxxx’ by ‘True’, ‘False’, or ‘Hint’</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span> <span class="p">(</span><span class="n">quiz</span><span class="o">.</span><span class="n">interpolation_quiz</span><span class="p">(</span><span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;xxx&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Acceptable answers are &#39;True&#39;, &#39;False&#39;, or &#39;Hint&#39;
</pre></div></div>
</div>
<p>When solving differential equations numerically, it is essential to reduce the continuous problem to a discrete one. The basic idea is to look for an approximate solution, which is defined at a finite number of discrete points. This set of points is called a <em>grid</em>. Consider the one-dimensional conduction problem of Example <a class="reference external" href="#Example-One">One, Conduction</a>, which in its most general form reads</p>
<div id="lab1:eq:conduction"><p>(Conduction Equation)</p>
<div class="math notranslate nohighlight">
\[\frac{dT}{dt} = -\lambda(T,t) \, (T-T_a),\]</div>
</div><p>with initial temperature <span class="math notranslate nohighlight">\(T(0)\)</span>.</p>
<p>When we say we want to design a numerical procedure for solving this initial value problem, what we want is a procedure for constructing a sequence of approximations,</p>
<div class="math notranslate nohighlight">
\[T_0, \, T_1, \, \ldots, \, T_i, \, \ldots,\]</div>
<p>defined at a set of discrete <span class="math notranslate nohighlight">\(t\)</span>-points,</p>
<div class="math notranslate nohighlight">
\[t_0&lt;t_1 &lt; \cdots &lt;t_i &lt; \cdots\]</div>
<p>Each <span class="math notranslate nohighlight">\(T_i\)</span> is an approximation of the actual temperature at <span class="math notranslate nohighlight">\(t_i\)</span>; that is</p>
<div class="math notranslate nohighlight">
\[T_i \approx T(t_i).\]</div>
<p>For now, we will consider equally-spaced points, each of which is separated by a distance <span class="math notranslate nohighlight">\(\Delta t\)</span>, so that</p>
<div class="math notranslate nohighlight">
\[t_i=t_0+i \Delta t .\]</div>
<p>An example of such a grid is shown in Figure <a class="reference external" href="#lab1:fig:discrete-points">Grid</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;discrete/grid.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;80%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_48_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_48_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_48_0.png" style="width: 80%;" /></a>
</div>
</div>
<div id="lab1:fig:discrete-points"><p><strong>Figure Grid:</strong> A grid of equally-spaced points, <span class="math notranslate nohighlight">\(t_i=t_0+i\Delta t\)</span>, for <span class="math notranslate nohighlight">\(i=0,1,2,\ldots\)</span>.</p>
</div><p>This process of reducing a continuous problem to one in a finite number of discrete unknowns is called <em>discretization</em>. The actual mechanics of discretizing differential equations are introduced in the following section.</p>
<p>What phrase best describes “discretization”?</p>
<p><strong>A</strong> The development and analysis of methods for the solution of mathematical problems on a computer.</p>
<p><strong>B</strong> The process of replacing continuous functions by discrete values.</p>
<p><strong>C</strong> Employing the discrete Fourier transform to analyze the stability of a numerical scheme.</p>
<p><strong>D</strong> The method by which one can reduce an initial value problem to a set of discrete linear equations that can be solved on a computer.</p>
<p>In the following, replace ‘x’ by ‘A’, ‘B’, ‘C’, ‘D’ or ‘Hint’</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span> <span class="p">(</span><span class="n">quiz</span><span class="o">.</span><span class="n">discretization_quiz</span><span class="p">(</span><span class="n">answer</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Acceptable answers are &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39; or &#39;Hint&#39;
</pre></div></div>
</div>
<p>The basic idea in this section is that continuous functions can be approximated by discrete ones, through the process of <em>discretization</em>. In the course of looking at discrete approximations in the interactive example, we introduced the idea of the <em>accuracy</em> of an approximation, and showed that increasing the accuracy of an approximation is not straightforward.</p>
<p>We introduced the notation for approximate solutions to differential equations on a grid of points. The mechanics of discretization as they apply to differential equations, will be investigated further in the remainder of this Lab, as well as in Lab Two.</p>
</div>
<div class="section" id="Difference-Approximations-to-the-First-Derivative">
<h2>Difference Approximations to the First Derivative<a class="headerlink" href="#Difference-Approximations-to-the-First-Derivative" title="Permalink to this headline">¶</a></h2>
<p>It only remains to write a discrete version of the differential equation (<a class="reference external" href="#lab1:eq:conduction">Conduction Equation</a>) involving the approximations <span class="math notranslate nohighlight">\(T_i\)</span>. The way we do this is to approximate the derivatives with <em>finite differences</em>. If this term is new to you, then you can think of it as just another name for a concept you have already seen in calculus. Remember the <em>definition of the derivative of a function :math:`y(t)`</em>, where <span class="math notranslate nohighlight">\(y^\prime(t)\)</span> is written as a limit of a divided
difference:</p>
<div id="lab1:eq:defn-deriv"><p>(limit definition of derivative)</p>
<div class="math notranslate nohighlight">
\[y^\prime(t) = \lim_{\Delta t\rightarrow 0} \frac{y(t+\Delta t)-y(t)}{\Delta t}.\]</div>
</div><p>We can apply the same idea to approximate the derivative <span class="math notranslate nohighlight">\(dT/dt=T^\prime\)</span> in (<a class="reference external" href="#lab1:eq:conduction">Conduction Equation</a>) by the <em>forward difference formula</em>, using the discrete approximations, <span class="math notranslate nohighlight">\(T_i\)</span>:</p>
<div id="lab1:eq:forward-diff"><p>(Forward Difference Formula)</p>
<div class="math notranslate nohighlight">
\[T^\prime(t_i) \approx \frac{T_{i+1}-T_i}{\Delta t}.\]</div>
</div><p>In order to understand the ability of the formula (<a class="reference external" href="#lab1:eq:forward-diff">Forward Difference Formula</a>) to approximate the derivative, let’s look at a specific example. Take the function <span class="math notranslate nohighlight">\(y(x)=x^3-5x\)</span>, and apply the forward difference formula at the point <span class="math notranslate nohighlight">\(x=1\)</span>. The function and its tangent line (the short line segment with slope <span class="math notranslate nohighlight">\(y^\prime(1)\)</span>) are displayed in Figure <a class="reference external" href="#lab1:fig:deriv">Tangents</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;deriv/deriv.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">execution-count</dt>
<dd class="field-odd"><p>19</p>
</dd>
<dt class="field-even">fancy</dt>
<dd class="field-even"><p></p></dd>
</dl>
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_54_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_54_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_54_0.png" style="width: 60%;" /></a>
</div></blockquote>
<div id="lab1:fig:deriv"><p><strong>Figure Tangents:</strong> Plot of the function <span class="math notranslate nohighlight">\(y=x^3-5x\)</span> and the forward difference approximations to the derivative for various values of <span class="math notranslate nohighlight">\(\Delta t\)</span></p>
</div></div>
</div>
<blockquote>
<div><p>Each of the remaining line segments represents the forward difference approximation to the tangent line for different values of <span class="math notranslate nohighlight">\(\Delta t\)</span>, which are simply <em>the secant lines through the points :math:`(t, y(t))` and :math:`(t+Delta t, y(t+Delta t))`</em>. Notice that the approximation improves as <span class="math notranslate nohighlight">\(\Delta t\)</span> is reduced. This motivates the idea that grid refinement improves the accuracy of the discretization …but not always (as we will see in the coming sections).</p>
</div></blockquote>
<div class="section" id="Investigation">
<h3>Investigation<a class="headerlink" href="#Investigation" title="Permalink to this headline">¶</a></h3>
<p>Investigate the use of the forward difference approximation of the derivative in the following interactive example.</p>
<p>The next cell loads a python function that plots a function f(x) and approximates its derivative at <span class="math notranslate nohighlight">\(x=1\)</span> based on a second x-point that you chose (xb). You need to run this cell (<a class="reference external" href="#Running-Code-Cells">how to</a>) to load it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numlabs.lab1</span> <span class="kn">import</span> <span class="n">derivative_approx</span> <span class="k">as</span> <span class="n">da</span>
</pre></div>
</div>
</div>
<p>Once you have loaded the function you can call it as da.plot_secant(xb) where xb the second point used to estimate the derivative (slope) at <span class="math notranslate nohighlight">\(x=1\)</span>. You can compare the slope of the estimate (straight line) to the slope of the function (blue curve).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">da</span><span class="o">.</span><span class="n">plot_secant</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab1_01-lab1_59_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_59_0.png" />
</div>
</div>
</div>
<div class="section" id="Forward-Euler-Method">
<h3>Forward Euler Method<a class="headerlink" href="#Forward-Euler-Method" title="Permalink to this headline">¶</a></h3>
<p>We can now write down a discrete version of our model ODE problem (<a class="reference external" href="#lab1:eq:conduction">Conduction Equation</a>) at any point <span class="math notranslate nohighlight">\(t_i\)</span> by</p>
<ol class="arabic simple">
<li><p>discretizing the derivative on the left hand side (for example, using the forward difference approximation (<a class="reference external" href="#lab1:eq:forward-diff">Forward Difference Formula</a>);</p></li>
<li><p>evaluating the right hand side function at the discrete point <span class="math notranslate nohighlight">\(t_i\)</span>.</p></li>
</ol>
<p>The discrete form of the problem is</p>
<div class="math notranslate nohighlight">
\[\frac{T_{i+1}-T_i}{\Delta t} = \lambda(T_i,t_i) \, (T_i-T_a),\]</div>
<p>or, after rearranging,</p>
<div id="lab1:eq:forward-euler-conduction"><div class="math notranslate nohighlight">
\[T_{i+1} = T_i + \Delta t \, \lambda(T_i,t_i) \, (T_i-T_a).\]</div>
</div><p>This formula is called the <em>Forward Euler method</em> (since it uses forward differences). Notice that this formula relates each discrete solution value to the solution at the preceding <span class="math notranslate nohighlight">\(t\)</span>-point. Consequently, if we are given an initial value <span class="math notranslate nohighlight">\(T(0)\)</span>, then all subsequent values of the solution are easily computed.</p>
<p>(<strong>Note:</strong> The forward Euler formula for the more general first-order IVP in (<a class="reference external" href="#lab1:eq:modelode'">Model ODE</a>) is simply <span class="math notranslate nohighlight">\(y_{i+1} = y_i + \Delta t f(y_i,t_i)\)</span>.)</p>
<div class="section" id="Example-Seven">
<h4>Example Seven<a class="headerlink" href="#Example-Seven" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Let us now turn to another example in atmospheric physics to illustrate the use of the forward Euler method. Consider the process of condensation and evaporation in a cloud. The <em>saturation ratio</em>, <span class="math notranslate nohighlight">\(S\)</span>, is the ratio of the vapour pressure to the vapour pressure of a plane surface of water at temperature <span class="math notranslate nohighlight">\(T\)</span>. <span class="math notranslate nohighlight">\(S\)</span> varies in time according to the</p>
</div></blockquote>
<blockquote>
<div><div id="lab1:eq:saturation"><p>(saturation development equation)</p>
<div class="math notranslate nohighlight">
\[\frac{dS}{dt} = \alpha S^2 + \beta S + \gamma,\]</div>
</div><p>where <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are complicated (but constant) expressions involving the physical parameters in the problem (and so we won’t reproduce them here).</p>
</div></blockquote>
<blockquote>
<div><p>What are some physically reasonable values of the parameters (other than simply <span class="math notranslate nohighlight">\(\alpha&lt;0\)</span> and <span class="math notranslate nohighlight">\(\gamma&gt;0\)</span>)?</p>
<p><a class="reference external" href="#Ref:Chen">Chen (1994)</a> gives a detailed derivation of the equation, which is a non-linear, first order ODE (i.e. non-linear in the dependent variable <span class="math notranslate nohighlight">\(S\)</span>, and it contains only a first derivative in the time variable). Chen also derives an analytical solution to the problem which takes a couple pages of messy algebra to come to. Rather than show these details, we would like to use the forward Euler method in order to compute the solution numerically, and as we will see, this is
actually quite simple.</p>
<p>Using the (<a class="reference external" href="#lab1:eq:forward-diff">forward difference formula</a>), the discrete form of the (<a class="reference external" href="#lab1:eq:saturation">saturation development equation</a>) is</p>
<div class="math notranslate nohighlight">
\[S_{i+1} = S_i + \Delta t \left( \alpha S_i^2 + \beta S_i +
\gamma \right).\]</div>
<p>Consider an initial saturation ratio of <span class="math notranslate nohighlight">\(0.98\)</span>, and take parameter values <span class="math notranslate nohighlight">\(\alpha=-1\)</span>, <span class="math notranslate nohighlight">\(\beta=1\)</span> and <span class="math notranslate nohighlight">\(\gamma=1\)</span>. The resulting solution, for various values of the time step <span class="math notranslate nohighlight">\(\Delta t\)</span>,is plotted in Figure <a class="reference external" href="#lab1:fig:saturation">Saturation Time Series</a>.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;feuler/sat2.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_62_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_62_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_62_0.png" style="width: 60%;" /></a>
</div>
</div>
<div id="lab1:fig:saturation"><p><strong>Figure Saturation Time Series:</strong> Plot of the saturation ratio as a function of time using the Forward Euler method. “nt” is the number of time steps.</p>
</div>






There are two things to notice here, both related to the importance of the choice of time step :math:`\Delta t`:<blockquote>
<div><ul class="simple">
<li><p>As <span class="math notranslate nohighlight">\(\Delta t\)</span> is reduced, the solution appears to <em>converge</em> to one solution curve, which we would hope is the exact solution to the differential equation. An important question to ask is: <em>When will the numerical method converge to the exact solution as :math:`Delta t` is reduced?</em></p></li>
<li><p>If <span class="math notranslate nohighlight">\(\Delta t\)</span> is taken too large, however, the numerical solution breaks down. In the above example, the oscillations that occur for the largest time step (when <span class="math notranslate nohighlight">\(nt=6\)</span>) are a sign of <em>numerical instability</em>. The differential problem is stable and exhibits no such behaviour, but the numerical scheme we have used has introduced an instability. An obvious question that arises is: <em>How can we avoid introducing instabilities in a numerical scheme?</em></p></li>
</ul>
</div></blockquote>
<blockquote>
<div><p>Neither question has an obvious answer, and both issues will be investigated further in Lab 2.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="Other-Approximations">
<h3>Other Approximations<a class="headerlink" href="#Other-Approximations" title="Permalink to this headline">¶</a></h3>
<p>Look again at the (<a class="reference external" href="#lab1:eq:defn-deriv">limit definition of derivative</a>), and notice that an equivalent expression for <span class="math notranslate nohighlight">\(T^\prime\)</span> is</p>
<div id="lab1:eq:defn-back"><div class="math notranslate nohighlight">
\[T^\prime(t) = \lim_{\Delta t\rightarrow 0} \frac{T(t)-T(t-\Delta t)}{\Delta t}.\]</div>
</div><p>From this, we can derive the <em>backward difference formula</em> for the first derivative,</p>
<div id="lab1:eq:backward-diff"><p>(Backward Difference Formula)</p>
<div class="math notranslate nohighlight">
\[T^\prime(t_i) \approx \frac{T_i-T_{i-1}}{\Delta t},\]</div>
</div><p>and similarly the <em>centered difference formula</em></p>
<div id="lab1:eq:centered-diff"><p>(Centered Difference Formula)</p>
<div class="math notranslate nohighlight">
\[T^\prime(t_i) \approx \frac{T_{i+1}-T_{i-1}}{2 \Delta t}.\]</div>
</div><p>The corresponding limit formulas are equivalent from a mathemtaical standpoint, <strong>but the discrete formulas are not!</strong> In particular, teh accuracy and stability of numerical schemes derived from the three difference formulas: (<a class="reference external" href="#lab1:eq:forward-diff'">Forward Difference Formula</a>), (<a class="reference external" href="#lab1:eq:backward-diff'">Backward Difference Formula</a>) and (<a class="reference external" href="#lab1:eq:centered-diff">Centered Difference Formula</a>) are quite different. More will said on this in the next Lab.</p>
<div class="section" id="Summary">
<h4>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h4>
<p>This section introduces the use of the forward difference formula to discretize the derivatives in a first order differential equation. The resulting numerical scheme is called the forward Euler method. We also introduced the backward and centered difference formulas for the first derivative, which were also obtained from the definition of derivative.</p>
<p>You saw how the choice of grid spacing affected the accuracy of the solution, and were introduced to the concepts of convergence and stability of a numerical scheme. More will be said about these topics in the succeeding lab, as well as other methods for discretizing derivatives.</p>
</div>
</div>
</div>
<div class="section" id="Generalizations">
<h2>Generalizations<a class="headerlink" href="#Generalizations" title="Permalink to this headline">¶</a></h2>
<p>The idea of discretization introduced in the previous section can be generalized in several ways, some of which are:</p>
<ul class="simple">
<li><p>problems with higher derivatives,</p></li>
<li><p>systems of ordinary differential equations,</p></li>
<li><p>boundary value problems, and</p></li>
<li><p>partial differential equations.</p></li>
</ul>
<div class="section" id="Higher-Derivatives">
<h3>Higher Derivatives<a class="headerlink" href="#Higher-Derivatives" title="Permalink to this headline">¶</a></h3>
<p>Many problems in physics involve derivatives of second order and higher. Discretization of these derivatives is no more difficult than the first derivative in the previous section. The difference formula for the second derivative, which will be derived in Lab #2, is given by</p>
<div id="lab1:eq:centered-diff2"><p>(Centered Second Derivative)</p>
<div class="math notranslate nohighlight">
\[y^{\prime\prime}(t_i) \approx
  \frac{y(t_{i+1})-2y(t_i)+y(t_{i-1})}{(\Delta t)^2} ,\]</div>
</div><p>and is called the <em>second-order centered difference formula</em> for the second derivative (“centered”, because it involves the three points centered about <span class="math notranslate nohighlight">\(t_i\)</span>, and “second-order” for reasons we will see in the next Lab). We will apply this formula in the following example …</p>
<div class="section" id="Example-Eight">
<h4><em>Example Eight</em><a class="headerlink" href="#Example-Eight" title="Permalink to this headline">¶</a></h4>
<p>A weather balloon, filled with helium, climbs vertically until it reaches its level of neutral buoyancy, at which point it begins to oscillate about this equilibrium height. We can derive a DE describing the motion of the balloon by applying Newton’s second law:</p>
<div class="math notranslate nohighlight">
\[mass \; \times \; acceleration = force\]</div>
<div class="math notranslate nohighlight">
\[m \frac{d^2 y}{d t^2} =
      \underbrace{- \beta \frac{dy}{dt}}_{\mbox{air resistance}}
      \underbrace{- \gamma y}_{\mbox{buoyant force}},\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y(t)\)</span> is the displacement of the balloon vertically from its equilibrium level, <span class="math notranslate nohighlight">\(y=0\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> is the mass of the balloon and payload;</p></li>
<li><p>the oscillations are assumed small, so that we can assume a linear functional form for the buoyant force, <span class="math notranslate nohighlight">\(-\gamma y\)</span>.</p></li>
</ul>
<p>This problem also requires initial values for both the initial displacement and velocity:</p>
<div class="math notranslate nohighlight">
\[y(0) = y_0 \;\; \mbox{and} \;\; \frac{dy}{dt}(0) = v_0.\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;balloon/balloon.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;60%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">execution-count</dt>
<dd class="field-odd"><p>23</p>
</dd>
<dt class="field-even">fancy</dt>
<dd class="field-even"><p></p></dd>
</dl>
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_69_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_69_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_69_0.png" style="width: 60%;" /></a>
</div></blockquote>
<div id="lab1:fig:balloon"><p><strong>Figure Weather Balloon:</strong> A weather balloon oscillating about its level of neutral buoyancy.</p>
</div></div>
</div>
</div>
<div class="section" id="Problem-One">
<h4>Problem One<a class="headerlink" href="#Problem-One" title="Permalink to this headline">¶</a></h4>
<ol class="loweralpha simple">
<li><p>Using the centered difference formula (<a class="reference external" href="#lab1:eq:centered-diff2">Centered Second Derivative</a>) for the second derivative, and the forward difference formula (<a class="reference external" href="#lab1:eq:forward-diff'">Forward Difference Formula</a>) for the first derivative at the point <span class="math notranslate nohighlight">\(t_i\)</span>, derive a difference scheme for <span class="math notranslate nohighlight">\(y_{i+1}\)</span>, the vertical displacement of the weather balloon.</p></li>
<li><p>What is the difference between this scheme and the forward Euler scheme from [Example Seven](#Example-Seven] , <em>Fix Link</em> related to the initial conditions? (<strong>Hint:</strong> think about starting values …)</p></li>
<li><p>Given the initial values above, explain how to start the numerical integration.</p></li>
</ol>
<p><em>Note</em>: There are a number of problems in the text of each lab. See the syllabus for which problems you are assigned as part of your course. That is, you don’t have to do them all!</p>
</div>
</div>
<div class="section" id="Systems-of-First-order-ODE’s">
<h3>Systems of First-order ODE’s<a class="headerlink" href="#Systems-of-First-order-ODE’s" title="Permalink to this headline">¶</a></h3>
<p>Discretization extends in a simple way to first-order systems of ODE’s, which arise in many problems, as we will see in some of the later labs. For now, though, we can see:</p>
<div class="section" id="Example-9">
<h4>Example 9<a class="headerlink" href="#Example-9" title="Permalink to this headline">¶</a></h4>
<p>The second order DE for the weather balloon problem from Example <a class="reference external" href="#Example-Eight">Eight</a> can be rewritten by letting <span class="math notranslate nohighlight">\(u=dy/dt\)</span>. Then,</p>
<p><span class="math">\begin{align}
\frac{dy}{dt} &= u\\
\frac{du}{dt} &= -\frac{\beta}{m} u - \frac{\gamma}{m} y
\end{align}</span></p>
<p>which is a system of first order ODE’s in <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. This set of differential equations can be discretized to obtain another numerical scheme for the weather balloon problem.</p>
</div>
<div class="section" id="Problem-Two">
<h4>Problem Two<a class="headerlink" href="#Problem-Two" title="Permalink to this headline">¶</a></h4>
<ol class="loweralpha simple">
<li><p>Derive a difference scheme for the problem based on the above system of two ODE’s using the forward difference formula for the first derivative.</p></li>
<li><p>By combining the discretized equations into one equation for y, show that the difference between this scheme and the scheme obtained in problem one is the difference formula for the second derivative.</p></li>
</ol>
</div>
</div>
<div class="section" id="Boundary-Value-Problem">
<h3>Boundary Value Problem<a class="headerlink" href="#Boundary-Value-Problem" title="Permalink to this headline">¶</a></h3>
<p>So far, we’ve been dealing with <em>initial value problems</em> or <em>IVP’s</em> (such as the problem of heat conduction in a rock in Example <a class="reference external" href="#Example-One">One</a>): a differential equation is given for an unknown function, along with its initial value. There is another class of problems, called <em>boundary value problems</em> (or <em>BVP’s</em>), where the independent variables are restricted to a <em>closed domain</em> (as opposed to an <em>open domain</em>) and the solution (or its derivative) is specified at every point along the
boundary of the domain. Contrast this to initial value problems, where the solution is <em>not given</em> at the end time.</p>
<p>A simple example of a boundary value problem is the steady state heat diffusion equation problem for the rod in Example <a class="reference external" href="#Example-Three">Three</a>. By <em>steady state</em>, we mean simply that the rod has reached a state where its temperature no longer changes in time; that is, <span class="math notranslate nohighlight">\(\partial u/\partial t = 0\)</span>. The corresponding problem has a temperature, <span class="math notranslate nohighlight">\(u(x)\)</span>, that depends on position only, and obeys the following equation and boundary conditions:</p>
<div class="math notranslate nohighlight">
\[u_{xx} = 0,\]</div>
<div class="math notranslate nohighlight">
\[u(0) = u(1) = 0.\]</div>
<p>This problem is known as an <em>initial-boundary value problem</em> (or <em>IBVP</em>), since it has a mix of both initial and boundary values.</p>
<p>The structure of initial and boundary value problems are quite different mathematically: IVP’s involve a time variable which is unknown at the end time of the integration (and hence the solution is known on an open domain or interval), whereas BVP’s specify the solution value on a closed domain or interval. The numerical methods corresponding to these problems are also quite different, and this can be best illustrated by an example.</p>
<div class="section" id="Example-10">
<h4>Example 10<a class="headerlink" href="#Example-10" title="Permalink to this headline">¶</a></h4>
<p>We can discretize the steady state diffusion equation using the centered difference formula for the second derivative to obtain:</p>
<div class="math notranslate nohighlight">
\[u_{i+1}-2u_i+u_{i-1} = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(u_i\approx u(i/N)\)</span> and <span class="math notranslate nohighlight">\(i=0,1,\ldots,N\)</span> (and the factor of <span class="math notranslate nohighlight">\((\Delta x)^2 = {1}/{N^2}\)</span> has been multiplied out). The boundary values <span class="math notranslate nohighlight">\(u_0\)</span> and <span class="math notranslate nohighlight">\(u_N\)</span> are both known to be zero, so the above expression represents a system of <span class="math notranslate nohighlight">\(N-1\)</span> equations in <span class="math notranslate nohighlight">\(N-1\)</span> unknown values <span class="math notranslate nohighlight">\(u_i\)</span> that must be solved for <em>simultaneously</em>. The solution of such systems of linear equations will be covered in more detail in Lab #3 in fact, this equation forms the basis for
a Problem in the Linear Algebra Lab.</p>
<p>Compare this to the initial value problems discretized using the forward Euler method, where the resulting numerical scheme is a step-by-step, marching process (that is, the solution at one grid point can be computed using an explicit formula using only the value at the previous grid point).</p>
</div>
</div>
<div class="section" id="Partial-Differential-Equations">
<h3>Partial Differential Equations<a class="headerlink" href="#Partial-Differential-Equations" title="Permalink to this headline">¶</a></h3>
<p>So far, the examples have been confined to ordinary differential equations, but the procedure we’ve set out for ODE’s extends with only minor modifications to problems involving PDE’s.</p>
<div class="section" id="Example-11">
<h4>Example 11<a class="headerlink" href="#Example-11" title="Permalink to this headline">¶</a></h4>
<p>To illustrate the process, let us go back to the heat diffusion problem from Example <a class="reference external" href="#Example-Three">Three</a>, an initial-boundary value problem in the temperature <span class="math notranslate nohighlight">\(u(x,t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[u_{t} = \alpha^2 u_{xx},\]</div>
<p>along with initial values</p>
<div class="math notranslate nohighlight">
\[u(x,0) = u_0(x),\]</div>
<p>and boundary values</p>
<div class="math notranslate nohighlight">
\[u(0,t) = u(1,t) = 0.\]</div>
<p>As for ODE’s, the steps in the process of discretization remain the same:</p>
<ol class="arabic">
<li><p>First, replace the independent variables by discrete values</p>
<div class="math notranslate nohighlight">
\[x_i = i \Delta x = \frac{i}{M}, \;\; \mbox{where $i=0, 1,
      \ldots, M$, and}\]</div>
<div class="math notranslate nohighlight">
\[t_n = n \Delta t, \;\; \mbox{where $n=0, 1,
      \ldots$}\]</div>
<p>In this example, the set of discrete points define a two-dimensional grid of points, as pictured in Figure <a class="reference external" href="#lab1:fig:pde-grid">PDE Grid</a>.</p>
</li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;pdes/pde-grid.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<a class="reference internal image-reference" href="../../_images/doc_notebooks_lab1_01-lab1_77_0.png"><img alt="../../_images/doc_notebooks_lab1_01-lab1_77_0.png" src="../../_images/doc_notebooks_lab1_01-lab1_77_0.png" style="width: 40%;" /></a>
</div>
</div>
<div id="lab1:fig:pde-grid"><p><strong>Figure PDE Grid:</strong> The computational grid for the heat diffusion problem, with discrete points <span class="math notranslate nohighlight">\((x_i,t_n)\)</span>.</p>
</div><ol class="arabic" start="2">
<li><p>Replace the dependent variables (in this example, just the temperature <span class="math notranslate nohighlight">\(u(x,t)\)</span>) with approximations defined at the grid points:</p>
<div class="math notranslate nohighlight">
\[U_i^n \approx u(x_i,t_n).\]</div>
<p>The boundary and initial values for the discrete temperatures can then be written in terms of the given information.</p>
</li>
<li><p>Approximate all of the derivatives appearing in the problem with finite difference approximations. If we use the centered difference approximation (<a class="reference external" href="#lab1:eq:centered-diff2">Centered Second Derivative</a>) for the second derivative in <span class="math notranslate nohighlight">\(x\)</span>, and the forward difference formula (<a class="reference external" href="#lab1:eq:forward-diff'">Forward Difference Formula</a>) for the time derivative (while evaluating the terms on the right hand side at the previous time level), we obtain the following numerical scheme:</p>
<div class="math notranslate nohighlight">
\[U_i^{n+1} = U_i^n + \frac{\alpha^2 \Delta t}{(\Delta x)^2} \left(
      U_{i+1}^n - 2 U_i^n + U_{i-1}^n \right).\]</div>
</li>
</ol>
<p>Given the initial values, <span class="math notranslate nohighlight">\(U_i^0=u_0(x_i)\)</span>, and boundary values <span class="math notranslate nohighlight">\(U_0^n=U_M^n=0\)</span>, this difference formula allows us to compute values of temperature at any time, based on values at the previous time.</p>
<p>There are, of course, other ways of discretizing this problem, but the above is one of the simplest.</p>
</div>
</div>
</div>
<div class="section" id="Mathematical-Notes">
<h2>Mathematical Notes<a class="headerlink" href="#Mathematical-Notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Solution-to-the-Heat-Conduction-Equation">
<h3>Solution to the Heat Conduction Equation<a class="headerlink" href="#Solution-to-the-Heat-Conduction-Equation" title="Permalink to this headline">¶</a></h3>
<p>In Example <a class="reference external" href="#Example-One">One</a>, we had the equation</p>
<div class="math notranslate nohighlight">
\[\frac{dT}{dt} = -\lambda (T-T_a),\]</div>
<p>subject to the initial condition <span class="math notranslate nohighlight">\(T(0)\)</span>. This equation can be solved by <em>separation of variables</em>, whereby all expressions involving the independent variable <span class="math notranslate nohighlight">\(t\)</span> are moved to the right hand side, and all those involving the dependent variable <span class="math notranslate nohighlight">\(T\)</span> are moved to the left</p>
<div class="math notranslate nohighlight">
\[\frac{dT}{T-T_a} = -\lambda dt.\]</div>
<p>The resulting expression is integrated from time <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight">
\[\int_{T(0)}^{T(t)} \frac{dS}{S-T_a} = -\int_0^t\lambda ds,\]</div>
<p>(where <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(S\)</span> are dummy variables of integration), which then leads to the relationship</p>
<div class="math notranslate nohighlight">
\[\ln \left( T(t)-T_a)-\ln(T(0)-T_a \right) = -\lambda t,\]</div>
<p>or, after exponentiating both sides and rearranging,</p>
<div class="math notranslate nohighlight">
\[T(t) = T_a + (T(0)-T_a)e^{-\lambda t},\]</div>
<p>which is exactly the <a class="reference external" href="#lab1:eq:conduction-soln">Conduction Solution</a> equation.</p>
</div>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<div id="Ref:BoyceDiPrima"><p>Boyce, W. E. and R. C. DiPrima, 1986: Elementary Differential Equations and Boundary Value Problems. John Wiley &amp; Sons, New York, NY, 4th edition.</p>
</div><div id="Ref:BurdenFaires"><p>Burden, R. L. and J. D. Faires, 1981: Numerical Analysis. PWS-Kent, Boston, 4th edition.</p>
</div><div id="Ref:Chen"><p>Chen, J.-P., 1994: Predictions of saturation ratio for cloud microphysical models. Journal of the Atmospheric Sciences, 51(10), 1332–1338.</p>
</div><div id="Ref:Garcia"><p>Garcia, A. L., 1994: Numerical Methods for Physics. Prentice-Hall, Englewood Cliffs, NJ.</p>
</div><div id="Ref:Strang"><p>Strang, G., 1986: Introduction to Applied Mathematics. Wellesley-Cambridge Press, Wellesley, MA.</p>
</div></div>
<div class="section" id="Glossary">
<h2>Glossary<a class="headerlink" href="#Glossary" title="Permalink to this headline">¶</a></h2>
<p><strong>backward difference discretization:</strong> used to estimate a derivative – uses the current points and points with smaller independent variable.</p>
<p><strong>boundary value problem:</strong> a differential equation (or set of differential equations) along with boundary values for the unknown functions. Abbreviated BVP.</p>
<p><strong>BVP:</strong> see <em>boundary value problem</em></p>
<p><strong>centre difference discretization:</strong> used to estimate a derivative – uses a discretization symmetric (in independent variable) around the current point.</p>
<p><strong>closed domain:</strong> a domain for which the value of the dependent variables is known on the boundary of the domain.</p>
<p><strong>converge:</strong> as the discretization step (eg. ∆t) is reduced the solutions generated approach one solution curve.</p>
<p><strong>DE:</strong> see <em>differential equation</em></p>
<p><strong>dependent variable:</strong> a variable which is a (possibly unknown) function of the independent variables in a problem; for example, in a fluid the pressure can be thought of as a dependent variable, which depends on the time t and position (x, y, z).</p>
<p><strong>differential equation:</strong> an equation involving derivatives. Abbreviated DE.</p>
<p><strong>discretization:</strong> when referring to DE’s, it is the process whereby the independent variables are replaced by a <em>grid</em> of discrete points; the dependent variables are replaced by approximations at the grid points; and the derivatives appearing in the problem are replaced by a <em>finite difference</em> approximation. The discretization process replaces the DE (or DE’s) with an algebraic equation or finite system of algebraic equations which can be solved on a computer.</p>
<p><strong>finite difference:</strong> an approximation of the derivative of a function by a difference quotient involving values of the function at discrete points. The simplest method of deriving finite difference formulae is using Taylor series.</p>
<p><strong>first order differential equation:</strong> a differential equation involving only first derivatives of the unknown functions.</p>
<p><strong>forward difference discretization:</strong> used to calculate a derivative – uses the current points and points with larger independent variable.</p>
<p><strong>grid:</strong> when referring to discretization of a DE, a grid is a set of discrete values of the independent variables, defining a <em>mesh</em> or array of points, at which the solution is approximated.</p>
<p><strong>independent variable:</strong> a variable that does not depend on other quantities (typical examples are time, position, etc.)</p>
<p><strong>initial value problem:</strong> a differential equation (or set of differential equations) along with initial values for the unknown functions. Abbreviated IVP.</p>
<p><strong>interpolation:</strong> a method for estimating the value of a function at points intermediate to those where its values are known.</p>
<p><strong>IVP:</strong> initial value problem</p>
<p><strong>linear:</strong> pertaining to a function or expression in which the quantities appear in a linear combination. If <span class="math notranslate nohighlight">\(x_i\)</span> are the variable quantities, and <span class="math notranslate nohighlight">\(c_i\)</span> are constants, then any linear function of the <span class="math notranslate nohighlight">\(x_i\)</span> can be written in the form <span class="math notranslate nohighlight">\(c_0 + \sum_i c_i \cdot x_i\)</span>.</p>
<p><strong>linear interpolation:</strong> interpolation using straight lines between the known points</p>
<p><strong>Navier-Stokes equations:</strong> the system of non-linear PDE’s that describe the time evolution of the flow of a fluid.</p>
<p><strong>non-linear:</strong> pertaining to a function or expression in which the quantities appear in a non-linear combination.</p>
<p><strong>numerical instability:</strong> although the continuous differential equation has a finite solution, the numerical solution grows without bound as the numerical interation proceeds.</p>
<p><strong>ODE:</strong> see <em>ordinary differential equation</em></p>
<p><strong>open domain:</strong> a domain for which the value of one or more dependent variables is unknown on a portion of the boundary of the domain or a domain for which one boundary (say time very large) is not specified.</p>
<p><strong>ordinary differential equation:</strong> a differential equation where the derivatives appear only with respect to one independent variable. Abbreviated ODE.</p>
<p><strong>partial differential equation:</strong> a differential equation where derivatives appear with respect to more than one independent variable. Abbreviated PDE.</p>
<p><strong>PDE:</strong> see <em>partial differential equation</em></p>
<p><strong>second order differential equation:</strong> a differential equation involving only first and second derivatives of the unknown functions.</p>
<p><strong>separation of variables:</strong> a technique whereby a function with several dependent variables is written as a product of several functions, each of which depends on only one of the dependent variables. For example, a function of three unknowns, u(x, y, t), might be written as u(x, y, t) = X(x) · Y (y) · T (t).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../lab2/01-lab2.html" class="btn btn-neutral float-right" title="Stability and accuracy (Jan. 2020)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../notebook_toc.html" class="btn btn-neutral float-left" title="Numeric notebooks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Numeric project

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>