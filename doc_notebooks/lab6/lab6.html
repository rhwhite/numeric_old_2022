

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lab 6: The Lorentz equations &mdash; Numeric course 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Laboratory 7: Solving partial differential equations using an explicit, finite difference method." href="../lab7/01-lab7.html" />
    <link rel="prev" title="Lab 5: Daisyworld" href="../lab5/01-lab5.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Numeric course
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../course_bootstrap.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ugradsyllabus20.html">Undergrad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gradsyllabus20.html">Grad Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule20.html">Detailed Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../texts.html">Optional texts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../notebook_toc.html">Course/lab descriptions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../lab1/01-lab1.html">  Lab 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab2/01-lab2.html">  Lab 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab3/01-lab3.html">  Lab 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab4/01-lab4.html">  Lab 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/01-lab5.html">  Lab 5</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">  Lab 6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#List-of-Problems">List of Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Objectives">Objectives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Readings">Readings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Using-the-Integrator-class">Using the Integrator class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#The-Lorenz-Equations">The Lorenz Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Boundedness-of-the-Solution">Boundedness of the Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Steady-States">Steady States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Linearization-about-the-Steady-States">Linearization about the Steady States</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Stability-of-the-Linearized-Problem">Stability of the Linearized Problem</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Numerical-Integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Other-Chaotic-Systems">Other Chaotic Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#A.-Mathematical-Notes">A. Mathematical Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#A.1-The-Lorenzian-Water-Wheel-Model">A.1 The Lorenzian Water Wheel Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#B.-References">B. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lab7/01-lab7.html">  Lab 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab8/01-lab_8.html">  Lab 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fft_lab.html">  Lab 9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab10/01-lab_10.html">  Lab 10</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../week_notes.html">Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assignments.html">Weekly assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quizzes.html">Quizzes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rubrics.html">Rubrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solutions.html">Solutions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Numeric course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../notebook_toc.html">Numeric notebooks</a> &raquo;</li>
        
      <li>Lab 6: The Lorentz equations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/doc_notebooks/lab6/lab6.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Lab-6:-The-Lorentz-equations">
<h1>Lab 6: The Lorentz equations<a class="headerlink" href="#Lab-6:-The-Lorentz-equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="List-of-Problems">
<h2>List of Problems<a class="headerlink" href="#List-of-Problems" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="#prob_experiment">Problem Experiment: Investigation of the behaviour of solutions</a></p>
<p><a class="reference external" href="#prob_steady-states">Problem Steady-states: Find the stationary points of the Lorenz system</a></p>
<p><a class="reference external" href="#prob_eigenvalues">Problem Eigenvalues: Find the eigenvalues of the stationary point (0,0,0)</a></p>
<p><a class="reference external" href="#prob_stability">Problem Stability: Discuss the effect of r on the stability of the solution</a></p>
<p><a class="reference external" href="#prob_adaptive">Problem Adaptive: Adaptive time-stepping for the Lorenz equations</a></p>
<p><a class="reference external" href="#prob_sensitivity">Problem Sensitivity: Sensitivity to initial conditions</a></p>
<!-- {#lab6:sec:objectives} --><div id="sec_objectives"></div></div>
<div class="section" id="Objectives">
<h2>Objectives<a class="headerlink" href="#Objectives" title="Permalink to this headline">¶</a></h2>
<p>In this lab, you will investigate the transition to chaos in the Lorenz equations – a system of non-linear ordinary differential equations. Using interactive examples, and analytical and numerical techniques, you will determine the stability of the solutions to the system, and discover a rich variety in their behaviour. You will program both an adaptive and non-adaptive Runge-Kuttan code for the problem, and determine the relative merits of each.</p>
<div id="sec_readings"></div></div>
<div class="section" id="Readings">
<h2>Readings<a class="headerlink" href="#Readings" title="Permalink to this headline">¶</a></h2>
<p>There is no required reading for this lab, beyond the contents of the lab itself. Nevertheless, the original 1963 paper by Lorenz  is worthwhile reading from a historical standpoint.</p>
<p>If you would like additional background on any of the following topics, then refer to Appendix B for the following:</p>
<ul class="simple">
<li><p><strong>Easy Reading:</strong></p>
<ul>
<li><p>Gleick  (1987) [pp. 9-31], an interesting overview of the science of chaos (with no mathematical details), and a look at its history.</p></li>
<li><p>Palmer (1993) has a short article on Lorenz’ work and concentrating on its consequences for weather prediction.</p></li>
</ul>
</li>
<li><p><strong>Mathematical Details:</strong></p>
<ul>
<li><p>Sparrow (1982), an in-depth treatment of the mathematics behind the Lorenz equations, including some discussion of numerical methods.</p></li>
<li><p>The original equations by Saltzman (1962) and the first Lorentz (1963) paper on the computation.</p></li>
</ul>
</li>
</ul>
<!-- {#lab6:sec:intro} --><div id="sec_introduction"></div></div>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>For many people working in the physical sciences, the <em>butterfly effect</em> is a well-known phrase. But even if you are unacquainted with the term, its consequences are something you are intimately familiar with. Edward Lorenz investigated the feasibility of performing accurate, long-term weather forecasts, and came to the conclusion that <em>even something as seemingly insignificant as the flap of a butterfly’s wings can have an influence on the weather on the other side of the globe</em>. This implies
that global climate modelers must take into account even the tiniest of variations in weather conditions in order to have even a hope of being accurate. Some of the models used today in weather forecasting have up to <em>a million unknown variables!</em></p>
<p>With the advent of modern computers, many people believed that accurate predictions of systems as complicated as the global weather were possible. Lorenz’ studies (Lorenz, 1963), both analytical and numerical, were concerned with simplified models for the flow of air in the atmosphere. He found that even for systems with considerably fewer variables than the weather, the long-term behaviour of solutions is intrinsically unpredictable. He found that this type of non-periodic, or <em>chaotic</em>
behaviour, appears in systems that are described by non-linear differential equations.</p>
<p>The atmosphere is just one of many hydrodynamical systems, which exhibit a variety of solution behaviour: some flows are steady; others oscillate between two or more states; and still others vary in an irregular or haphazard manner. This last class of behaviour in a fluid is known as <em>turbulence</em>, or in more general systems as <em>chaos</em>. Examples of chaotic behaviour in physical systems include</p>
<ul class="simple">
<li><p>thermal convection in a tank of fluid, driven by a heated plate on the bottom, which displays an irregular patter of “convection rolls” for certain ranges of the temperature gradient;</p></li>
<li><p>a rotating cylinder, filled with fluid, that exhibits regularly-spaced waves or irregular, nonperiodic flow patterns under different conditions;</p></li>
<li><p>the Lorenzian water wheel, a mechanical system, described in <a class="reference external" href="#sec_water-wheel">Appendix A</a>.</p></li>
</ul>
<p>One of the simplest systems to exhibit chaotic behaviour is a system of three ordinary differential equations, studied by Lorenz, and which are now known as the <em>Lorenz equations</em> (see equations (<a class="reference external" href="#eq_lorentz">eq: lorentz</a>). They are an idealization of a more complex hydrodynamical system of twelve equations describing turbulent flow in the atmosphere, but which are still able to capture many of the important aspects of the behaviour of atmospheric flows. The Lorenz equations determine the
evolution of a system described by three time-dependent state variables, <span class="math notranslate nohighlight">\(x(t)\)</span>, <span class="math notranslate nohighlight">\(y(t)\)</span> and <span class="math notranslate nohighlight">\(z(t)\)</span>. The state in Lorenz’ idealized climate at any time, <span class="math notranslate nohighlight">\(t\)</span>, can be given by a single point, <span class="math notranslate nohighlight">\((x,y,z)\)</span>, in <em>phase space</em>. As time varies, this point moves around in the phase space, and traces out a curve, which is also called an <em>orbit</em> or <em>trajectory</em>.</p>
<p>The video below shows an animation of the 3-dimensional phase space trajectories of <span class="math notranslate nohighlight">\(x, y, z\)</span> for the Lorenz equations presented below. It is calculated with the python script by written by Jake VanderPlas: <a class="reference external" href="https://github.com/phaustin/numeric/blob/lab6/lab6/lorenz_ode.py">lorenz_ode.py</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from IPython.display import YouTubeVideo
YouTubeVideo(&#39;DDcCiXLAk2U&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<iframe
    width="400"
    height="300"
    src="https://www.youtube.com/embed/DDcCiXLAk2U"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
<div id="sec_using"></div></div>
<div class="section" id="Using-the-Integrator-class">
<h2>Using the Integrator class<a class="headerlink" href="#Using-the-Integrator-class" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/phaustin/numeric/blob/lab6/lab6/lorenz_ode.py">lorenz_ode.py</a> uses the odeint package from scipy. That’s fine if we are happy with a black box, but we can also use the Integrator class from lab 5. Here is the sub-class Integrator61 that is specified for the Lorenz equations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import context
from numlabs.lab5.lab5_funs import Integrator
from collections import namedtuple
import numpy as np



class Integ61(Integrator):

    def __init__(self, coeff_file_name,initvars=None,uservars=None,
                timevars=None):
        super().__init__(coeff_file_name)
        self.set_yinit(initvars,uservars,timevars)

    def set_yinit(self,initvars,uservars,timevars):
        #
        # read in &#39;sigma beta rho&#39;, override if uservars not None
        #
        if uservars:
            self.config[&#39;uservars&#39;].update(uservars)
        uservars = namedtuple(&#39;uservars&#39;, self.config[&#39;uservars&#39;].keys())
        self.uservars = uservars(**self.config[&#39;uservars&#39;])
        #
        # read in &#39;x y z&#39;
        #
        if initvars:
            self.config[&#39;initvars&#39;].update(initvars)
        initvars = namedtuple(&#39;initvars&#39;, self.config[&#39;initvars&#39;].keys())
        self.initvars = initvars(**self.config[&#39;initvars&#39;])
        #
        # set dt, tstart, tend if overiding base class values
        #
        if timevars:
            self.config[&#39;timevars&#39;].update(timevars)
            timevars = namedtuple(&#39;timevars&#39;, self.config[&#39;timevars&#39;].keys())
            self.timevars = timevars(**self.config[&#39;timevars&#39;])
        self.yinit = np.array(
            [self.initvars.x, self.initvars.y, self.initvars.z])
        self.nvars = len(self.yinit)

    def derivs5(self, coords, t):
        x,y,z = coords
        u=self.uservars
        f=np.empty_like(coords)
        f[0] = u.sigma * (y - x)
        f[1] = x * (u.rho - z) - y
        f[2] = x * y - u.beta * z
        return f
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
******************************
context imported. Front of path:
/Users/phil/repos/numeric
back of path: /Users/phil/.ipython
******************************

through /Users/phil/repos/numeric/notebooks/lab6/context.py
</pre></div></div>
</div>
<p>The main difference with daisyworld is that I’ve changed the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function to take optional arguments to take initvars, uservars and timevars, to give us more flexibility in overriding the default configuration specified in <a class="reference external" href="./lorenz.yaml">lorenz.yaml</a></p>
<p>I also want to be able to plot the trajectories in 3d, which means that I need the Axes3D class from matplotlib. I’ve written a convenience function called plot_3d that sets start and stop points and the viewing angle:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import warnings
warnings.simplefilter(action = &quot;ignore&quot;, category = FutureWarning)
%matplotlib inline
from matplotlib import pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
plt.style.use(&#39;ggplot&#39;)

def plot_3d(ax,xvals,vals,zvals):
    &quot;&quot;&quot;
        plot a 3-d trajectory with start and stop markers
    &quot;&quot;&quot;
    line,=ax.plot(xvals,yvals,zvals,&#39;r-&#39;)
    ax.set_xlim((-20, 20))
    ax.set_ylim((-30, 30))
    ax.set_zlim((5, 55))
    ax.grid(True)
    #
    # look down from 30 degree elevation and an azimuth of
    #
    ax.view_init(30,5)
    line,=ax.plot(xvals,yvals,zvals,&#39;r-&#39;)
    ax.plot([-20,15],[-30,-30],[0,0],&#39;k-&#39;)
    ax.scatter(xvals[0],yvals[0],zvals[0],marker=&#39;o&#39;,c=&#39;green&#39;,s=75)
    ax.scatter(xvals[-1],yvals[-1],zvals[-1],marker=&#39;^&#39;,c=&#39;blue&#39;,s=75)
    out=ax.set(xlabel=&#39;x&#39;,ylabel=&#39;y&#39;,zlabel=&#39;z&#39;)
    line.set(alpha=0.2)
    return ax


</pre></div>
</div>
</div>
<p>In the code below I set timevars, uservars and initvars to illustrate a sample orbit in phase space (with initial value <span class="math notranslate nohighlight">\((5,5,5)\)</span>). Notice that the orbit appears to be lying in a surface composed of two “wings”. In fact, for the parameter values used here, all orbits, no matter the initial conditions, are eventually attracted to this surface; such a surface is called an <em>attractor</em>, and this specific one is termed the <em>butterfly attractor</em> … a very fitting name, both for its appearance,
and for the fact that it is a visualization of solutions that exhibit the “butterfly effect.” The individual variables are plotted versus time in <a class="reference external" href="#fig_xyz-vs-t">Figure xyz-vs-t</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>#
# make a nested dictionary to hold parameters
#
timevars=dict(tstart=0,tend=27,dt=0.01)
uservars=dict(sigma=10,beta=2.6666,rho=28)
initvars=dict(x=5,y=5,z=5)
params=dict(timevars=timevars,uservars=uservars,initvars=initvars)
#
# expand the params dictionary into key,value pairs for
# the Integ61 constructor using dictionary expansion
#
theSolver = Integ61(&#39;lorenz.yaml&#39;,**params)
timevals, coords, errorlist = theSolver.timeloop5fixed()
xvals,yvals,zvals=coords[:,0],coords[:,1],coords[:,2]


fig = plt.figure(figsize=(6,6))
ax = fig.add_axes([0, 0, 1, 1], projection=&#39;3d&#39;)
ax=plot_3d(ax,xvals,yvals,zvals)
out=ax.set(title=&#39;starting point: {},{},{}&#39;.format(*coords[0,:]))
#help(ax.view_init)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab6_lab6_11_0.png" src="../../_images/doc_notebooks_lab6_lab6_11_0.png" />
</div>
</div>
<!-- ="lab6:fig:fixed-plot" --><p>A plot of the solution to the Lorenz equations as an orbit in phase space. Parameters: <span class="math notranslate nohighlight">\(\sigma=10\)</span>, <span class="math notranslate nohighlight">\(\beta=\frac{8}{3}\)</span>, <span class="math notranslate nohighlight">\(\rho=28\)</span>; initial values: <span class="math notranslate nohighlight">\((x,y,z)=(5,5,5)\)</span>.</p>
<div id="fig_xyz-vs-t"></div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>fig,ax = plt.subplots(1,1,figsize=(8,6))
ax.plot(timevals,xvals,label=&#39;x&#39;)
ax.plot(timevals,yvals,label=&#39;y&#39;)
ax.plot(timevals,zvals,label=&#39;z&#39;)
ax.set(title=&#39;x, y, z for trajectory&#39;,xlabel=&#39;time&#39;)
out=ax.legend()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab6_lab6_14_0.png" src="../../_images/doc_notebooks_lab6_lab6_14_0.png" />
</div>
</div>
<!-- data-label="lab6:fig:xyz-vs-t"> --><p><strong>Figure xyz-vs-t</strong>: A plot of the solution to the Lorenz equations versus time. Parameters: <span class="math notranslate nohighlight">\(\sigma=10\)</span>, <span class="math notranslate nohighlight">\(\beta=\frac{8}{3}\)</span>, <span class="math notranslate nohighlight">\(\rho=28\)</span>; initial values: <span class="math notranslate nohighlight">\((x,y,z)=(5,5,5)\)</span>.</p>
<p>As you saw in the movie, the behaviour of the solution, even though it seems to be confined to a specific surface, is anything but regular. The solution seems to loop around and around forever, oscillating around one of the wings, and then jump over to the other one, with no apparent pattern to the number of revolutions. This example is computed for just one choice of parameter values, and you will see in the problems later on in this lab, that there are many other types of solution behaviour.
In fact, there are several very important characteristics of the solution to the Lorenz equations which parallel what happens in much more complicated systems such as the atmosphere:</p>
<ol class="arabic simple">
<li><p>The solution remains within a bounded region (that is, none of the values of the solution “blow up”), which means that the solution will always be physically reasonable.</p></li>
<li><p>The solution flips back and forth between the two wings of the butterfly diagram, with no apparent pattern. This “strange” way that the solution is attracted towards the wings gives rise to the name <em>strange attractor</em>.</p></li>
<li><p>The resulting solution depends very heavily on the given initial conditions. Even a very tiny change in one of the initial values can lead to a solution which follows a totally different trajectory, if the system is integrated over a long enough time interval.</p></li>
<li><p>The solution is irregular or <em>chaotic</em>, meaning that it is impossible, based on parameter values and initial conditions (which may contain small measurement errors), to predict the solution at any future time.</p></li>
</ol>
<!-- {#lab6:sec:equations} --><div id="sec_lorenz"></div></div>
<div class="section" id="The-Lorenz-Equations">
<h2>The Lorenz Equations<a class="headerlink" href="#The-Lorenz-Equations" title="Permalink to this headline">¶</a></h2>
<p>As mentioned in the previous section, the equations we will be considering in this lab model an idealized hydrodynamical system: two-dimensional convection in a tank of water which is heated at the bottom (as pictured in <a class="reference external" href="#fig_convection">Figure Convection</a> below).</p>
<div id="fig_convection"></div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from IPython.display import Image
Image(filename=&quot;images/convection.png&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab6_lab6_18_0.png" src="../../_images/doc_notebooks_lab6_lab6_18_0.png" />
</div>
</div>
<p><strong>Figure Convection</strong> Lorenz studied the flow of fluid in a tank heated at the bottom, which results in “convection rolls”, where the warm fluid rises, and the cold fluid is drops to the bottom.</p>
<p>Lorenz wrote the equations in the form</p>
<!-- \label{lab6:eq:lorenz} --><div id="eq_lorenz"></div><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \frac{dx}{dt} &amp;=&amp; \sigma(y-x)  \\
  \frac{dy}{dt} &amp;=&amp; \rho x-y-xz  \\
  \frac{dz}{dt} &amp;=&amp; xy-\beta z
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are real, positive parameters. The variables in the problem can be interpreted as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is proportional to the intensity of the convective motion (positive for clockwise motion, and a larger magnitude indicating more vigorous circulation),</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span> is proportional to the temperature difference between the ascending and descending currents (it’s positive if the warm water is on the bottom),</p></li>
<li><p><span class="math notranslate nohighlight">\(z\)</span> is proportional to the distortion of the vertical temperature profile from linearity (a value of 0 corresponds to a linear gradient in temperature, while a positive value indicates that the temperature is more uniformly mixed in the middle of the tank and the strongest gradients occur near the boundaries),</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span> is the dimensionless time,</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> is called the Prandtl number (it involves the viscosity and thermal conductivity of the fluid),</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho\)</span> is a control parameter, representing the temperature difference between the top and bottom of the tank, and</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> measures the width-to-height ratio of the convection layer.</p></li>
</ul>
<p>Notice that these equations are <em>non-linear</em> in <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>, which is a result of the non-linearity of the fluid flow equations from which this simplified system is obtained.</p>
<p><strong>Mathematical Note</strong>: This system of equations is derived by Saltzman (1962) for the thermal convection problem. However, the same equations (<a class="reference external" href="#eq_lorenz">eq:lorenz</a>) arise in other physical systems as well. One example is the whose advantage over the original derivation by Saltzman (which is also used in Lorenz’ 1963 paper ) is that the system of ODEs is obtained <em>directly from the physics</em>, rather than as an approximation to a partial differential equation.</p>
<p>Remember from Section [lab6:sec:intro] that the Lorenz equations exhibit nonperiodic solutions which behave in a chaotic manner. Using analytical techniques, it is actually possible to make some qualitative predictions about the behaviour of the solution before doing any computations. However, before we move on to a discussion of the stability of the problem in Section [lab6:sec:stability], you should do the following exercise, which will give you a hands-on introduction to the behaviour of
solutions to the Lorenz equations.</p>
<div id="prob_experiment"></div><p><a class="reference external" href="#prob_experiment">Problem Experiment</a> Lorenz’ results are based on the following values of the physical parameters taken from Saltzman’s paper (Saltzman, 1962):</p>
<div class="math notranslate nohighlight">
\[\sigma=10 \quad \mathrm{and} \quad b=\frac{8}{3}.\]</div>
<p>As you will see in <a class="reference external" href="#sec_stability">Section stability</a>, there is a <em>critical value of the parameter :math:`rho`</em>, <span class="math notranslate nohighlight">\(\rho^\ast=470/19\approx 24.74\)</span> (for these values of <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>); it is <em>critical</em> in the sense that for any value of <span class="math notranslate nohighlight">\(\rho&gt;\rho^\ast\)</span>, the flow is unstable.</p>
<p>To allow you to investigate the behaviour of the solution to the Lorenz equations, you can try out various parameter values in the following interactive example. <em>Initially, leave :math:`sigma` and :math:`beta` alone, and modify only :math:`rho` and the initial conditions.</em> If you have time, you can try varying the other two parameters, and see what happens. Here are some suggestions:</p>
<ul class="simple">
<li><p>Fix the initial conditions at <span class="math notranslate nohighlight">\((5,5,5)\)</span> and vary <span class="math notranslate nohighlight">\(\rho\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(100\)</span>.</p></li>
<li><p>Fix <span class="math notranslate nohighlight">\(\rho=28\)</span>, and vary the initial conditions; for example, try <span class="math notranslate nohighlight">\((0,0,0)\)</span>, <span class="math notranslate nohighlight">\((0.1,0.1,0.1)\)</span>, <span class="math notranslate nohighlight">\((0,0,20)\)</span>, <span class="math notranslate nohighlight">\((100,100,100)\)</span>, <span class="math notranslate nohighlight">\((8.5,8.5,27)\)</span>, etc.</p></li>
<li><p>Anything else you can think of …</p></li>
</ul>
<ol class="arabic simple">
<li><p>Describe the different types of behaviour you see and compare them to what you saw in <a class="reference external" href="#fig_fixed-plot">Figure fixed-plot</a>. Also, discuss the results in terms of what you read in <a class="reference external" href="#sec_introduction">Section Introduction</a> regarding the four properties of the solution.</p></li>
<li><p>One question you should be sure to ask yourself is: <em>Does changing the initial condition affect where the solution ends up?</em> The answer to this question will indicate whether there really is an attractor which solutions approach as <span class="math notranslate nohighlight">\(t\rightarrow\infty\)</span>.</p></li>
<li><p>Finally, for the different types of solution behaviour, can you interpret the results physically in terms of the thermal convection problem?</p></li>
</ol>
<p>Now, we’re ready to find out why the solution behaves as it does. In <a class="reference external" href="#sec_introduction">Section Intro</a>, you were told about four properties of solutions to the Lorenz equations that are also exhibited by the atmosphere, and in the problem you just worked though, you saw that these were also exhibited by solutions to the Lorenz equations. In the remainder of this section, you will see mathematical reasons for two of those characteristics, namely the boundedness and stability (or instability)
of solutions.</p>
<div id="sec_boundedness"></div></div>
<div class="section" id="Boundedness-of-the-Solution">
<h2>Boundedness of the Solution<a class="headerlink" href="#Boundedness-of-the-Solution" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to see that the solution is bounded in time is by looking at the motion of the solution in phase space, <span class="math notranslate nohighlight">\((x,y,z)\)</span>, as the flow of a fluid, with velocity <span class="math notranslate nohighlight">\((\dot{x}, \dot{y}, \dot{z})\)</span> (the “dot” is used to represent a time derivative, in order to simplify notation in what follows). The <em>divergence of this flow</em> is given by</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \dot{x}}{\partial x} +
  \frac{\partial \dot{y}}{\partial y} +
  \frac{\partial \dot{z}}{\partial z},\]</div>
<p>and measures how the volume of a fluid particle or parcel changes – a positive divergence means that the fluid volume is increasing locally, and a negative volume means that the fluid volume is shrinking locally (zero divergence signifies an <em>incompressible fluid</em>, which you will see more of in and ). If you look back to the Lorenz equations (<a class="reference external" href="#eq_lorenz">eq:lorenz</a>), and take partial derivatives, it is clear that the divergence of this flow is given by</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \dot{x}}{\partial x} +
\frac{\partial \dot{y}}{\partial y} +
\frac{\partial \dot{z}}{\partial z} = -(\sigma + b + 1).\]</div>
<p>Since <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are both positive, real constants, the divergence is a negative number, which is always less than <span class="math notranslate nohighlight">\(-1\)</span>. Therefore, each small volume shrinks to zero as the time <span class="math notranslate nohighlight">\(t\rightarrow\infty\)</span>, at a rate which is independent of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>. The consequence for the solution, <span class="math notranslate nohighlight">\((x,y,z)\)</span>, is that every trajectory in phase space is eventually confined to a region of zero volume. As you saw in <a class="reference external" href="#prob_experiment">Problem experiment</a>,
this region, or <em>attractor</em>, need not be a point – in fact, the two wings of the “butterfly diagram” are a surface with zero volume.</p>
<p>The most important consequence of the solution being bounded is that none of the physical variables, <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, or <span class="math notranslate nohighlight">\(z\)</span> “blows up.” Consequently, we can expect that the solution will remain with physically reasonable limits.</p>
<!-- {#lab6:sec:steady-states} --><div id="sec_steady"></div></div>
<div class="section" id="Steady-States">
<h2>Steady States<a class="headerlink" href="#Steady-States" title="Permalink to this headline">¶</a></h2>
<p>A <em>steady state</em> of a system is a point in phase space from which the system will not change in time, once that state has been reached. In other words, it is a point, <span class="math notranslate nohighlight">\((x,y,z)\)</span>, such that the solution does not change, or where</p>
<div class="math notranslate nohighlight">
\[\frac{dx}{dt} = 0  \quad\  \mathrm{and}\ \quad \frac{dy}{dt} = 0 \quad
  \ \mathrm{and}\ \quad \frac{dz}{dt} = 0.\]</div>
<p>This point is usually referred to as a <em>stationary point</em> of the system.</p>
<div id="prob_steady-states"></div><p><a class="reference external" href="#prob_steady-states">Problem steady-states</a> Set the time derivatives equal to zero in the Lorenz equations (<a class="reference external" href="#eq_lorenz">eq:lorenz</a>), and solve the resulting system to show that there are three possible steady states, namely the points</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((0,0,0)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\((\sqrt{\beta(\rho-1)},\sqrt{\beta(\rho -1)},\rho -1)\)</span>, and</p></li>
<li><p><span class="math notranslate nohighlight">\((-\sqrt{\beta (\rho -1)},-\sqrt{\beta(\rho-1)},\rho-1)\)</span>.</p></li>
</ul>
<p>Remember that <span class="math notranslate nohighlight">\(\rho\)</span> is a positive real number, so that that there is <em>only one</em> stationary point when <span class="math notranslate nohighlight">\(0\leq \rho \leq 1\)</span>, but all three stationary points are present when <span class="math notranslate nohighlight">\(\rho &gt;1\)</span>.</p>
<p>While working through <a class="reference external" href="#prob_experiment">Problem experiment</a>, did you notice the change in behaviour of the solution as <span class="math notranslate nohighlight">\(\rho\)</span> passes through the value 1? If not, then go back to the interactive example and try out some values of <span class="math notranslate nohighlight">\(\rho\)</span> both less than and greater than 1 to see how the solution changes.</p>
<p>A steady state tells us the behaviour of the solution only at a single point. <em>But what happens to the solution if it is perturbed slightly away from a stationary point? Will it return to the stationary point; or will it tend to move away from the point; or will it oscillate about the steady state; or something else … ?</em> All of these questions are related to the long-term, <em>asymptotic</em> behaviour or <em>stability</em> of the solution near a given point. You already should have seen some examples of
different asymptotic solution behaviour in the Lorenz equations for different parameter values. The next section describes a general method for determining the stability of a solution near a given stationary point.</p>
<!-- {#lab6:sec:linearization} --><div id="sec_linearization"></div></div>
<div class="section" id="Linearization-about-the-Steady-States">
<h2>Linearization about the Steady States<a class="headerlink" href="#Linearization-about-the-Steady-States" title="Permalink to this headline">¶</a></h2>
<p>The difficult part of doing any theoretical analysis of the Lorenz equations is that they are <em>non-linear</em>. <em>So, why not approximate the non-linear problem by a linear one?</em></p>
<p>This idea should remind you of what you read about Taylor series in Lab #2. There, we were approximating a function, <span class="math notranslate nohighlight">\(f(x)\)</span>, around a point by expanding the function in a Taylor series, and the first order Taylor approximation was simply a linear function in <span class="math notranslate nohighlight">\(x\)</span>. The approach we will take here is similar, but will get into Taylor series of functions of more than one variable: <span class="math notranslate nohighlight">\(f(x,y,z,\dots)\)</span>.</p>
<p>The basic idea is to replace the right hand side functions in (<a class="reference external" href="#eq_lorenz">eq:lorenz</a>) with a linear approximation about a stationary point, and then solve the resulting system of <em>linear ODE’s</em>. Hopefully, we can then say something about the non-linear system at values of the solution <em>close to the stationary point</em> (remember that the Taylor series is only accurate close to the point we’re expanding about).</p>
<p>So, let us first consider the stationary point <span class="math notranslate nohighlight">\((0,0,0)\)</span>. If we linearize a function <span class="math notranslate nohighlight">\(f(x,y,z)\)</span> about <span class="math notranslate nohighlight">\((0,0,0)\)</span> we obtain the approximation:</p>
<div class="math notranslate nohighlight">
\[f(x,y,z) \approx f(0,0,0) + f_x(0,0,0) \cdot (x-0) +
f_y(0,0,0) \cdot (y-0) + f_z(0,0,0) \cdot (z-0).\]</div>
<p>If we apply this formula to the right hand side function for each of the ODE’s in (<a class="reference external" href="#eq_lorenz">eq: lorenz</a>), then we obtain the following linearized system about <span class="math notranslate nohighlight">\((0,0,0)\)</span>:</p>
<!-- \label{lab6:eq:lorenz-linear0} --><div id="eq_lorenz_linear"></div><p>(note that each right hand side is now a linear function of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>). It is helpful to write this system in matrix form as</p>
<!--   \label{lab6:eq:lorenz-linear0-matrix} --><div id="eq_lorenz_linear_matrix"></div><p>the reason for this being that the <em>eigenvalues</em> of the matrix give us valuable information about the solution to the linear system. In fact, it is a well-known result from the study of dynamical systems is that if the matrix in (<span class="math">\ref{eq:lorenz_linear_matrix}</span>) has <em>distinct</em> eigenvalues <span class="math notranslate nohighlight">\(\lambda_1\)</span>, <span class="math notranslate nohighlight">\(\lambda_2\)</span> and <span class="math notranslate nohighlight">\(\lambda_3\)</span>, then the solution to this equation is given by</p>
<!-- \label{lab6:eq:xsolution}$$  --><div class="math notranslate nohighlight">
\[x(t) = c_1 e^{\lambda_1 t} + c_2 e^{\lambda_2 t} + c_3 e^{\lambda_3 t},\]</div>
<p>and similarly for the other two solution components, <span class="math notranslate nohighlight">\(y(t)\)</span> and <span class="math notranslate nohighlight">\(z(t)\)</span> (the <span class="math notranslate nohighlight">\(c_i\)</span>’s are constants that are determined by the initial conditions of the problem). This should not seem too surprising, if you think that the solution to the scalar equation <span class="math notranslate nohighlight">\(dx/dt=\lambda x\)</span> is <span class="math notranslate nohighlight">\(x(t) = e^{\lambda t}\)</span>.</p>
<div id="prob_eigenvalues"></div><p><strong>Problem eigenvalues:</strong> Remember from Lab #3 that the eigenvalues of a matrix, <span class="math notranslate nohighlight">\(A\)</span>, are given by the roots of the characteristic equation, <span class="math notranslate nohighlight">\(det(A-\lambda I)=0\)</span>. Determine the characteristic equation of the matrix in (<span class="math">\ref{eq:lorenz_linear_matrix}</span>), and show that the eigenvalues of the linearized problem are</p>
<div id="eq_eigen0"></div><p><span class="math">\begin{equation}
\label{eq:eig0}
\lambda_1 = -\beta, \quad \mathrm{and} \quad \lambda_2, \lambda_3 =
\frac{1}{2} \left( -\sigma - 1 \pm  \sqrt{(\sigma-1)^2 + 4 \sigma \rho}
\right).
\end{equation}</span></p>
<p>When <span class="math notranslate nohighlight">\(\rho&gt;1\)</span>, the same linearization process can be applied at the remaining two stationary points, which have eigenvalues that satisfy another characteristic equation:</p>
<!-- \label{lab6:eq:char12} --><p><span class="math">\begin{equation}
\label{eq:eig12}
\lambda^3+(\sigma+\beta +1)\lambda^2+(\rho+\sigma)\beta \lambda+2\sigma  \beta(\rho-1)=0.
\end{equation}</span></p>
<p>A reminder that we talked about odes and eigenvalues in the <a class="reference external" href="https://phaustin.github.io/numeric/week_notes.html">Week6 section here</a></p>
<!--  {#lab6:sec:stability} --><div id="sec_stability"></div><div class="section" id="Stability-of-the-Linearized-Problem">
<h3>Stability of the Linearized Problem<a class="headerlink" href="#Stability-of-the-Linearized-Problem" title="Permalink to this headline">¶</a></h3>
<p>Now that we know the eigenvalues of the system around each stationary point, we can write down the solution to the linearized problem. However, it is not the exact form of the linearized solution that we’re interested in, but rather its <em>stability</em>. In fact, the eigenvalues give us all the information we need to know about how the linearized solution behaves in time, and so we’ll only talk about the eigenvalues from now on.</p>
<p>It is possible that two of the eigenvalues in the characteristic equations above can be complex numbers – <em>what does this mean for the solution?</em> The details are a bit involved, but the important thing to realize is that if <span class="math notranslate nohighlight">\(\lambda_2,\lambda_3=a\pm i\beta\)</span> are complex (remember that complex roots always occur in conjugate pairs) then the solutions can be rearranged so that they are of the form</p>
<!-- \label{lab6:eq:xsolution2} --><div class="math notranslate nohighlight">
\[x(t) = c_1 e^{\lambda_1 t} + c_2 e^{a t} \cos(bt) + c_3 e^{a t}
  \sin(bt).\]</div>
<p>In terms of the asymptotic stability of the problem, we need to look at the asymptotic behaviour of the solution as <span class="math notranslate nohighlight">\(t\rightarrow \infty\)</span>, from which several conclusions can be drawn:</p>
<ol class="arabic simple">
<li><p>If the eigenvalues are <em>real and negative</em>, then the solution will go to zero as <span class="math notranslate nohighlight">\(t \rightarrow\infty\)</span>. In this case the linearized solution is <em>stable</em>.</p></li>
<li><p>If the eigenvalues are real, and <em>at least one</em> is positive, then the solution will blow up as <span class="math notranslate nohighlight">\(t \rightarrow\infty\)</span>. In this case the linearized solution is <em>unstable</em>.</p></li>
<li><p>If there is a complex conjugate pair of eigenvalues, <span class="math notranslate nohighlight">\(a\pm ib\)</span>, then the solution exhibits oscillatory behaviour (with the appearance of the terms <span class="math notranslate nohighlight">\(\sin{bt}\)</span> and <span class="math notranslate nohighlight">\(\cos{bt}\)</span>). If the real part, <span class="math notranslate nohighlight">\(a\)</span>, of all eigenvalues is negative, the oscillations will decay in time and the solution is <em>stable</em>; if the real part is positive, then the oscillations will grow, and the solution is <em>unstable</em>. If the complex eigenvalues have zero real part, then the oscillations will neither
decay nor increase in time – the resulting linearized problem is periodic, and we say the solution is <em>marginally stable</em>.</p></li>
</ol>
<p>Now, an important question:</p>
<p><em>Does the stability of the non-linear system parallel that of the linearized systems near the stationary points?</em></p>
<p>The answer is “almost always”. We won’t go into why, or why not, but just remember that you can usually expect the non-linear system to behave just as the linearized system near the stationary states.</p>
<p>The discussion of stability of the stationary points for the Lorenz equations will be divided up based on values of the parameter <span class="math notranslate nohighlight">\(\rho\)</span> (assuming <span class="math notranslate nohighlight">\(\sigma=10\)</span> and <span class="math notranslate nohighlight">\(\beta=\frac{8}{3}\)</span>). You’ve already seen that the behaviour of the solution changes significantly, by the appearance of two additional stationary points, when <span class="math notranslate nohighlight">\(r\)</span> passes through the value 1. You’ll also see an explanation for the rest of the behaviour you observed:</p>
<p><span class="math notranslate nohighlight">\(0&lt;\rho&lt;1\)</span>:</p>
<ul class="simple">
<li><p>there is only one stationary state, namely the point <span class="math notranslate nohighlight">\((0,0,0)\)</span>. You can see from (<span class="math">\ref{eq:eig0}</span>) that for these values of <span class="math notranslate nohighlight">\(\rho\)</span>, there are three, real, negative roots. The origin is a <em>stable</em> stationary point; that is, it attracts nearby solutions to itself.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\rho&gt;1\)</span>:</p>
<ul class="simple">
<li><p>The origin has one positive, and two negative, real eigenvalues. Hence, the origin is <em>unstable</em>. Now, we need only look at the other two stationary points, whose behaviour is governed by the roots of (<span class="math">\ref{eq:eig12}</span>)</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(1&lt;\rho&lt;\frac{470}{19}\)</span>:</p>
<ul>
<li><p>The other two stationary points have eigenvalues that have negative real parts. So these two points are <em>stable</em>.</p>
<p>It’s also possible to show that two of these eigenvalues are real when <span class="math notranslate nohighlight">\(\rho&lt;1.346\)</span>, and they are complex otherwise (see Sparrow 1982 for a more complete discussion). Therefore, the solution begins to exhibit oscillatory behaviour beyond a value of <span class="math notranslate nohighlight">\(\rho\)</span> greater than 1.346.</p>
</li>
</ul>
<p><span class="math notranslate nohighlight">\(\rho&gt;\frac{470}{19}\)</span>:</p>
<ul class="simple">
<li><p>The other two stationary points have one real, negative eigenvalue, and two complex eigenvalues with positive real part. Therefore, these two points are <em>unstable</em>. In fact, all three stationary points are unstable for these values of <span class="math notranslate nohighlight">\(\rho\)</span>.</p></li>
</ul>
<p>The stability of the stationary points is summarized in table below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 8%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>(0,0,0)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\((\pm\sqrt{\beta(\rho-1)},\pm\sqrt{\beta(\rho-1)},\beta-1)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(0&lt;\rho&lt;1\)</span></p></td>
<td><p>stable</p></td>
<td><p><span class="math notranslate nohighlight">\(-\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(1&lt;\rho&lt;\frac{470}{19}\)</span></p></td>
<td><p>unstable</p></td>
<td><p>stable</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho&gt;\frac{470}{19}\)</span></p></td>
<td><p>unstable</p></td>
<td><p>unstable</p></td>
</tr>
</tbody>
</table>
<!--   data-label="lab6:tab:stability"> --><ul class="simple">
<li><p>Summary of the stability of the stationary points for the Lorenz equations; parameters <span class="math notranslate nohighlight">\(\sigma=10\)</span>, <span class="math notranslate nohighlight">\(\beta=\frac{8}{3}\)</span></p></li>
</ul>
<p>This “critical value” of <span class="math notranslate nohighlight">\(\rho^\ast= \frac{470}{19}\)</span> is actually found using the formula</p>
<div class="math notranslate nohighlight">
\[\rho^\ast= \frac{\sigma(\sigma+\beta+3)}{\sigma-\beta-1}.\]</div>
<p>See Sparrow (1982) for more details.</p>
<p>A qualitative change in behaviour of in the solution when a parameter is varied is called a <em>bifurcation</em>. Bifurcations occur at:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho=1\)</span>, when the origin switches from stable to unstable, and two more stationary points appear.</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho=\rho^\ast\)</span>, where the remaining two stationary points switch from being stable to unstable.</p></li>
</ul>
<p>Remember that the linear results apply only near the stationary points, and do not apply to all of the phase space. Nevertheless, the behaviour of the orbits near these points can still say quite a lot about the behaviour of the solutions.</p>
<div id="prob_stability"></div><p><strong>Problem Stability</strong> Based on the analytical results from this section, you can now go back to your results from <a class="reference external" href="#prob_experiment">Problem Experiment</a> and look at them in a new light. Write a short summary of your results (including a few plots or sketches), describing how the solution changes with <span class="math notranslate nohighlight">\(\rho\)</span> in terms of the existence and stability of the stationary points.</p>
<p>There have already been hints at problems with the linear stability analysis. One difficulty that hasn’t been mentioned yet is that for values of <span class="math notranslate nohighlight">\(\rho&gt;\rho^\ast\)</span>, the problem has oscillatory solutions, which are unstable. <em>Linear theory does not reveal what happens when these oscillations become large!</em> In order to study more closely the long-time behaviour of the solution, we must turn to numerical integration (in fact, all of the plots you produced in Problem [lab6:prob:experiment] were
generated using a numerical code).</p>
<!-- {#lab6:sec:numeric} --><div id="sec_numerical"></div></div>
</div>
<div class="section" id="Numerical-Integration">
<h2>Numerical Integration<a class="headerlink" href="#Numerical-Integration" title="Permalink to this headline">¶</a></h2>
<p>In Lorenz’ original paper, he discusses the application of the forward Euler and leap frog time-stepping schemes, but his actual computations are done using the second order <em>Heun’s method</em> (you were introduced to this method in Lab #4. Since we already have a lot of experience with Runge-Kutta methods for systems of ODE’s from earlier labs, you’ll be using this approach to solve the Lorenz equations as well. You already have a code from that solves the Daisy World equations, so you can jump
right into the programming for the Lorenz equations with the following exercises …</p>
<div id="prob_adaptive"></div><p><strong>Problem Adaptive:</strong> You saw in that adaptive time-stepping saved a considerable amount of computing time for the Daisy World problem. In this problem, you will be investigating whether or not an adaptive Runge-Kutta code is the best choice for the Lorenz equations.</p>
<p>Use the Integrator61 object to compute in both adaptive and fixed timeloop solutions for an extended integration. Compare the number of time steps taken (plot the time step vs. the integration time for both methods). Which method is more efficient? Which is fastest? A simple way to time a portion of a script is to use the <code class="docutils literal notranslate"><span class="pre">time</span></code> module to calculate the elapsed time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1">##program here</span>
<span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tic</span>
</pre></div>
</div>
<p>To answer this last question, you will have to consider the cost of the adaptive scheme, compared to the non-adaptive one. The adaptive scheme is obviously more expensive, but by how much? You should think in terms of the number of multiplicative operations that are required in every time step for each method. You don’t have to give an exact operation count, round figures will do.</p>
<p>Finally, we mentioned that the code that produced the animation uses a C module called odeint. It is called <a class="reference external" href="https://github.com/phaustin/numeric/blob/lab6/lab6/lorenz_ode.py#L22-L23">here</a> using derivatives defined in <a class="reference external" href="https://github.com/phaustin/numeric/blob/lab6/lab6/lorenz_ode.py#L11-L14">lorenz_deriv</a>. Use odeint to solve the same problem you did for the fixed and adaptive timeloops. What is the speed increase you see by using the compiled module?</p>
<div id="prob_sensitivity"></div><p><strong>Problem Sensitivity</strong>: One property of chaotic systems such as the Lorenz equations is their <em>sensitivity to initial conditions</em> – a consequence of the “butterfly effect.” Modify your code from <a class="reference external" href="#prob_adaptive">Problem adaptive</a> to compute two trajectories (in the chaotic regime <span class="math notranslate nohighlight">\(r&gt;r^\ast\)</span>) with different initial conditions <em>simultaneously</em>. Use two initial conditions that are very close to each other, say <span class="math notranslate nohighlight">\((1,1,20)\)</span> and <span class="math notranslate nohighlight">\((1,1,20.001)\)</span>. Use your “method of choice”
(adaptive/non-adaptive), and plot the distance between the two trajectories as a function of time. What do you see?</p>
<p>One important limitation of numerical methods is immediately evident when approximating non-periodic dynamical systems such as the Lorenz equations: namely, <em>every computed solution is periodic</em>. That is, when we’re working in floating point arithmetic, there are only finitely many numbers that can be represented, and the solution must eventually repeat itself. When using single precision arithmetic, a typical computer can represent many more floating point numbers than we could ever perform
integration steps in a numerical scheme. However, it is still possible that round-off error might introduce a periodic orbit in the numerical solution where one does not really exist. In our computations, this will not be a factor, but it is something to keep in mind.</p>
<div id="sec_other"></div></div>
<div class="section" id="Other-Chaotic-Systems">
<h2>Other Chaotic Systems<a class="headerlink" href="#Other-Chaotic-Systems" title="Permalink to this headline">¶</a></h2>
<p>There are many other ODE systems that exhibit chaos. An example is one studied by Rössler, which obeys a similar-looking system of three ODE’s:</p>
<!-- \label{lab6:eq:rossler} --><div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \dot{x}&amp;=&amp;-y-z  \\
  \dot{y}&amp;=&amp;x+ay  \\
  \dot{z}&amp;=&amp;b+z(x-c)
  \end{aligned}\end{split}\]</div>
<p>Suppose that <span class="math notranslate nohighlight">\(b=2\)</span>, <span class="math notranslate nohighlight">\(c=4\)</span>, and consider the behaviour of the attractor as <span class="math notranslate nohighlight">\(a\)</span> is varied. When <span class="math notranslate nohighlight">\(a\)</span> is small, the attractor is a simple closed curve. As <span class="math notranslate nohighlight">\(a\)</span> is increased, however, this splits into a double loop, then a quadruple loop, and so on. Thus, a type of <em>period-doubling</em> takes place, and when <span class="math notranslate nohighlight">\(a\)</span> reaches about 0.375, there is a fractal attractor in the form of a band, that looks something like what is known in mathematical circles as a <em>Möbius strip</em>.</p>
<p>If you’re really keen on this topic, you might be interested in using your code to investigate the behaviour of this system of equations, <em>though you are not required to hand anything in for this!</em></p>
<p>First, you could perform a stability analysis for ([lab6:eq:rossler]), like you saw above for the Lorenz equations. Then, modify your code to study the Rössler attractor. Use the code to compare your analytical stability results to what you actually see in the computations.</p>
<!-- {#lab6:sec:summary} --><div id="sec_summary"></div></div>
<div class="section" id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h2>
<p>In this lab, you have had the chance to investigate the solutions to the Lorenz equations and their stability in quite some detail. You saw that for certain parameter values, the solution exhibits non-periodic, chaotic behaviour. The question to ask ourselves now is: <em>What does this system tell us about the dynamics of flows in the atmosphere?</em> In fact, this system has been simplified so much that it is no longer an accurate model of the physics in the atmosphere. However, we have seen that the
four characteristics of flows in the atmosphere (mentioned in <a class="reference external" href="#sec_intro">the Introduction</a> are also present in the Lorenz equations.</p>
<p>Each state in Lorenz’ idealized “climate” is represented by a single point in phase space. For a given set of initial conditions, the evolution of a trajectory describes how the weather varies in time. The butterfly attractor embodies all possible weather conditions that can be attained in the Lorenzian climate. By changing the value of the parameter <span class="math notranslate nohighlight">\(\rho\)</span> (and, for that matter, <span class="math notranslate nohighlight">\(\sigma\)</span> or <span class="math notranslate nohighlight">\(\beta\)</span>), the shape of the attractor changes. Physically, we can interpret this as a
change in some global property of the weather system resulting in a modification of the possible weather states.</p>
<p>The same methods of analysis can be applied to more complicated models of the weather. One can imagine a model where the depletion of ozone and the increased concentration of greenhouse gases in the atmosphere might be represented by certain parameters. Changes in these parameters result in changes in the shape of the global climate attractor for the system. By studying the attractor, we could determine whether any new, and possibly devastating, weather states are present in this new
ozone-deficient atmosphere.</p>
<p>We began by saying in the Introduction that the butterfly effect made accurate long-term forecasting impossible. Nevertheless, it is still possible to derive meaningful qualitative information from such a chaotic dynamical system.</p>
<!-- {#lab6:ap:mathnote} --><div id="sec_mathematical"></div></div>
<div class="section" id="A.-Mathematical-Notes">
<h2>A. Mathematical Notes<a class="headerlink" href="#A.-Mathematical-Notes" title="Permalink to this headline">¶</a></h2>
<!--  {#lab6:ap:water-wheel} --><div id="sec_lorenzian"></div><div class="section" id="A.1-The-Lorenzian-Water-Wheel-Model">
<h3>A.1 The Lorenzian Water Wheel Model<a class="headerlink" href="#A.1-The-Lorenzian-Water-Wheel-Model" title="Permalink to this headline">¶</a></h3>
<p><em>This derivation is adapted from Sparrow  [Appendix B].</em></p>
<div id="fig_water-wheel"></div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>Image(filename=&quot;images/water-wheel.png&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/doc_notebooks_lab6_lab6_34_0.png" src="../../_images/doc_notebooks_lab6_lab6_34_0.png" />
</div>
</div>
<!-- lab6:fig:water-wheel --><p><strong>Figure: The Lorenzian water wheel.</strong></p>
<p>Imagine a wheel which is free to rotate about a horizontal axis, as depicted in <a class="reference external" href="#fig_water-wheel">Figure water-wheel</a>.</p>
<p>To the circumference of the wheel is attached a series of leaky buckets. Water flows into the buckets at the top of the wheel, and as the buckets are filled with water, the wheel becomes unbalanced and begins to rotate. Depending on the physical parameters in this system, the wheel may remain motionless, rotate steadily in a clockwise or counter-clockwise direction, or reverese its motion in irregular intervals. This should begin to remind you of the type of behaviour exhibited in the Lorenz
system for various parameters.</p>
<p>The following are the variables and parameters in the system:</p>
<p><span class="math notranslate nohighlight">\(r\)</span>: the radius of the wheel (constant),</p>
<p><span class="math notranslate nohighlight">\(g\)</span>: the acceleration due to gravity (constant),</p>
<p><span class="math notranslate nohighlight">\(\theta(t)\)</span>: is the angular displacement (not a fixed point on the wheel) (unknown),</p>
<p><span class="math notranslate nohighlight">\(m(\theta,t)\)</span>: the mass of the water per unit arc, which we assume is a continuous function of the angle (unknown),</p>
<p><span class="math notranslate nohighlight">\(\Omega(t)\)</span>: the angular velocity of the wheel,</p>
<p>We also make the following assumptions:</p>
<ul class="simple">
<li><p>water is added to the wheel at a constant rate.</p></li>
<li><p>the points on the circumference of the wheel gain water at a rate proportional to their height.</p></li>
<li><p>water leaks out at a rate proportional to <span class="math notranslate nohighlight">\(m\)</span>.</p></li>
<li><p>there is frictional damping in the wheel proportional to the angular velocity, <span class="math notranslate nohighlight">\(k \Omega\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(h\)</span> are additional positive constants.</p></li>
</ul>
<p>We’ll pass over some details here, and go right to the equations of motion. The equation describing the evloution of the angular momentum is</p>
<div class="math notranslate nohighlight">
\[\frac{d\Omega}{dt} = -k \Omega - \left( \frac{gh}{2\pi aA} \right)
  m \cos\theta.\]</div>
<p>The requirement of conservation of mass in the system leads to two equations</p>
<div class="math notranslate nohighlight">
\[\frac{d (m \sin\theta)}{dt} = \Omega m \cos\theta - h m \sin\theta +
    2\pi B\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\frac{d (m \cos\theta)}{dt} = -\Omega m \sin\theta - h m \cos\theta,\]</div>
<p>(where all variables dependent on the angle have been averaged over <span class="math notranslate nohighlight">\(\theta\)</span>).</p>
<p>Using a suitable change of variables, these three equations can be written in the same form as the Lorenz equations (with <span class="math notranslate nohighlight">\(\beta=1\)</span>).</p>
<div id="sec_references"></div></div>
</div>
<div class="section" id="B.-References">
<h2>B. References<a class="headerlink" href="#B.-References" title="Permalink to this headline">¶</a></h2>
<p>Gleick, J., 1987: <em>Chaos: Making a New Science</em>. Penguin Books.</p>
<p>Lorenz, E. N., 1963: Deterministic nonperiodic flow. <em>Journal of the Atmospheric Sciences</em>, <strong>20</strong>, 130–141.</p>
<p>Palmer, T., 1993: A weather eye on unpredictability. in N. Hall, editor, <em>Exploring Chaos: A Guide to the New Science of Disorder</em>, chapter 6. W. W. Norton &amp; Co.</p>
<p>Saltzman, B., 1962: Finite amplitude free convection as an initial value problem – I. <em>Journal of the Atmospheric Sciences</em>, <strong>19</strong>, 329–341.</p>
<p>Sparrow, C., 1982: <em>The Lorenz Equations: Bifurcations, Chaos, and Strange Attractors</em>. volume 41 of <em>Applied Mathematical Sciences</em>. Springer-Verlag.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../lab7/01-lab7.html" class="btn btn-neutral float-right" title="Laboratory 7: Solving partial differential equations using an explicit, finite difference method." accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../lab5/01-lab5.html" class="btn btn-neutral float-left" title="Lab 5: Daisyworld" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Numeric project

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>